/*! For license information please see ui.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,()=>(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},o=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],u=s[c]||0,h="".concat(c," ").concat(u);s[c]=u+1;var d=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var m=i(p,r);r.byIndex=a,t.splice(a,0,{identifier:h,updater:m,references:1})}o.push(h)}return o}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var s=r(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var a=n(s[o]);t[a].references--}for(var l=r(e,i),c=0;c<s.length;c++){var u=n(s[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}s=l}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},270:e=>{e.exports="data:image/svg+xml,%3csvg viewBox=%270 0 16 16%27 fill=%27white%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3ccircle cx=%278%27 cy=%278%27 r=%273%27/%3e%3c/svg%3e"},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},790:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(601),i=n.n(r),s=n(314),o=n.n(s),a=n(417),l=n.n(a),c=new URL(n(270),n.b),u=o()(i()),h=l()(c);u.push([e.id,`/* CSS Linter Configuration - Ignore Tailwind CSS @apply warnings */\n/* stylelint-disable at-rule-no-unknown */\n/* css-lint-disable unknownAtRules */\n/* eslint-disable-next-line */\n/* @apply is a Tailwind CSS directive - ignore linter warnings */\n/* prettier-ignore */\n*, ::before, ::after {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n::backdrop {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */\n/*\n1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)\n2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)\n*/\n*,\n::before,\n::after {\n  box-sizing: border-box; /* 1 */\n  border-width: 0; /* 2 */\n  border-style: solid; /* 2 */\n  border-color: #e5e7eb; /* 2 */\n}\n::before,\n::after {\n  --tw-content: '';\n}\n/*\n1. Use a consistent sensible line-height in all browsers.\n2. Prevent adjustments of font size after orientation changes in iOS.\n3. Use a more readable tab size.\n4. Use the user's configured \`sans\` font-family by default.\n5. Use the user's configured \`sans\` font-feature-settings by default.\n6. Use the user's configured \`sans\` font-variation-settings by default.\n7. Disable tap highlights on iOS\n*/\nhtml,\n:host {\n  line-height: 1.5; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n  -moz-tab-size: 4; /* 3 */\n  -o-tab-size: 4;\n     tab-size: 4; /* 3 */\n  font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 4 */\n  font-feature-settings: normal; /* 5 */\n  font-variation-settings: normal; /* 6 */\n  -webkit-tap-highlight-color: transparent; /* 7 */\n}\n/*\n1. Remove the margin in all browsers.\n2. Inherit line-height from \`html\` so users can set them as a class directly on the \`html\` element.\n*/\nbody {\n  margin: 0; /* 1 */\n  line-height: inherit; /* 2 */\n}\n/*\n1. Add the correct height in Firefox.\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\n3. Ensure horizontal rules are visible by default.\n*/\nhr {\n  height: 0; /* 1 */\n  color: inherit; /* 2 */\n  border-top-width: 1px; /* 3 */\n}\n/*\nAdd the correct text decoration in Chrome, Edge, and Safari.\n*/\nabbr:where([title]) {\n  -webkit-text-decoration: underline dotted;\n          text-decoration: underline dotted;\n}\n/*\nRemove the default font size and weight for headings.\n*/\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: inherit;\n}\n/*\nReset links to optimize for opt-in styling instead of opt-out.\n*/\na {\n  color: inherit;\n  text-decoration: inherit;\n}\n/*\nAdd the correct font weight in Edge and Safari.\n*/\nb,\nstrong {\n  font-weight: bolder;\n}\n/*\n1. Use the user's configured \`mono\` font-family by default.\n2. Use the user's configured \`mono\` font-feature-settings by default.\n3. Use the user's configured \`mono\` font-variation-settings by default.\n4. Correct the odd \`em\` font sizing in all browsers.\n*/\ncode,\nkbd,\nsamp,\npre {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* 1 */\n  font-feature-settings: normal; /* 2 */\n  font-variation-settings: normal; /* 3 */\n  font-size: 1em; /* 4 */\n}\n/*\nAdd the correct font size in all browsers.\n*/\nsmall {\n  font-size: 80%;\n}\n/*\nPrevent \`sub\` and \`sup\` elements from affecting the line height in all browsers.\n*/\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\nsub {\n  bottom: -0.25em;\n}\nsup {\n  top: -0.5em;\n}\n/*\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\n3. Remove gaps between table borders by default.\n*/\ntable {\n  text-indent: 0; /* 1 */\n  border-color: inherit; /* 2 */\n  border-collapse: collapse; /* 3 */\n}\n/*\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n3. Remove default padding in all browsers.\n*/\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-feature-settings: inherit; /* 1 */\n  font-variation-settings: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  font-weight: inherit; /* 1 */\n  line-height: inherit; /* 1 */\n  letter-spacing: inherit; /* 1 */\n  color: inherit; /* 1 */\n  margin: 0; /* 2 */\n  padding: 0; /* 3 */\n}\n/*\nRemove the inheritance of text transform in Edge and Firefox.\n*/\nbutton,\nselect {\n  text-transform: none;\n}\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Remove default button styles.\n*/\nbutton,\ninput:where([type='button']),\ninput:where([type='reset']),\ninput:where([type='submit']) {\n  -webkit-appearance: button; /* 1 */\n  background-color: transparent; /* 2 */\n  background-image: none; /* 2 */\n}\n/*\nUse the modern Firefox focus style for all focusable elements.\n*/\n:-moz-focusring {\n  outline: auto;\n}\n/*\nRemove the additional \`:invalid\` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)\n*/\n:-moz-ui-invalid {\n  box-shadow: none;\n}\n/*\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\nprogress {\n  vertical-align: baseline;\n}\n/*\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n  height: auto;\n}\n/*\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n[type='search'] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n/*\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to \`inherit\` in Safari.\n*/\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n/*\nAdd the correct display in Chrome and Safari.\n*/\nsummary {\n  display: list-item;\n}\n/*\nRemoves the default spacing and border for appropriate elements.\n*/\nblockquote,\ndl,\ndd,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\nfigure,\np,\npre {\n  margin: 0;\n}\nfieldset {\n  margin: 0;\n  padding: 0;\n}\nlegend {\n  padding: 0;\n}\nol,\nul,\nmenu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n/*\nReset default styling for dialogs.\n*/\ndialog {\n  padding: 0;\n}\n/*\nPrevent resizing textareas horizontally by default.\n*/\ntextarea {\n  resize: vertical;\n}\n/*\n1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)\n2. Set the default placeholder color to the user's configured gray 400 color.\n*/\ninput::-moz-placeholder, textarea::-moz-placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\ninput::placeholder,\ntextarea::placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n/*\nSet the default cursor for buttons.\n*/\nbutton,\n[role="button"] {\n  cursor: pointer;\n}\n/*\nMake sure disabled buttons don't get the pointer cursor.\n*/\n:disabled {\n  cursor: default;\n}\n/*\n1. Make replaced elements \`display: block\` by default. (https://github.com/mozdevs/cssremedy/issues/14)\n2. Add \`vertical-align: middle\` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)\n   This can trigger a poorly considered lint error in some tools but is included by design.\n*/\nimg,\nsvg,\nvideo,\ncanvas,\naudio,\niframe,\nembed,\nobject {\n  display: block; /* 1 */\n  vertical-align: middle; /* 2 */\n}\n/*\nConstrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)\n*/\nimg,\nvideo {\n  max-width: 100%;\n  height: auto;\n}\n/* Make elements with the HTML hidden attribute stay hidden by default */\n[hidden]:where(:not([hidden="until-found"])) {\n  display: none;\n}\n/* stylelint-disable-next-line at-rule-no-unknown */\ninput,\n  textarea,\n  select {\n  --tw-text-opacity: 1;\n  color: rgb(17 24 39 / var(--tw-text-opacity, 1));\n}\n/* stylelint-disable-next-line at-rule-no-unknown */\na {\n  --tw-text-opacity: 1;\n  color: rgb(7 89 133 / var(--tw-text-opacity, 1));\n}\n/* stylelint-disable-next-line at-rule-no-unknown */\na:hover {\n  --tw-text-opacity: 1;\n  color: rgb(7 89 133 / var(--tw-text-opacity, 1));\n  text-decoration-line: underline;\n}\n.container {\n  width: 100%;\n}\n@media (min-width: 640px) {\n  .container {\n    max-width: 640px;\n  }\n}\n@media (min-width: 768px) {\n  .container {\n    max-width: 768px;\n  }\n}\n@media (min-width: 1024px) {\n  .container {\n    max-width: 1024px;\n  }\n}\n@media (min-width: 1280px) {\n  .container {\n    max-width: 1280px;\n  }\n}\n@media (min-width: 1536px) {\n  .container {\n    max-width: 1536px;\n  }\n}\n.form-input,.form-textarea,.form-select,.form-multiselect {\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  background-color: #fff;\n  border-color: #6b7280;\n  border-width: 1px;\n  border-radius: 0px;\n  padding-top: 0.5rem;\n  padding-right: 0.75rem;\n  padding-bottom: 0.5rem;\n  padding-left: 0.75rem;\n  font-size: 1rem;\n  line-height: 1.5rem;\n  --tw-shadow: 0 0 #0000;\n}\n.form-input:focus, .form-textarea:focus, .form-select:focus, .form-multiselect:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: #2563eb;\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  border-color: #2563eb;\n}\n.form-input::-moz-placeholder, .form-textarea::-moz-placeholder {\n  color: #6b7280;\n  opacity: 1;\n}\n.form-input::placeholder,.form-textarea::placeholder {\n  color: #6b7280;\n  opacity: 1;\n}\n.form-input::-webkit-datetime-edit-fields-wrapper {\n  padding: 0;\n}\n.form-input::-webkit-date-and-time-value {\n  min-height: 1.5em;\n  text-align: inherit;\n}\n.form-input::-webkit-datetime-edit {\n  display: inline-flex;\n}\n.form-input::-webkit-datetime-edit,.form-input::-webkit-datetime-edit-year-field,.form-input::-webkit-datetime-edit-month-field,.form-input::-webkit-datetime-edit-day-field,.form-input::-webkit-datetime-edit-hour-field,.form-input::-webkit-datetime-edit-minute-field,.form-input::-webkit-datetime-edit-second-field,.form-input::-webkit-datetime-edit-millisecond-field,.form-input::-webkit-datetime-edit-meridiem-field {\n  padding-top: 0;\n  padding-bottom: 0;\n}\n.form-checkbox,.form-radio {\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  padding: 0;\n  -webkit-print-color-adjust: exact;\n          print-color-adjust: exact;\n  display: inline-block;\n  vertical-align: middle;\n  background-origin: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  flex-shrink: 0;\n  height: 1rem;\n  width: 1rem;\n  color: #2563eb;\n  background-color: #fff;\n  border-color: #6b7280;\n  border-width: 1px;\n  --tw-shadow: 0 0 #0000;\n}\n.form-radio {\n  border-radius: 100%;\n}\n.form-checkbox:focus,.form-radio:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/);\n  --tw-ring-offset-width: 2px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: #2563eb;\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n}\n.form-checkbox:checked,.form-radio:checked {\n  border-color: transparent;\n  background-color: currentColor;\n  background-size: 100% 100%;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.form-radio:checked {\n  background-image: url(${h});\n}\n@media (forced-colors: active)  {\n  .form-radio:checked {\n    -webkit-appearance: auto;\n       -moz-appearance: auto;\n            appearance: auto;\n  }\n}\n.form-checkbox:checked:hover,.form-checkbox:checked:focus,.form-radio:checked:hover,.form-radio:checked:focus {\n  border-color: transparent;\n  background-color: currentColor;\n}\n/* Override the blue set by @tailwindcss/forms */\n.form-input:focus,\n  .form-textarea:focus,\n  .form-select:focus,\n  .form-multiselect:focus {\n    --tw-ring-color: var(--btn-primary-bg);\n    border-color: var(--btn-primary-bg);\n  }\n.form-checkbox,\n  .form-radio {\n    color: var(--btn-primary-bg);\n  }\n.form-checkbox:focus,\n  .form-radio:focus {\n    --tw-ring-color: var(--btn-primary-bg);\n  }\n.bg-panel {\n    background-color: var(--panel-bg);\n    color: var(--panel-text);\n  }\n.btn {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    display: inline-block;\n    padding: 0.5rem;\n    font-weight: 700;\n    --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n    --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n    transition-duration: 150ms;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    background-color: var(--btn-primary-bg);\n    color: var(--btn-primary-text);\n    border-radius: var(--btn-border-radius);\n  }\n.btn:hover,\n    .btn.hover {\n      background-color: var(--btn-primary-bg-hover);\n    }\n.btn-secondary {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    display: inline-block;\n    padding: 0.5rem;\n    font-weight: 700;\n    --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n    --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n    transition-duration: 150ms;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    background-color: var(--btn-primary-bg);\n    color: var(--btn-primary-text);\n    border-radius: var(--btn-border-radius);\n  }\n.btn-secondary:hover,.btn-secondary.hover {\n      background-color: var(--btn-primary-bg-hover);\n    }\n.btn-secondary {\n    background-color: var(--btn-secondary-bg);\n    color: var(--btn-secondary-text);\n  }\n.btn-secondary:hover,\n    .btn-secondary.hover {\n      background-color: var(--btn-secondary-bg-hover);\n    }\n.btn-secondary.active {\n      background-color: var(--btn-primary-bg);\n    }\n.btn-rounded {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    border-radius: 9999px;\n  }\n/* For the send button in ChatPanel */\n.btn-in-input {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    --tw-text-opacity: 1;\n    color: rgb(75 85 99 / var(--tw-text-opacity, 1));\n  }\n.btn-in-input:hover {\n      color: var(--btn-primary-bg-hover);\n    }\n.btn-in-input[disabled],\n    .btn-in-input[disabled]:hover {\n      /* stylelint-disable-next-line at-rule-no-unknown */\n      --tw-text-opacity: 1;\n      color: rgb(75 85 99 / var(--tw-text-opacity, 1));\n    }\n.animation-ping {\n    animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;\n  }\n@keyframes ping {\n    75%,\n    100% {\n      transform: scale(2);\n      opacity: 0;\n    }\n  }\n.counter {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    position: absolute;\n    right: -0.5rem;\n    bottom: 0px;\n    display: flex;\n    height: 1.5rem;\n    width: 1.5rem;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n            user-select: none;\n    align-items: center;\n    justify-content: center;\n    border-radius: 9999px;\n    border-width: 2px;\n    --tw-border-opacity: 1;\n    border-color: rgb(209 213 219 / var(--tw-border-opacity, 1));\n    font-size: 0.875rem;\n    line-height: 1.25rem;\n    background-color: var(--btn-secondary-bg);\n    color: var(--btn-secondary-text);\n  }\n.counter-red {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    position: absolute;\n    right: -0.5rem;\n    bottom: 0px;\n    display: flex;\n    height: 1.5rem;\n    width: 1.5rem;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n            user-select: none;\n    align-items: center;\n    justify-content: center;\n    border-radius: 9999px;\n    border-width: 2px;\n    border-color: rgb(209 213 219 / var(--tw-border-opacity, 1));\n    font-size: 0.875rem;\n    line-height: 1.25rem;\n    background-color: var(--btn-secondary-bg);\n    color: var(--btn-secondary-text);\n    --tw-border-opacity: 1;\n    border-color: rgb(220 38 38 / var(--tw-border-opacity, 1));\n    --tw-bg-opacity: 1;\n    background-color: rgb(220 38 38 / var(--tw-bg-opacity, 1));\n    --tw-text-opacity: 1;\n    color: rgb(255 255 255 / var(--tw-text-opacity, 1));\n  }\n.naf-centered-fullscreen {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    background-color: var(--panel-bg);\n    color: var(--panel-text);\n    position: absolute;\n    inset: 0px;\n    z-index: 10;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    overflow-y: auto;\n    overflow-x: hidden;\n    padding-top: 2rem;\n    padding-bottom: 4rem;\n    scrollbar-width: thin;\n    scrollbar-color: #cbd5e1 #f1f5f9;\n    height: 100vh;\n    max-height: 100vh;\n    pointer-events: auto !important; /* Ensure elements inside can be clicked */\n  }\n.naf-centered-fullscreen::-webkit-scrollbar {\n    width: 12px;\n  }\n.naf-centered-fullscreen::-webkit-scrollbar-track {\n    background: #f1f5f9;\n    border-radius: 6px;\n  }\n.naf-centered-fullscreen::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 6px;\n    border: 2px solid #f1f5f9;\n  }\n.naf-centered-fullscreen::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n.naf-centered-fullscreen.scrollable {\n    justify-content: flex-start;\n    align-items: center;\n    min-height: 100vh;\n  }\n.naf-top-bar-right {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    pointer-events: none;\n    position: absolute;\n    z-index: 10;\n    display: flex;\n    width: 100%;\n    align-items: center;\n    gap: 1rem;\n  }\n.naf-top-bar-right>* {\n  pointer-events: auto;\n}\n.naf-top-bar-right {\n    z-index: 100; /* Ensure bars are above a-scene and other elements */ right: 1.5rem; top: 1.5rem; justify-content: flex-end;\n  }\n.naf-bottom-bar-center {\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    /* stylelint-disable-next-line at-rule-no-unknown */\n    pointer-events: none;\n    position: absolute;\n    z-index: 10;\n    display: flex;\n    width: 100%;\n    align-items: center;\n    gap: 1rem;\n  }\n.naf-bottom-bar-center>* {\n  pointer-events: auto;\n}\n.naf-bottom-bar-center {\n    z-index: 100; /* Ensure bars are above a-scene and other elements */ bottom: 1.5rem; justify-content: center;\n  }\n/* Custom scrollbar styles for avatar selection */\n/* Ensure scrollbars are always visible for avatar selection - vertical scroll */\n.overflow-y-auto {\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n    scrollbar-color: #cbd5e1 #f1f5f9;\n  }\n.overflow-y-auto::-webkit-scrollbar {\n    width: 12px;\n  }\n.overflow-y-auto::-webkit-scrollbar-track {\n    background: #f1f5f9;\n    border-radius: 6px;\n  }\n.overflow-y-auto::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 6px;\n    border: 2px solid #f1f5f9;\n  }\n.overflow-y-auto::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n/* Keep horizontal scroll styles for other components */\n.overflow-x-auto {\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n.overflow-x-auto::-webkit-scrollbar {\n    height: 12px;\n  }\n.overflow-x-auto::-webkit-scrollbar-track {\n    background: #f1f5f9;\n    border-radius: 6px;\n  }\n.overflow-x-auto::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 6px;\n  }\n.overflow-x-auto::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n.scrollbar-hidden {\n    scrollbar-width: none;\n    -ms-overflow-style: none;\n  }\n.scrollbar-hidden::-webkit-scrollbar {\n    display: none;\n  }\n/* Force full height and scroll capability */\nbody, html {\n    height: 100% !important;\n    overflow: auto !important;\n  }\n/* Ensure avatar selection containers have proper spacing */\n.avatar-selection-container {\n    max-height: none !important;\n    height: auto !important;\n    padding-bottom: 6rem !important;\n  }\n/* ========================================\n     ACHIEVEMENT NOTIFICATION MODAL STYLES\n     ======================================== */\n/* Full screen overlay untuk modal */\n.notification-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background-color: rgba(0, 0, 0, 0.75);\n    backdrop-filter: blur(4px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n    padding: 1rem;\n    animation: fadeIn 0.3s ease-out;\n  }\n/* Container modal */\n.notification-modal {\n    background: white;\n    border-radius: 16px;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n    max-width: 500px;\n    width: 100%;\n    margin: 0 auto;\n    animation: scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n  }\n/* Animasi fade in untuk overlay */\n@keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n/* Animasi scale in untuk modal */\n@keyframes scaleIn {\n    from {\n      transform: scale(0.7);\n      opacity: 0;\n    }\n    to {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n/* Animasi bounce untuk icon */\n@keyframes bounce {\n    0%, 100% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-10px);\n    }\n  }\n.animate-bounce {\n    animation: bounce 1s infinite;\n  }\n.animate-scaleIn {\n    animation: scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n  }\n.pointer-events-none {\n  pointer-events: none;\n}\n.pointer-events-auto {\n  pointer-events: auto;\n}\n.visible {\n  visibility: visible;\n}\n.invisible {\n  visibility: hidden;\n}\n.fixed {\n  position: fixed;\n}\n.absolute {\n  position: absolute;\n}\n.relative {\n  position: relative;\n}\n.sticky {\n  position: sticky;\n}\n.inset-0 {\n  inset: 0px;\n}\n.inset-y-0 {\n  top: 0px;\n  bottom: 0px;\n}\n.-bottom-4 {\n  bottom: -1rem;\n}\n.-left-4 {\n  left: -1rem;\n}\n.-right-1 {\n  right: -0.25rem;\n}\n.-right-4 {\n  right: -1rem;\n}\n.-top-1 {\n  top: -0.25rem;\n}\n.-top-4 {\n  top: -1rem;\n}\n.bottom-0 {\n  bottom: 0px;\n}\n.bottom-14 {\n  bottom: 3.5rem;\n}\n.bottom-16 {\n  bottom: 4rem;\n}\n.bottom-20 {\n  bottom: 5rem;\n}\n.bottom-40 {\n  bottom: 10rem;\n}\n.left-0 {\n  left: 0px;\n}\n.left-1\\/4 {\n  left: 25%;\n}\n.left-10 {\n  left: 2.5rem;\n}\n.left-2 {\n  left: 0.5rem;\n}\n.left-5 {\n  left: 1.25rem;\n}\n.right-0 {\n  right: 0px;\n}\n.right-1\\/3 {\n  right: 33.333333%;\n}\n.right-2 {\n  right: 0.5rem;\n}\n.right-20 {\n  right: 5rem;\n}\n.right-3 {\n  right: 0.75rem;\n}\n.right-4 {\n  right: 1rem;\n}\n.top-0 {\n  top: 0px;\n}\n.top-1\\/2 {\n  top: 50%;\n}\n.top-14 {\n  top: 3.5rem;\n}\n.top-16 {\n  top: 4rem;\n}\n.top-20 {\n  top: 5rem;\n}\n.top-3 {\n  top: 0.75rem;\n}\n.top-4 {\n  top: 1rem;\n}\n.top-40 {\n  top: 10rem;\n}\n.top-5 {\n  top: 1.25rem;\n}\n.top-\\[72px\\] {\n  top: 72px;\n}\n.z-10 {\n  z-index: 10;\n}\n.z-20 {\n  z-index: 20;\n}\n.z-50 {\n  z-index: 50;\n}\n.z-\\[100021\\] {\n  z-index: 100021;\n}\n.z-\\[60\\] {\n  z-index: 60;\n}\n.z-\\[80\\] {\n  z-index: 80;\n}\n.z-\\[85\\] {\n  z-index: 85;\n}\n.z-\\[90\\] {\n  z-index: 90;\n}\n.z-\\[95\\] {\n  z-index: 95;\n}\n.col-span-2 {\n  grid-column: span 2 / span 2;\n}\n.m-0 {\n  margin: 0px;\n}\n.m-2 {\n  margin: 0.5rem;\n}\n.-mx-6 {\n  margin-left: -1.5rem;\n  margin-right: -1.5rem;\n}\n.mx-4 {\n  margin-left: 1rem;\n  margin-right: 1rem;\n}\n.mx-auto {\n  margin-left: auto;\n  margin-right: auto;\n}\n.mb-0 {\n  margin-bottom: 0px;\n}\n.mb-1 {\n  margin-bottom: 0.25rem;\n}\n.mb-10 {\n  margin-bottom: 2.5rem;\n}\n.mb-12 {\n  margin-bottom: 3rem;\n}\n.mb-16 {\n  margin-bottom: 4rem;\n}\n.mb-2 {\n  margin-bottom: 0.5rem;\n}\n.mb-3 {\n  margin-bottom: 0.75rem;\n}\n.mb-4 {\n  margin-bottom: 1rem;\n}\n.mb-6 {\n  margin-bottom: 1.5rem;\n}\n.mb-8 {\n  margin-bottom: 2rem;\n}\n.ml-2 {\n  margin-left: 0.5rem;\n}\n.mr-2 {\n  margin-right: 0.5rem;\n}\n.mt-0 {\n  margin-top: 0px;\n}\n.mt-0\\.5 {\n  margin-top: 0.125rem;\n}\n.mt-1 {\n  margin-top: 0.25rem;\n}\n.mt-2 {\n  margin-top: 0.5rem;\n}\n.mt-3 {\n  margin-top: 0.75rem;\n}\n.mt-4 {\n  margin-top: 1rem;\n}\n.mt-6 {\n  margin-top: 1.5rem;\n}\n.mt-8 {\n  margin-top: 2rem;\n}\n.mt-auto {\n  margin-top: auto;\n}\n.block {\n  display: block;\n}\n.inline-block {\n  display: inline-block;\n}\n.inline {\n  display: inline;\n}\n.flex {\n  display: flex;\n}\n.inline-flex {\n  display: inline-flex;\n}\n.grid {\n  display: grid;\n}\n.hidden {\n  display: none;\n}\n.aspect-square {\n  aspect-ratio: 1 / 1;\n}\n.size-14 {\n  width: 3.5rem;\n  height: 3.5rem;\n}\n.h-10 {\n  height: 2.5rem;\n}\n.h-11 {\n  height: 2.75rem;\n}\n.h-12 {\n  height: 3rem;\n}\n.h-16 {\n  height: 4rem;\n}\n.h-2 {\n  height: 0.5rem;\n}\n.h-20 {\n  height: 5rem;\n}\n.h-24 {\n  height: 6rem;\n}\n.h-28 {\n  height: 7rem;\n}\n.h-32 {\n  height: 8rem;\n}\n.h-4 {\n  height: 1rem;\n}\n.h-48 {\n  height: 12rem;\n}\n.h-5 {\n  height: 1.25rem;\n}\n.h-7 {\n  height: 1.75rem;\n}\n.h-8 {\n  height: 2rem;\n}\n.h-auto {\n  height: auto;\n}\n.h-full {\n  height: 100%;\n}\n.max-h-\\[300px\\] {\n  max-height: 300px;\n}\n.max-h-\\[65vh\\] {\n  max-height: 65vh;\n}\n.max-h-\\[90vh\\] {\n  max-height: 90vh;\n}\n.min-h-0 {\n  min-height: 0px;\n}\n.min-h-\\[120px\\] {\n  min-height: 120px;\n}\n.min-h-\\[200px\\] {\n  min-height: 200px;\n}\n.min-h-full {\n  min-height: 100%;\n}\n.min-h-screen {\n  min-height: 100vh;\n}\n.w-10 {\n  width: 2.5rem;\n}\n.w-11 {\n  width: 2.75rem;\n}\n.w-12 {\n  width: 3rem;\n}\n.w-16 {\n  width: 4rem;\n}\n.w-20 {\n  width: 5rem;\n}\n.w-24 {\n  width: 6rem;\n}\n.w-28 {\n  width: 7rem;\n}\n.w-32 {\n  width: 8rem;\n}\n.w-4 {\n  width: 1rem;\n}\n.w-48 {\n  width: 12rem;\n}\n.w-5 {\n  width: 1.25rem;\n}\n.w-7 {\n  width: 1.75rem;\n}\n.w-8 {\n  width: 2rem;\n}\n.w-auto {\n  width: auto;\n}\n.w-full {\n  width: 100%;\n}\n.min-w-0 {\n  min-width: 0px;\n}\n.min-w-\\[100px\\] {\n  min-width: 100px;\n}\n.min-w-\\[120px\\] {\n  min-width: 120px;\n}\n.min-w-\\[20px\\] {\n  min-width: 20px;\n}\n.max-w-2xl {\n  max-width: 42rem;\n}\n.max-w-3xl {\n  max-width: 48rem;\n}\n.max-w-4xl {\n  max-width: 56rem;\n}\n.max-w-5xl {\n  max-width: 64rem;\n}\n.max-w-6xl {\n  max-width: 72rem;\n}\n.max-w-7xl {\n  max-width: 80rem;\n}\n.max-w-\\[420px\\] {\n  max-width: 420px;\n}\n.max-w-full {\n  max-width: 100%;\n}\n.max-w-lg {\n  max-width: 32rem;\n}\n.max-w-md {\n  max-width: 28rem;\n}\n.max-w-none {\n  max-width: none;\n}\n.flex-1 {\n  flex: 1 1 0%;\n}\n.flex-shrink-0 {\n  flex-shrink: 0;\n}\n.flex-grow {\n  flex-grow: 1;\n}\n.grow {\n  flex-grow: 1;\n}\n.-translate-y-1\\/2 {\n  --tw-translate-y: -50%;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n.transform {\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n@keyframes bounce {\n  0%, 100% {\n    transform: translateY(-25%);\n    animation-timing-function: cubic-bezier(0.8,0,1,1);\n  }\n  50% {\n    transform: none;\n    animation-timing-function: cubic-bezier(0,0,0.2,1);\n  }\n}\n.animate-bounce {\n  animation: bounce 1s infinite;\n}\n@keyframes pulse {\n  50% {\n    opacity: .5;\n  }\n}\n.animate-pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n.animate-spin {\n  animation: spin 1s linear infinite;\n}\n.cursor-not-allowed {\n  cursor: not-allowed;\n}\n.cursor-pointer {\n  cursor: pointer;\n}\n.select-none {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n}\n.resize-none {\n  resize: none;\n}\n.resize {\n  resize: both;\n}\n.list-decimal {\n  list-style-type: decimal;\n}\n.grid-cols-2 {\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n}\n.flex-row {\n  flex-direction: row;\n}\n.flex-col {\n  flex-direction: column;\n}\n.flex-wrap {\n  flex-wrap: wrap;\n}\n.items-start {\n  align-items: flex-start;\n}\n.items-end {\n  align-items: flex-end;\n}\n.items-center {\n  align-items: center;\n}\n.items-baseline {\n  align-items: baseline;\n}\n.justify-end {\n  justify-content: flex-end;\n}\n.justify-center {\n  justify-content: center;\n}\n.justify-between {\n  justify-content: space-between;\n}\n.justify-around {\n  justify-content: space-around;\n}\n.gap-1 {\n  gap: 0.25rem;\n}\n.gap-12 {\n  gap: 3rem;\n}\n.gap-16 {\n  gap: 4rem;\n}\n.gap-2 {\n  gap: 0.5rem;\n}\n.gap-3 {\n  gap: 0.75rem;\n}\n.gap-4 {\n  gap: 1rem;\n}\n.gap-6 {\n  gap: 1.5rem;\n}\n.gap-8 {\n  gap: 2rem;\n}\n.gap-x-6 {\n  -moz-column-gap: 1.5rem;\n       column-gap: 1.5rem;\n}\n.space-x-1 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-x-reverse: 0;\n  margin-right: calc(0.25rem * var(--tw-space-x-reverse));\n  margin-left: calc(0.25rem * calc(1 - var(--tw-space-x-reverse)));\n}\n.space-x-2 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-x-reverse: 0;\n  margin-right: calc(0.5rem * var(--tw-space-x-reverse));\n  margin-left: calc(0.5rem * calc(1 - var(--tw-space-x-reverse)));\n}\n.space-x-3 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-x-reverse: 0;\n  margin-right: calc(0.75rem * var(--tw-space-x-reverse));\n  margin-left: calc(0.75rem * calc(1 - var(--tw-space-x-reverse)));\n}\n.space-x-8 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-x-reverse: 0;\n  margin-right: calc(2rem * var(--tw-space-x-reverse));\n  margin-left: calc(2rem * calc(1 - var(--tw-space-x-reverse)));\n}\n.space-y-2 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-y-reverse: 0;\n  margin-top: calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));\n  margin-bottom: calc(0.5rem * var(--tw-space-y-reverse));\n}\n.space-y-3 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-y-reverse: 0;\n  margin-top: calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));\n  margin-bottom: calc(0.75rem * var(--tw-space-y-reverse));\n}\n.space-y-4 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-y-reverse: 0;\n  margin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse)));\n  margin-bottom: calc(1rem * var(--tw-space-y-reverse));\n}\n.space-y-5 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-y-reverse: 0;\n  margin-top: calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));\n  margin-bottom: calc(1.25rem * var(--tw-space-y-reverse));\n}\n.space-y-6 > :not([hidden]) ~ :not([hidden]) {\n  --tw-space-y-reverse: 0;\n  margin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));\n  margin-bottom: calc(1.5rem * var(--tw-space-y-reverse));\n}\n.overflow-hidden {\n  overflow: hidden;\n}\n.overflow-x-auto {\n  overflow-x: auto;\n}\n.overflow-y-auto {\n  overflow-y: auto;\n}\n.truncate {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.whitespace-nowrap {\n  white-space: nowrap;\n}\n.whitespace-pre-line {\n  white-space: pre-line;\n}\n.whitespace-pre-wrap {\n  white-space: pre-wrap;\n}\n.rounded {\n  border-radius: 0.25rem;\n}\n.rounded-2xl {\n  border-radius: 1rem;\n}\n.rounded-3xl {\n  border-radius: 1.5rem;\n}\n.rounded-full {\n  border-radius: 9999px;\n}\n.rounded-lg {\n  border-radius: 0.5rem;\n}\n.rounded-xl {\n  border-radius: 0.75rem;\n}\n.rounded-b-lg {\n  border-bottom-right-radius: 0.5rem;\n  border-bottom-left-radius: 0.5rem;\n}\n.rounded-t-2xl {\n  border-top-left-radius: 1rem;\n  border-top-right-radius: 1rem;\n}\n.rounded-t-3xl {\n  border-top-left-radius: 1.5rem;\n  border-top-right-radius: 1.5rem;\n}\n.border {\n  border-width: 1px;\n}\n.border-2 {\n  border-width: 2px;\n}\n.border-b {\n  border-bottom-width: 1px;\n}\n.border-b-2 {\n  border-bottom-width: 2px;\n}\n.border-t {\n  border-top-width: 1px;\n}\n.border-dashed {\n  border-style: dashed;\n}\n.border-amber-100 {\n  --tw-border-opacity: 1;\n  border-color: rgb(254 243 199 / var(--tw-border-opacity, 1));\n}\n.border-amber-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(253 230 138 / var(--tw-border-opacity, 1));\n}\n.border-amber-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(252 211 77 / var(--tw-border-opacity, 1));\n}\n.border-blue-100 {\n  --tw-border-opacity: 1;\n  border-color: rgb(219 234 254 / var(--tw-border-opacity, 1));\n}\n.border-blue-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(191 219 254 / var(--tw-border-opacity, 1));\n}\n.border-blue-500 {\n  --tw-border-opacity: 1;\n  border-color: rgb(59 130 246 / var(--tw-border-opacity, 1));\n}\n.border-blue-600 {\n  --tw-border-opacity: 1;\n  border-color: rgb(37 99 235 / var(--tw-border-opacity, 1));\n}\n.border-blue-600\\/30 {\n  border-color: rgb(37 99 235 / 0.3);\n}\n.border-emerald-100 {\n  --tw-border-opacity: 1;\n  border-color: rgb(209 250 229 / var(--tw-border-opacity, 1));\n}\n.border-emerald-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(167 243 208 / var(--tw-border-opacity, 1));\n}\n.border-emerald-500 {\n  --tw-border-opacity: 1;\n  border-color: rgb(16 185 129 / var(--tw-border-opacity, 1));\n}\n.border-gray-100 {\n  --tw-border-opacity: 1;\n  border-color: rgb(243 244 246 / var(--tw-border-opacity, 1));\n}\n.border-gray-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(229 231 235 / var(--tw-border-opacity, 1));\n}\n.border-gray-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(209 213 219 / var(--tw-border-opacity, 1));\n}\n.border-gray-700 {\n  --tw-border-opacity: 1;\n  border-color: rgb(55 65 81 / var(--tw-border-opacity, 1));\n}\n.border-green-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(187 247 208 / var(--tw-border-opacity, 1));\n}\n.border-orange-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(253 186 116 / var(--tw-border-opacity, 1));\n}\n.border-red-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(254 202 202 / var(--tw-border-opacity, 1));\n}\n.border-rose-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(254 205 211 / var(--tw-border-opacity, 1));\n}\n.border-rose-500 {\n  --tw-border-opacity: 1;\n  border-color: rgb(244 63 94 / var(--tw-border-opacity, 1));\n}\n.border-slate-100 {\n  --tw-border-opacity: 1;\n  border-color: rgb(241 245 249 / var(--tw-border-opacity, 1));\n}\n.border-slate-200 {\n  --tw-border-opacity: 1;\n  border-color: rgb(226 232 240 / var(--tw-border-opacity, 1));\n}\n.border-slate-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(203 213 225 / var(--tw-border-opacity, 1));\n}\n.border-transparent {\n  border-color: transparent;\n}\n.border-white {\n  --tw-border-opacity: 1;\n  border-color: rgb(255 255 255 / var(--tw-border-opacity, 1));\n}\n.border-yellow-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(253 224 71 / var(--tw-border-opacity, 1));\n}\n.bg-amber-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(254 243 199 / var(--tw-bg-opacity, 1));\n}\n.bg-amber-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 251 235 / var(--tw-bg-opacity, 1));\n}\n.bg-amber-50\\/70 {\n  background-color: rgb(255 251 235 / 0.7);\n}\n.bg-amber-50\\/80 {\n  background-color: rgb(255 251 235 / 0.8);\n}\n.bg-black {\n  --tw-bg-opacity: 1;\n  background-color: rgb(0 0 0 / var(--tw-bg-opacity, 1));\n}\n.bg-black\\/50 {\n  background-color: rgb(0 0 0 / 0.5);\n}\n.bg-black\\/70 {\n  background-color: rgb(0 0 0 / 0.7);\n}\n.bg-blue-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(219 234 254 / var(--tw-bg-opacity, 1));\n}\n.bg-blue-300 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(147 197 253 / var(--tw-bg-opacity, 1));\n}\n.bg-blue-300\\/20 {\n  background-color: rgb(147 197 253 / 0.2);\n}\n.bg-blue-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(239 246 255 / var(--tw-bg-opacity, 1));\n}\n.bg-blue-50\\/60 {\n  background-color: rgb(239 246 255 / 0.6);\n}\n.bg-blue-50\\/70 {\n  background-color: rgb(239 246 255 / 0.7);\n}\n.bg-blue-500 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(59 130 246 / var(--tw-bg-opacity, 1));\n}\n.bg-blue-600 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(37 99 235 / var(--tw-bg-opacity, 1));\n}\n.bg-emerald-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(236 253 245 / var(--tw-bg-opacity, 1));\n}\n.bg-emerald-50\\/70 {\n  background-color: rgb(236 253 245 / 0.7);\n}\n.bg-gray-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(243 244 246 / var(--tw-bg-opacity, 1));\n}\n.bg-gray-200 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(229 231 235 / var(--tw-bg-opacity, 1));\n}\n.bg-gray-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(249 250 251 / var(--tw-bg-opacity, 1));\n}\n.bg-gray-800 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(31 41 55 / var(--tw-bg-opacity, 1));\n}\n.bg-green-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(220 252 231 / var(--tw-bg-opacity, 1));\n}\n.bg-green-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(240 253 244 / var(--tw-bg-opacity, 1));\n}\n.bg-green-500 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(34 197 94 / var(--tw-bg-opacity, 1));\n}\n.bg-orange-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 237 213 / var(--tw-bg-opacity, 1));\n}\n.bg-red-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(254 242 242 / var(--tw-bg-opacity, 1));\n}\n.bg-rose-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 241 242 / var(--tw-bg-opacity, 1));\n}\n.bg-sky-200 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(186 230 253 / var(--tw-bg-opacity, 1));\n}\n.bg-slate-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(241 245 249 / var(--tw-bg-opacity, 1));\n}\n.bg-slate-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(248 250 252 / var(--tw-bg-opacity, 1));\n}\n.bg-slate-50\\/60 {\n  background-color: rgb(248 250 252 / 0.6);\n}\n.bg-slate-50\\/80 {\n  background-color: rgb(248 250 252 / 0.8);\n}\n.bg-slate-900\\/50 {\n  background-color: rgb(15 23 42 / 0.5);\n}\n.bg-slate-900\\/70 {\n  background-color: rgb(15 23 42 / 0.7);\n}\n.bg-transparent {\n  background-color: transparent;\n}\n.bg-white {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1));\n}\n.bg-white\\/10 {\n  background-color: rgb(255 255 255 / 0.1);\n}\n.bg-white\\/15 {\n  background-color: rgb(255 255 255 / 0.15);\n}\n.bg-white\\/20 {\n  background-color: rgb(255 255 255 / 0.2);\n}\n.bg-white\\/25 {\n  background-color: rgb(255 255 255 / 0.25);\n}\n.bg-white\\/30 {\n  background-color: rgb(255 255 255 / 0.3);\n}\n.bg-white\\/5 {\n  background-color: rgb(255 255 255 / 0.05);\n}\n.bg-white\\/90 {\n  background-color: rgb(255 255 255 / 0.9);\n}\n.bg-white\\/95 {\n  background-color: rgb(255 255 255 / 0.95);\n}\n.bg-yellow-100 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(254 249 195 / var(--tw-bg-opacity, 1));\n}\n.bg-opacity-50 {\n  --tw-bg-opacity: 0.5;\n}\n.bg-gradient-to-br {\n  background-image: linear-gradient(to bottom right, var(--tw-gradient-stops));\n}\n.bg-gradient-to-r {\n  background-image: linear-gradient(to right, var(--tw-gradient-stops));\n}\n.from-amber-400 {\n  --tw-gradient-from: #fbbf24 var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(251 191 36 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.from-blue-50 {\n  --tw-gradient-from: #eff6ff var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(239 246 255 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.from-blue-500 {\n  --tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.from-blue-600 {\n  --tw-gradient-from: #2563eb var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.from-gray-50 {\n  --tw-gradient-from: #f9fafb var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(249 250 251 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.from-green-500 {\n  --tw-gradient-from: #22c55e var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.via-white {\n  --tw-gradient-to: rgb(255 255 255 / 0)  var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), #fff var(--tw-gradient-via-position), var(--tw-gradient-to);\n}\n.to-blue-600 {\n  --tw-gradient-to: #2563eb var(--tw-gradient-to-position);\n}\n.to-blue-700 {\n  --tw-gradient-to: #1d4ed8 var(--tw-gradient-to-position);\n}\n.to-gray-50 {\n  --tw-gradient-to: #f9fafb var(--tw-gradient-to-position);\n}\n.to-green-600 {\n  --tw-gradient-to: #16a34a var(--tw-gradient-to-position);\n}\n.to-indigo-600 {\n  --tw-gradient-to: #4f46e5 var(--tw-gradient-to-position);\n}\n.to-orange-500 {\n  --tw-gradient-to: #f97316 var(--tw-gradient-to-position);\n}\n.to-purple-50 {\n  --tw-gradient-to: #faf5ff var(--tw-gradient-to-position);\n}\n.object-contain {\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n.object-cover {\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.p-0 {\n  padding: 0px;\n}\n.p-1 {\n  padding: 0.25rem;\n}\n.p-2 {\n  padding: 0.5rem;\n}\n.p-3 {\n  padding: 0.75rem;\n}\n.p-4 {\n  padding: 1rem;\n}\n.p-5 {\n  padding: 1.25rem;\n}\n.p-6 {\n  padding: 1.5rem;\n}\n.p-8 {\n  padding: 2rem;\n}\n.px-1 {\n  padding-left: 0.25rem;\n  padding-right: 0.25rem;\n}\n.px-1\\.5 {\n  padding-left: 0.375rem;\n  padding-right: 0.375rem;\n}\n.px-2 {\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n}\n.px-3 {\n  padding-left: 0.75rem;\n  padding-right: 0.75rem;\n}\n.px-4 {\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n.px-5 {\n  padding-left: 1.25rem;\n  padding-right: 1.25rem;\n}\n.px-6 {\n  padding-left: 1.5rem;\n  padding-right: 1.5rem;\n}\n.px-8 {\n  padding-left: 2rem;\n  padding-right: 2rem;\n}\n.py-0\\.5 {\n  padding-top: 0.125rem;\n  padding-bottom: 0.125rem;\n}\n.py-1 {\n  padding-top: 0.25rem;\n  padding-bottom: 0.25rem;\n}\n.py-12 {\n  padding-top: 3rem;\n  padding-bottom: 3rem;\n}\n.py-16 {\n  padding-top: 4rem;\n  padding-bottom: 4rem;\n}\n.py-2 {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.py-2\\.5 {\n  padding-top: 0.625rem;\n  padding-bottom: 0.625rem;\n}\n.py-20 {\n  padding-top: 5rem;\n  padding-bottom: 5rem;\n}\n.py-3 {\n  padding-top: 0.75rem;\n  padding-bottom: 0.75rem;\n}\n.py-3\\.5 {\n  padding-top: 0.875rem;\n  padding-bottom: 0.875rem;\n}\n.py-4 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n.py-5 {\n  padding-top: 1.25rem;\n  padding-bottom: 1.25rem;\n}\n.py-6 {\n  padding-top: 1.5rem;\n  padding-bottom: 1.5rem;\n}\n.py-8 {\n  padding-top: 2rem;\n  padding-bottom: 2rem;\n}\n.pb-1 {\n  padding-bottom: 0.25rem;\n}\n.pb-2 {\n  padding-bottom: 0.5rem;\n}\n.pb-3 {\n  padding-bottom: 0.75rem;\n}\n.pb-4 {\n  padding-bottom: 1rem;\n}\n.pb-5 {\n  padding-bottom: 1.25rem;\n}\n.pb-6 {\n  padding-bottom: 1.5rem;\n}\n.pb-8 {\n  padding-bottom: 2rem;\n}\n.pl-5 {\n  padding-left: 1.25rem;\n}\n.pr-10 {\n  padding-right: 2.5rem;\n}\n.pr-4 {\n  padding-right: 1rem;\n}\n.pt-1 {\n  padding-top: 0.25rem;\n}\n.pt-2 {\n  padding-top: 0.5rem;\n}\n.pt-24 {\n  padding-top: 6rem;\n}\n.pt-4 {\n  padding-top: 1rem;\n}\n.pt-6 {\n  padding-top: 1.5rem;\n}\n.pt-8 {\n  padding-top: 2rem;\n}\n.text-left {\n  text-align: left;\n}\n.text-center {\n  text-align: center;\n}\n.text-right {\n  text-align: right;\n}\n.text-justify {\n  text-align: justify;\n}\n.text-2xl {\n  font-size: 1.5rem;\n  line-height: 2rem;\n}\n.text-3xl {\n  font-size: 1.875rem;\n  line-height: 2.25rem;\n}\n.text-4xl {\n  font-size: 2.25rem;\n  line-height: 2.5rem;\n}\n.text-5xl {\n  font-size: 3rem;\n  line-height: 1;\n}\n.text-8xl {\n  font-size: 6rem;\n  line-height: 1;\n}\n.text-\\[10px\\] {\n  font-size: 10px;\n}\n.text-base {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n.text-lg {\n  font-size: 1.125rem;\n  line-height: 1.75rem;\n}\n.text-sm {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n.text-xl {\n  font-size: 1.25rem;\n  line-height: 1.75rem;\n}\n.text-xs {\n  font-size: 0.75rem;\n  line-height: 1rem;\n}\n.font-bold {\n  font-weight: 700;\n}\n.font-medium {\n  font-weight: 500;\n}\n.font-normal {\n  font-weight: 400;\n}\n.font-semibold {\n  font-weight: 600;\n}\n.uppercase {\n  text-transform: uppercase;\n}\n.leading-relaxed {\n  line-height: 1.625;\n}\n.leading-tight {\n  line-height: 1.25;\n}\n.tracking-\\[0\\.2em\\] {\n  letter-spacing: 0.2em;\n}\n.tracking-\\[0\\.35em\\] {\n  letter-spacing: 0.35em;\n}\n.tracking-\\[0\\.3em\\] {\n  letter-spacing: 0.3em;\n}\n.tracking-\\[0\\.4em\\] {\n  letter-spacing: 0.4em;\n}\n.tracking-\\[0\\.5em\\] {\n  letter-spacing: 0.5em;\n}\n.tracking-wide {\n  letter-spacing: 0.025em;\n}\n.tracking-widest {\n  letter-spacing: 0.1em;\n}\n.text-amber-500 {\n  --tw-text-opacity: 1;\n  color: rgb(245 158 11 / var(--tw-text-opacity, 1));\n}\n.text-amber-600 {\n  --tw-text-opacity: 1;\n  color: rgb(217 119 6 / var(--tw-text-opacity, 1));\n}\n.text-amber-700 {\n  --tw-text-opacity: 1;\n  color: rgb(180 83 9 / var(--tw-text-opacity, 1));\n}\n.text-blue-100 {\n  --tw-text-opacity: 1;\n  color: rgb(219 234 254 / var(--tw-text-opacity, 1));\n}\n.text-blue-400 {\n  --tw-text-opacity: 1;\n  color: rgb(96 165 250 / var(--tw-text-opacity, 1));\n}\n.text-blue-500 {\n  --tw-text-opacity: 1;\n  color: rgb(59 130 246 / var(--tw-text-opacity, 1));\n}\n.text-blue-600 {\n  --tw-text-opacity: 1;\n  color: rgb(37 99 235 / var(--tw-text-opacity, 1));\n}\n.text-blue-700 {\n  --tw-text-opacity: 1;\n  color: rgb(29 78 216 / var(--tw-text-opacity, 1));\n}\n.text-blue-800 {\n  --tw-text-opacity: 1;\n  color: rgb(30 64 175 / var(--tw-text-opacity, 1));\n}\n.text-emerald-600 {\n  --tw-text-opacity: 1;\n  color: rgb(5 150 105 / var(--tw-text-opacity, 1));\n}\n.text-emerald-700 {\n  --tw-text-opacity: 1;\n  color: rgb(4 120 87 / var(--tw-text-opacity, 1));\n}\n.text-gray-300 {\n  --tw-text-opacity: 1;\n  color: rgb(209 213 219 / var(--tw-text-opacity, 1));\n}\n.text-gray-400 {\n  --tw-text-opacity: 1;\n  color: rgb(156 163 175 / var(--tw-text-opacity, 1));\n}\n.text-gray-500 {\n  --tw-text-opacity: 1;\n  color: rgb(107 114 128 / var(--tw-text-opacity, 1));\n}\n.text-gray-600 {\n  --tw-text-opacity: 1;\n  color: rgb(75 85 99 / var(--tw-text-opacity, 1));\n}\n.text-gray-700 {\n  --tw-text-opacity: 1;\n  color: rgb(55 65 81 / var(--tw-text-opacity, 1));\n}\n.text-gray-800 {\n  --tw-text-opacity: 1;\n  color: rgb(31 41 55 / var(--tw-text-opacity, 1));\n}\n.text-gray-900 {\n  --tw-text-opacity: 1;\n  color: rgb(17 24 39 / var(--tw-text-opacity, 1));\n}\n.text-green-100 {\n  --tw-text-opacity: 1;\n  color: rgb(220 252 231 / var(--tw-text-opacity, 1));\n}\n.text-green-600 {\n  --tw-text-opacity: 1;\n  color: rgb(22 163 74 / var(--tw-text-opacity, 1));\n}\n.text-green-700 {\n  --tw-text-opacity: 1;\n  color: rgb(21 128 61 / var(--tw-text-opacity, 1));\n}\n.text-red-500 {\n  --tw-text-opacity: 1;\n  color: rgb(239 68 68 / var(--tw-text-opacity, 1));\n}\n.text-red-600 {\n  --tw-text-opacity: 1;\n  color: rgb(220 38 38 / var(--tw-text-opacity, 1));\n}\n.text-rose-600 {\n  --tw-text-opacity: 1;\n  color: rgb(225 29 72 / var(--tw-text-opacity, 1));\n}\n.text-rose-700 {\n  --tw-text-opacity: 1;\n  color: rgb(190 18 60 / var(--tw-text-opacity, 1));\n}\n.text-slate-400 {\n  --tw-text-opacity: 1;\n  color: rgb(148 163 184 / var(--tw-text-opacity, 1));\n}\n.text-slate-50 {\n  --tw-text-opacity: 1;\n  color: rgb(248 250 252 / var(--tw-text-opacity, 1));\n}\n.text-slate-500 {\n  --tw-text-opacity: 1;\n  color: rgb(100 116 139 / var(--tw-text-opacity, 1));\n}\n.text-slate-600 {\n  --tw-text-opacity: 1;\n  color: rgb(71 85 105 / var(--tw-text-opacity, 1));\n}\n.text-slate-700 {\n  --tw-text-opacity: 1;\n  color: rgb(51 65 85 / var(--tw-text-opacity, 1));\n}\n.text-slate-800 {\n  --tw-text-opacity: 1;\n  color: rgb(30 41 59 / var(--tw-text-opacity, 1));\n}\n.text-slate-900 {\n  --tw-text-opacity: 1;\n  color: rgb(15 23 42 / var(--tw-text-opacity, 1));\n}\n.text-white {\n  --tw-text-opacity: 1;\n  color: rgb(255 255 255 / var(--tw-text-opacity, 1));\n}\n.text-white\\/60 {\n  color: rgb(255 255 255 / 0.6);\n}\n.text-white\\/80 {\n  color: rgb(255 255 255 / 0.8);\n}\n.text-white\\/90 {\n  color: rgb(255 255 255 / 0.9);\n}\n.opacity-0 {\n  opacity: 0;\n}\n.opacity-20 {\n  opacity: 0.2;\n}\n.opacity-50 {\n  opacity: 0.5;\n}\n.opacity-70 {\n  opacity: 0.7;\n}\n.opacity-80 {\n  opacity: 0.8;\n}\n.opacity-90 {\n  opacity: 0.9;\n}\n.shadow {\n  --tw-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-2xl {\n  --tw-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);\n  --tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-inner {\n  --tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);\n  --tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-lg {\n  --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-md {\n  --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-sm {\n  --tw-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);\n  --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-amber-100 {\n  --tw-shadow-color: #fef3c7;\n  --tw-shadow: var(--tw-shadow-colored);\n}\n.outline {\n  outline-style: solid;\n}\n.ring-1 {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.ring-2 {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.ring-4 {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.ring-black {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(0 0 0 / var(--tw-ring-opacity, 1));\n}\n.ring-blue-400 {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1));\n}\n.ring-blue-500 {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1));\n}\n.ring-white\\/60 {\n  --tw-ring-color: rgb(255 255 255 / 0.6);\n}\n.ring-opacity-5 {\n  --tw-ring-opacity: 0.05;\n}\n.blur {\n  --tw-blur: blur(8px);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.drop-shadow {\n  --tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / 0.1)) drop-shadow(0 1px 1px rgb(0 0 0 / 0.06));\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.drop-shadow-lg {\n  --tw-drop-shadow: drop-shadow(0 10px 8px rgb(0 0 0 / 0.04)) drop-shadow(0 4px 3px rgb(0 0 0 / 0.1));\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.drop-shadow-md {\n  --tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / 0.07)) drop-shadow(0 2px 2px rgb(0 0 0 / 0.06));\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.invert {\n  --tw-invert: invert(100%);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.filter {\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.backdrop-blur-md {\n  --tw-backdrop-blur: blur(12px);\n  backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n}\n.backdrop-blur-sm {\n  --tw-backdrop-blur: blur(4px);\n  backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n}\n.backdrop-brightness-125 {\n  --tw-backdrop-brightness: brightness(1.25);\n  backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n}\n.backdrop-filter {\n  backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);\n}\n.transition {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-all {\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-colors {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-opacity {\n  transition-property: opacity;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-shadow {\n  transition-property: box-shadow;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-transform {\n  transition-property: transform;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.duration-200 {\n  transition-duration: 200ms;\n}\n.duration-300 {\n  transition-duration: 300ms;\n}\n.duration-500 {\n  transition-duration: 500ms;\n}\n.ease-in-out {\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n}\n:root {\n  --panel-bg: #18181b; /* bg-zinc-900 */\n  --panel-text: #ffffff;\n  --btn-primary-bg: #0f766e; /* bg-teal-700 */\n  --btn-primary-bg-hover: #115e59; /* bg-teal-800 */\n  --btn-primary-text: #e2e8f0; /* text-slate-200 */\n  --btn-secondary-bg: rgb(38 38 38); /* bg-neutral-800 */\n  --btn-secondary-bg-hover: rgb(64 64 64); /* bg-neutral-600 */\n  --btn-secondary-text: rgb(203 213 225); /* text-slate-300 */\n  --btn-border-radius: 0.5rem; /* rounded-lg */\n}\n/* Music Control Slider Styles - Enhanced */\ninput[type="range"] {\n  -webkit-appearance: none;\n  -moz-appearance: none;\n       appearance: none;\n  background: transparent;\n  cursor: pointer;\n  height: 8px;\n  border-radius: 4px;\n  outline: none;\n  width: 100%;\n}\ninput[type="range"]::-webkit-slider-track {\n  background: transparent;\n  height: 8px;\n  border-radius: 4px;\n}\ninput[type="range"]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  background: #10b981;\n  height: 20px;\n  width: 20px;\n  border-radius: 50%;\n  cursor: pointer;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n  border: 2px solid white;\n  margin-top: -6px;\n}\ninput[type="range"]::-moz-range-track {\n  background: transparent;\n  height: 8px;\n  border-radius: 4px;\n  border: none;\n}\ninput[type="range"]::-moz-range-thumb {\n  background: #10b981;\n  height: 20px;\n  width: 20px;\n  border-radius: 50%;\n  cursor: pointer;\n  border: 2px solid white;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n/* Animasi untuk popup collection */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n@keyframes scaleIn {\n  from {\n    transform: scale(0.8);\n    opacity: 0;\n  }\n  to {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n.animate-fadeIn {\n  animation: fadeIn 0.3s ease-out;\n}\n.animate-scaleIn {\n  animation: scaleIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n}\n@keyframes slideInRight {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n.animate-slideInRight {\n  animation: slideInRight 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n}\n@keyframes bounce {\n  0%, 20%, 53%, 80%, 100% {\n    transform: translate3d(0,0,0);\n  }\n  40%, 43% {\n    transform: translate3d(0, -8px, 0);\n  }\n  70% {\n    transform: translate3d(0, -4px, 0);\n  }\n  90% {\n    transform: translate3d(0, -2px, 0);\n  }\n}\n.animate-bounce {\n  animation: bounce 2s infinite;\n}\n/* 2D Overlay styles untuk notifikasi */\n.notification-overlay {\n  position: fixed !important;\n  top: 0 !important;\n  left: 0 !important;\n  width: 100vw !important;\n  height: 100vh !important;\n  z-index: 999999 !important;\n  pointer-events: all !important;\n  background: rgba(0, 0, 0, 0.7) !important;\n  backdrop-filter: blur(2px) !important;\n  overflow-y: auto !important;\n  -webkit-overflow-scrolling: touch !important;\n  touch-action: pan-y !important;\n  display: flex !important;\n  align-items: flex-start !important;\n  justify-content: center !important;\n  padding: 0 !important;\n}\n@media (min-width: 640px) {\n  .notification-overlay {\n    padding: 1rem !important;\n    align-items: center !important;\n  }\n}\n.notification-modal {\n  position: relative !important;\n  z-index: 1000000 !important;\n  pointer-events: all !important;\n  background: white !important;\n  border-radius: 0 !important;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;\n  width: 100% !important;\n  max-width: 28rem !important;\n  margin-top: auto !important;\n  margin-bottom: 0 !important;\n  max-height: 90vh !important;\n  display: flex !important;\n  flex-direction: column !important;\n}\n@media (min-width: 640px) {\n  .notification-modal {\n    border-radius: 16px !important;\n    margin-top: auto !important;\n    margin-bottom: auto !important;\n  }\n}\n/* stylelint-disable-next-line at-rule-no-unknown */\n/* stylelint-disable-next-line at-rule-no-unknown */\n.hover\\:-translate-y-\\[2px\\]:hover {\n  --tw-translate-y: -2px;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n.hover\\:scale-105:hover {\n  --tw-scale-x: 1.05;\n  --tw-scale-y: 1.05;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n.hover\\:border-blue-200:hover {\n  --tw-border-opacity: 1;\n  border-color: rgb(191 219 254 / var(--tw-border-opacity, 1));\n}\n.hover\\:border-blue-400:hover {\n  --tw-border-opacity: 1;\n  border-color: rgb(96 165 250 / var(--tw-border-opacity, 1));\n}\n.hover\\:border-gray-300:hover {\n  --tw-border-opacity: 1;\n  border-color: rgb(209 213 219 / var(--tw-border-opacity, 1));\n}\n.hover\\:bg-blue-200:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(191 219 254 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-blue-50:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(239 246 255 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-blue-600:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(37 99 235 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-blue-700:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(29 78 216 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-gray-100:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(243 244 246 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-gray-300:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(209 213 219 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-gray-50:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(249 250 251 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-red-50:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(254 242 242 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-slate-100:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(241 245 249 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-slate-200:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(226 232 240 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-white:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1));\n}\n.hover\\:bg-white\\/20:hover {\n  background-color: rgb(255 255 255 / 0.2);\n}\n.hover\\:bg-white\\/30:hover {\n  background-color: rgb(255 255 255 / 0.3);\n}\n.hover\\:from-blue-600:hover {\n  --tw-gradient-from: #2563eb var(--tw-gradient-from-position);\n  --tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n}\n.hover\\:to-blue-700:hover {\n  --tw-gradient-to: #1d4ed8 var(--tw-gradient-to-position);\n}\n.hover\\:text-blue-600:hover {\n  --tw-text-opacity: 1;\n  color: rgb(37 99 235 / var(--tw-text-opacity, 1));\n}\n.hover\\:text-blue-800:hover {\n  --tw-text-opacity: 1;\n  color: rgb(30 64 175 / var(--tw-text-opacity, 1));\n}\n.hover\\:text-red-800:hover {\n  --tw-text-opacity: 1;\n  color: rgb(153 27 27 / var(--tw-text-opacity, 1));\n}\n.hover\\:text-slate-700:hover {\n  --tw-text-opacity: 1;\n  color: rgb(51 65 85 / var(--tw-text-opacity, 1));\n}\n.hover\\:text-slate-800:hover {\n  --tw-text-opacity: 1;\n  color: rgb(30 41 59 / var(--tw-text-opacity, 1));\n}\n.hover\\:text-white:hover {\n  --tw-text-opacity: 1;\n  color: rgb(255 255 255 / var(--tw-text-opacity, 1));\n}\n.hover\\:shadow:hover {\n  --tw-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.hover\\:shadow-lg:hover {\n  --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.hover\\:shadow-md:hover {\n  --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.hover\\:shadow-xl:hover {\n  --tw-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.hover\\:brightness-110:hover {\n  --tw-brightness: brightness(1.1);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.focus\\:border-blue-500:focus {\n  --tw-border-opacity: 1;\n  border-color: rgb(59 130 246 / var(--tw-border-opacity, 1));\n}\n.focus\\:outline-none:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n.focus\\:ring-2:focus {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.focus\\:ring-4:focus {\n  --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);\n  --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);\n  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);\n}\n.focus\\:ring-blue-200:focus {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(191 219 254 / var(--tw-ring-opacity, 1));\n}\n.focus\\:ring-blue-300:focus {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(147 197 253 / var(--tw-ring-opacity, 1));\n}\n.focus\\:ring-blue-400:focus {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1));\n}\n.focus\\:ring-blue-500:focus {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1));\n}\n.focus\\:ring-slate-200:focus {\n  --tw-ring-opacity: 1;\n  --tw-ring-color: rgb(226 232 240 / var(--tw-ring-opacity, 1));\n}\n.active\\:scale-95:active {\n  --tw-scale-x: .95;\n  --tw-scale-y: .95;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n.group:hover .group-hover\\:scale-105 {\n  --tw-scale-x: 1.05;\n  --tw-scale-y: 1.05;\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n.group:hover .group-hover\\:opacity-100 {\n  opacity: 1;\n}\n.group:hover .group-hover\\:opacity-75 {\n  opacity: 0.75;\n}\n@media (min-width: 640px) {\n  .sm\\:left-auto {\n    left: auto;\n  }\n  .sm\\:right-4 {\n    right: 1rem;\n  }\n  .sm\\:top-4 {\n    top: 1rem;\n  }\n  .sm\\:my-auto {\n    margin-top: auto;\n    margin-bottom: auto;\n  }\n  .sm\\:mb-3 {\n    margin-bottom: 0.75rem;\n  }\n  .sm\\:mb-4 {\n    margin-bottom: 1rem;\n  }\n  .sm\\:mt-4 {\n    margin-top: 1rem;\n  }\n  .sm\\:h-16 {\n    height: 4rem;\n  }\n  .sm\\:h-64 {\n    height: 16rem;\n  }\n  .sm\\:w-16 {\n    width: 4rem;\n  }\n  .sm\\:w-28 {\n    width: 7rem;\n  }\n  .sm\\:w-96 {\n    width: 24rem;\n  }\n  .sm\\:w-auto {\n    width: auto;\n  }\n  .sm\\:w-screen {\n    width: 100vw;\n  }\n  .sm\\:max-w-sm {\n    max-width: 24rem;\n  }\n  .sm\\:flex-none {\n    flex: none;\n  }\n  .sm\\:grid-cols-2 {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n  .sm\\:grid-cols-3 {\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n  }\n  .sm\\:flex-row {\n    flex-direction: row;\n  }\n  .sm\\:items-center {\n    align-items: center;\n  }\n  .sm\\:justify-between {\n    justify-content: space-between;\n  }\n  .sm\\:gap-3 {\n    gap: 0.75rem;\n  }\n  .sm\\:space-y-4 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-y-reverse: 0;\n    margin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse)));\n    margin-bottom: calc(1rem * var(--tw-space-y-reverse));\n  }\n  .sm\\:space-y-6 > :not([hidden]) ~ :not([hidden]) {\n    --tw-space-y-reverse: 0;\n    margin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));\n    margin-bottom: calc(1.5rem * var(--tw-space-y-reverse));\n  }\n  .sm\\:rounded-2xl {\n    border-radius: 1rem;\n  }\n  .sm\\:rounded-3xl {\n    border-radius: 1.5rem;\n  }\n  .sm\\:border {\n    border-width: 1px;\n  }\n  .sm\\:border-slate-100 {\n    --tw-border-opacity: 1;\n    border-color: rgb(241 245 249 / var(--tw-border-opacity, 1));\n  }\n  .sm\\:p-4 {\n    padding: 1rem;\n  }\n  .sm\\:p-6 {\n    padding: 1.5rem;\n  }\n  .sm\\:p-8 {\n    padding: 2rem;\n  }\n  .sm\\:px-10 {\n    padding-left: 2.5rem;\n    padding-right: 2.5rem;\n  }\n  .sm\\:px-5 {\n    padding-left: 1.25rem;\n    padding-right: 1.25rem;\n  }\n  .sm\\:px-6 {\n    padding-left: 1.5rem;\n    padding-right: 1.5rem;\n  }\n  .sm\\:px-8 {\n    padding-left: 2rem;\n    padding-right: 2rem;\n  }\n  .sm\\:py-5 {\n    padding-top: 1.25rem;\n    padding-bottom: 1.25rem;\n  }\n  .sm\\:py-8 {\n    padding-top: 2rem;\n    padding-bottom: 2rem;\n  }\n  .sm\\:pb-8 {\n    padding-bottom: 2rem;\n  }\n  .sm\\:text-2xl {\n    font-size: 1.5rem;\n    line-height: 2rem;\n  }\n  .sm\\:text-3xl {\n    font-size: 1.875rem;\n    line-height: 2.25rem;\n  }\n  .sm\\:text-4xl {\n    font-size: 2.25rem;\n    line-height: 2.5rem;\n  }\n  .sm\\:text-5xl {\n    font-size: 3rem;\n    line-height: 1;\n  }\n  .sm\\:text-6xl {\n    font-size: 3.75rem;\n    line-height: 1;\n  }\n  .sm\\:text-base {\n    font-size: 1rem;\n    line-height: 1.5rem;\n  }\n  .sm\\:text-lg {\n    font-size: 1.125rem;\n    line-height: 1.75rem;\n  }\n  .sm\\:text-sm {\n    font-size: 0.875rem;\n    line-height: 1.25rem;\n  }\n  .sm\\:text-xl {\n    font-size: 1.25rem;\n    line-height: 1.75rem;\n  }\n}\n@media (min-width: 768px) {\n  .md\\:static {\n    position: static;\n  }\n  .md\\:-top-10 {\n    top: -2.5rem;\n  }\n  .md\\:left-0 {\n    left: 0px;\n  }\n  .md\\:right-0 {\n    right: 0px;\n  }\n  .md\\:top-0 {\n    top: 0px;\n  }\n  .md\\:m-0 {\n    margin: 0px;\n  }\n  .md\\:mt-0 {\n    margin-top: 0px;\n  }\n  .md\\:flex {\n    display: flex;\n  }\n  .md\\:w-32 {\n    width: 8rem;\n  }\n  .md\\:grid-cols-2 {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n  .md\\:grid-cols-3 {\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n  }\n  .md\\:grid-cols-4 {\n    grid-template-columns: repeat(4, minmax(0, 1fr));\n  }\n  .md\\:flex-row {\n    flex-direction: row;\n  }\n  .md\\:pt-0 {\n    padding-top: 0px;\n  }\n}\n@media (min-width: 1024px) {\n  .lg\\:grid-cols-2 {\n    grid-template-columns: repeat(2, minmax(0, 1fr));\n  }\n  .lg\\:grid-cols-3 {\n    grid-template-columns: repeat(3, minmax(0, 1fr));\n  }\n  .lg\\:p-8 {\n    padding: 2rem;\n  }\n  .lg\\:px-8 {\n    padding-left: 2rem;\n    padding-right: 2rem;\n  }\n  .lg\\:text-7xl {\n    font-size: 4.5rem;\n    line-height: 1;\n  }\n}\n.\\[\\&\\>\\*\\]\\:pointer-events-auto>* {\n  pointer-events: auto;\n}\n.\\[\\&\\>\\*\\]\\:h-full>* {\n  height: 100%;\n}\n`,""]);const d=u},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0;var r={};n.r(r),n.d(r,{avatarsBaseUrl:()=>IE});const i={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return s(this.context.count)},getNextContextId(){return s(this.context.count++)}};function s(e){const t=String(e),n=t.length-1;return i.context.id+(n?String.fromCharCode(96+n):"")+t}function o(e){i.context=e}const a=Symbol("solid-proxy"),l="function"==typeof Proxy,c=Symbol("solid-track"),u=(Symbol("solid-dev-component"),{equals:(e,t)=>e===t});let h=K;const d=1,p=2,m={owned:null,cleanups:null,context:null,owner:null},g={};var f=null;let y=null,w=null,b=null,v=null,_=null,x=null,k=0;function C(e,t){const n=v,r=f,i=0===e.length,s=void 0===t?r:t,o=i?m:{owned:null,cleanups:null,context:s?s.context:null,owner:s},a=i?e:()=>e(()=>P(()=>X(o)));f=o,v=null;try{return W(a,!0)}finally{v=n,f=r}}function D(e,t){const n={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},u,t):u).equals||void 0};return[V.bind(n),e=>("function"==typeof e&&(e=y&&y.running&&y.sources.has(n)?e(n.tValue):e(n.value)),B(n,e))]}function E(e,t,n){const r=H(e,t,!0,d);w&&y&&y.running?_.push(r):z(r)}function S(e,t,n){const r=H(e,t,!1,d);w&&y&&y.running?_.push(r):z(r)}function I(e,t,n){h=Q;const r=H(e,t,!1,d),i=j&&q(j);i&&(r.suspense=i),n&&n.render||(r.user=!0),x?x.push(r):z(r)}function T(e,t,n){n=n?Object.assign({},u,n):u;const r=H(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,w&&y&&y.running?(r.tState=d,_.push(r)):z(r),V.bind(r)}function A(e){return W(e,!1)}function P(e){if(!b&&null===v)return e();const t=v;v=null;try{return b?b.untrack(e):e()}finally{v=t}}function R(e){I(()=>P(e))}function N(e){return null===f||(null===f.cleanups?f.cleanups=[e]:f.cleanups.push(e)),e}function F(){return v}function O(){return f}function M(e,t){const n=f,r=v;f=e,v=null;try{return W(t,!0)}catch(e){te(e)}finally{f=n,v=r}}const[L,U]=D(!1);function q(e){let t;return f&&f.context&&void 0!==(t=f.context[e.id])?t:e.defaultValue}let j;function V(){const e=y&&y.running;if(this.sources&&(e?this.tState:this.state))if((e?this.tState:this.state)===d)z(this);else{const e=_;_=null,W(()=>Y(this),!1),_=e}if(v){const e=this.observers?this.observers.length:0;v.sources?(v.sources.push(this),v.sourceSlots.push(e)):(v.sources=[this],v.sourceSlots=[e]),this.observers?(this.observers.push(v),this.observerSlots.push(v.sources.length-1)):(this.observers=[v],this.observerSlots=[v.sources.length-1])}return e&&y.sources.has(this)?this.tValue:this.value}function B(e,t,n){let r=y&&y.running&&y.sources.has(e)?e.tValue:e.value;if(!e.comparator||!e.comparator(r,t)){if(y){const r=y.running;(r||!n&&y.sources.has(e))&&(y.sources.add(e),e.tValue=t),r||(e.value=t)}else e.value=t;e.observers&&e.observers.length&&W(()=>{for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t],r=y&&y.running;r&&y.disposed.has(n)||((r?n.tState:n.state)||(n.pure?_.push(n):x.push(n),n.observers&&J(n)),r?n.tState=d:n.state=d)}if(_.length>1e6)throw _=[],new Error},!1)}return t}function z(e){if(!e.fn)return;X(e);const t=k;$(e,y&&y.running&&y.sources.has(e)?e.tValue:e.value,t),y&&!y.running&&y.sources.has(e)&&queueMicrotask(()=>{W(()=>{y&&(y.running=!0),v=f=e,$(e,e.tValue,t),v=f=null},!1)})}function $(e,t,n){let r;const i=f,s=v;v=f=e;try{r=e.fn(t)}catch(t){return e.pure&&(y&&y.running?(e.tState=d,e.tOwned&&e.tOwned.forEach(X),e.tOwned=void 0):(e.state=d,e.owned&&e.owned.forEach(X),e.owned=null)),e.updatedAt=n+1,te(t)}finally{v=s,f=i}(!e.updatedAt||e.updatedAt<=n)&&(null!=e.updatedAt&&"observers"in e?B(e,r,!0):y&&y.running&&e.pure?(y.sources.add(e),e.tValue=r):e.value=r,e.updatedAt=n)}function H(e,t,n,r=d,i){const s={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:f?f.context:null,pure:n};if(y&&y.running&&(s.state=0,s.tState=r),null===f||f!==m&&(y&&y.running&&f.pure?f.tOwned?f.tOwned.push(s):f.tOwned=[s]:f.owned?f.owned.push(s):f.owned=[s]),b&&s.fn){const[e,t]=D(void 0,{equals:!1}),n=b.factory(s.fn,t);N(()=>n.dispose());const r=()=>function(e){if(y&&y.running)return e(),y.done;const t=v,n=f;return Promise.resolve().then(()=>{let r;return v=t,f=n,(w||j)&&(r=y||(y={sources:new Set,effects:[],promises:new Set,disposed:new Set,queue:new Set,running:!0}),r.done||(r.done=new Promise(e=>r.resolve=e)),r.running=!0),W(e,!1),v=f=null,r?r.done:void 0})}(t).then(()=>i.dispose()),i=b.factory(s.fn,r);s.fn=t=>(e(),y&&y.running?i.track(t):n.track(t))}return s}function G(e){const t=y&&y.running;if(0===(t?e.tState:e.state))return;if((t?e.tState:e.state)===p)return Y(e);if(e.suspense&&P(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<k);){if(t&&y.disposed.has(e))return;(t?e.tState:e.state)&&n.push(e)}for(let r=n.length-1;r>=0;r--){if(e=n[r],t){let t=e,i=n[r+1];for(;(t=t.owner)&&t!==i;)if(y.disposed.has(t))return}if((t?e.tState:e.state)===d)z(e);else if((t?e.tState:e.state)===p){const t=_;_=null,W(()=>Y(e,n[0]),!1),_=t}}}function W(e,t){if(_)return e();let n=!1;t||(_=[]),x?n=!0:x=[],k++;try{const t=e();return function(e){if(_&&(w&&y&&y.running?function(e){for(let t=0;t<e.length;t++){const n=e[t],r=y.queue;r.has(n)||(r.add(n),w(()=>{r.delete(n),W(()=>{y.running=!0,G(n)},!1),y&&(y.running=!1)}))}}(_):K(_),_=null),e)return;let t;if(y)if(y.promises.size||y.queue.size){if(y.running)return y.running=!1,y.effects.push.apply(y.effects,x),x=null,void U(!0)}else{const e=y.sources,n=y.disposed;x.push.apply(x,y.effects),t=y.resolve;for(const e of x)"tState"in e&&(e.state=e.tState),delete e.tState;y=null,W(()=>{for(const e of n)X(e);for(const t of e){if(t.value=t.tValue,t.owned)for(let e=0,n=t.owned.length;e<n;e++)X(t.owned[e]);t.tOwned&&(t.owned=t.tOwned),delete t.tValue,delete t.tOwned,t.tState=0}U(!1)},!1)}const n=x;x=null,n.length&&W(()=>h(n),!1),t&&t()}(n),t}catch(e){n||(x=null),_=null,te(e)}}function K(e){for(let t=0;t<e.length;t++)G(e[t])}function Q(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:G(r)}if(i.context){if(i.count)return i.effects||(i.effects=[]),void i.effects.push(...e.slice(0,n));o()}for(!i.effects||!i.done&&i.count||(e=[...i.effects,...e],n+=i.effects.length,delete i.effects),t=0;t<n;t++)G(e[t])}function Y(e,t){const n=y&&y.running;n?e.tState=0:e.state=0;for(let r=0;r<e.sources.length;r+=1){const i=e.sources[r];if(i.sources){const e=n?i.tState:i.state;e===d?i!==t&&(!i.updatedAt||i.updatedAt<k)&&G(i):e===p&&Y(i,t)}}}function J(e){const t=y&&y.running;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(t?r.tState:r.state)||(t?r.tState=p:r.state=p,r.pure?_.push(r):x.push(r),r.observers&&J(r))}}function X(e){let t;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),n=e.sourceSlots.pop(),r=t.observers;if(r&&r.length){const e=r.pop(),i=t.observerSlots.pop();n<r.length&&(e.sourceSlots[i]=n,r[n]=e,t.observerSlots[n]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)X(e.tOwned[t]);delete e.tOwned}if(y&&y.running&&e.pure)Z(e,!0);else if(e.owned){for(t=e.owned.length-1;t>=0;t--)X(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}y&&y.running?e.tState=0:e.state=0}function Z(e,t){if(t||(e.tState=0,y.disposed.add(e)),e.owned)for(let t=0;t<e.owned.length;t++)Z(e.owned[t])}function ee(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function te(e,t=f){const n=ee(e);throw n}const ne=Symbol("fallback");function re(e){for(let t=0;t<e.length;t++)e[t]()}function ie(e,t){return P(()=>e(t||{}))}function se(){return!0}const oe={get:(e,t,n)=>t===a?n:e.get(t),has:(e,t)=>t===a||e.has(t),set:se,deleteProperty:se,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:se,deleteProperty:se}),ownKeys:e=>e.keys()};function ae(e){return(e="function"==typeof e?e():e)?e:{}}function le(){for(let e=0,t=this.length;e<t;++e){const t=this[e]();if(void 0!==t)return t}}function ce(...e){let t=!1;for(let n=0;n<e.length;n++){const r=e[n];t=t||!!r&&a in r,e[n]="function"==typeof r?(t=!0,T(r)):r}if(l&&t)return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){const r=ae(e[n])[t];if(void 0!==r)return r}},has(t){for(let n=e.length-1;n>=0;n--)if(t in ae(e[n]))return!0;return!1},keys(){const t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(ae(e[n])));return[...new Set(t)]}},oe);const n={},r=Object.create(null);for(let t=e.length-1;t>=0;t--){const i=e[t];if(!i)continue;const s=Object.getOwnPropertyNames(i);for(let e=s.length-1;e>=0;e--){const t=s[e];if("__proto__"===t||"constructor"===t)continue;const o=Object.getOwnPropertyDescriptor(i,t);if(r[t]){const e=n[t];e&&(o.get?e.push(o.get.bind(i)):void 0!==o.value&&e.push(()=>o.value))}else r[t]=o.get?{enumerable:!0,configurable:!0,get:le.bind(n[t]=[o.get.bind(i)])}:void 0!==o.value?o:void 0}}const i={},s=Object.keys(r);for(let e=s.length-1;e>=0;e--){const t=s[e],n=r[t];n&&n.get?Object.defineProperty(i,t,n):i[t]=n?n.value:void 0}return i}function ue(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(function(e,t,n={}){let r=[],i=[],s=[],o=0,a=t.length>1?[]:null;return N(()=>re(s)),()=>{let l,u,h=e()||[],d=h.length;return h[c],P(()=>{let e,t,c,m,g,f,y,w,b;if(0===d)0!==o&&(re(s),s=[],r=[],i=[],o=0,a&&(a=[])),n.fallback&&(r=[ne],i[0]=C(e=>(s[0]=e,n.fallback())),o=1);else if(0===o){for(i=new Array(d),u=0;u<d;u++)r[u]=h[u],i[u]=C(p);o=d}else{for(c=new Array(d),m=new Array(d),a&&(g=new Array(d)),f=0,y=Math.min(o,d);f<y&&r[f]===h[f];f++);for(y=o-1,w=d-1;y>=f&&w>=f&&r[y]===h[w];y--,w--)c[w]=i[y],m[w]=s[y],a&&(g[w]=a[y]);for(e=new Map,t=new Array(w+1),u=w;u>=f;u--)b=h[u],l=e.get(b),t[u]=void 0===l?-1:l,e.set(b,u);for(l=f;l<=y;l++)b=r[l],u=e.get(b),void 0!==u&&-1!==u?(c[u]=i[l],m[u]=s[l],a&&(g[u]=a[l]),u=t[u],e.set(b,u)):s[l]();for(u=f;u<d;u++)u in c?(i[u]=c[u],s[u]=m[u],a&&(a[u]=g[u],a[u](u))):i[u]=C(p);i=i.slice(0,o=d),r=h.slice(0)}return i});function p(e){if(s[u]=e,a){const[e,n]=D(u);return a[u]=n,t(h[u],e)}return t(h[u])}}}(()=>e.each,e.children,t||void 0))}function he(e){const t=e.keyed,n=T(()=>e.when,void 0,void 0),r=t?n:T(n,void 0,{equals:(e,t)=>!e==!t});return T(()=>{const i=r();if(i){const s=e.children;return"function"==typeof s&&s.length>0?P(()=>s(t?i:()=>{if(!P(r))throw`Stale read from <${"Show"}>.`;return n()})):s}return e.fallback},void 0,void 0)}const de=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable","allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"]),pe=new Set(["innerHTML","textContent","innerText","children"]),me=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),ge=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}}),fe=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),ye={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},we=e=>T(()=>e()),be="_$DX_DELEGATE";function ve(e,t,n,r){let i;const s=()=>{const t=r?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return t.innerHTML=e,n?t.content.firstChild.firstChild:r?t.firstChild:t.content.firstChild},o=t?()=>P(()=>document.importNode(i||(i=s()),!0)):()=>(i||(i=s())).cloneNode(!0);return o.cloneNode=o,o}function _e(e,t=window.document){const n=t[be]||(t[be]=new Set);for(let r=0,i=e.length;r<i;r++){const i=e[r];n.has(i)||(n.add(i),t.addEventListener(i,Ne))}}function xe(e,t,n){Ae(e)||(null==n?e.removeAttribute(t):e.setAttribute(t,n))}function ke(e,t){Ae(e)||(null==t?e.removeAttribute("class"):e.className=t)}function Ce(e,t,n,r){if(r)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const r=n[0];e.addEventListener(t,n[0]=t=>r.call(e,n[1],t))}else e.addEventListener(t,n,"function"!=typeof n&&n)}function De(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let s,o;for(s=0,o=i.length;s<o;s++){const r=i[s];r&&"undefined"!==r&&!t[r]&&(Pe(e,r,!1),delete n[r])}for(s=0,o=r.length;s<o;s++){const i=r[s],o=!!t[i];i&&"undefined"!==i&&n[i]!==o&&o&&(Pe(e,i,!0),n[i]=o)}return n}function Ee(e,t,n){if(!t)return n?xe(e,"style"):t;const r=e.style;if("string"==typeof t)return r.cssText=t;let i,s;for(s in"string"==typeof n&&(r.cssText=n=void 0),n||(n={}),t||(t={}),n)null==t[s]&&r.removeProperty(s),delete n[s];for(s in t)i=t[s],i!==n[s]&&(r.setProperty(s,i),n[s]=i);return n}function Se(e,t,n){null!=n?e.style.setProperty(t,n):e.style.removeProperty(t)}function Ie(e,t,n){return P(()=>e(t,n))}function Te(e,t,n,r){if(void 0===n||r||(r=[]),"function"!=typeof t)return Fe(e,t,r,n);S(r=>Fe(e,t(),r,n),r)}function Ae(e){return!!i.context&&!i.done&&(!e||e.isConnected)}function Pe(e,t,n){const r=t.trim().split(/\s+/);for(let t=0,i=r.length;t<i;t++)e.classList.toggle(r[t],n)}function Re(e,t,n,r,i,s,o){let a,l,c,u,h;if("style"===t)return Ee(e,n,r);if("classList"===t)return De(e,n,r);if(n===r)return r;if("ref"===t)s||n(e);else if("on:"===t.slice(0,3)){const i=t.slice(3);r&&e.removeEventListener(i,r,"function"!=typeof r&&r),n&&e.addEventListener(i,n,"function"!=typeof n&&n)}else if("oncapture:"===t.slice(0,10)){const i=t.slice(10);r&&e.removeEventListener(i,r,!0),n&&e.addEventListener(i,n,!0)}else if("on"===t.slice(0,2)){const i=t.slice(2).toLowerCase(),s=fe.has(i);if(!s&&r){const t=Array.isArray(r)?r[0]:r;e.removeEventListener(i,t)}(s||n)&&(Ce(e,i,n,s),s&&_e([i]))}else if("attr:"===t.slice(0,5))xe(e,t.slice(5),n);else if("bool:"===t.slice(0,5))!function(e,t,n){Ae(e)||(n?e.setAttribute(t,""):e.removeAttribute(t))}(e,t.slice(5),n);else if((h="prop:"===t.slice(0,5))||(c=pe.has(t))||!i&&((u=function(e,t){const n=ge[e];return"object"==typeof n?n[t]?n.$:void 0:n}(t,e.tagName))||(l=de.has(t)))||(a=e.nodeName.includes("-")||"is"in o)){if(h)t=t.slice(5),l=!0;else if(Ae(e))return n;"class"===t||"className"===t?ke(e,n):!a||l||c?e[u||t]=n:e[(d=t,d.toLowerCase().replace(/-([a-z])/g,(e,t)=>t.toUpperCase()))]=n}else{const r=i&&t.indexOf(":")>-1&&ye[t.split(":")[0]];r?function(e,t,n,r){Ae(e)||(null==r?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r))}(e,r,t,n):xe(e,me[t]||t,n)}var d;return n}function Ne(e){if(i.registry&&i.events&&i.events.find(([t,n])=>n===e))return;let t=e.target;const n=`$$${e.type}`,r=e.target,s=e.currentTarget,o=t=>Object.defineProperty(e,"target",{configurable:!0,value:t}),a=()=>{const r=t[n];if(r&&!t.disabled){const i=t[`${n}Data`];if(void 0!==i?r.call(t,i,e):r.call(t,e),e.cancelBubble)return}return t.host&&"string"!=typeof t.host&&!t.host._$host&&t.contains(e.target)&&o(t.host),!0},l=()=>{for(;a()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>t||document}),i.registry&&!i.done&&(i.done=_$HY.done=!0),e.composedPath){const n=e.composedPath();o(n[0]);for(let e=0;e<n.length-2&&(t=n[e],a());e++){if(t._$host){t=t._$host,l();break}if(t.parentNode===s)break}}else l();o(r)}function Fe(e,t,n,r,i){const s=Ae(e);if(s){!n&&(n=[...e.childNodes]);let t=[];for(let e=0;e<n.length;e++){const r=n[e];8===r.nodeType&&"!$"===r.data.slice(0,2)?r.remove():t.push(r)}n=t}for(;"function"==typeof n;)n=n();if(t===n)return n;const o=typeof t,a=void 0!==r;if(e=a&&n[0]&&n[0].parentNode||e,"string"===o||"number"===o){if(s)return n;if("number"===o&&(t=t.toString())===n)return n;if(a){let i=n[0];i&&3===i.nodeType?i.data!==t&&(i.data=t):i=document.createTextNode(t),n=Le(e,n,r,i)}else n=""!==n&&"string"==typeof n?e.firstChild.data=t:e.textContent=t}else if(null==t||"boolean"===o){if(s)return n;n=Le(e,n,r)}else{if("function"===o)return S(()=>{let i=t();for(;"function"==typeof i;)i=i();n=Fe(e,i,n,r)}),()=>n;if(Array.isArray(t)){const o=[],l=n&&Array.isArray(n);if(Oe(o,t,n,i))return S(()=>n=Fe(e,o,n,r,!0)),()=>n;if(s){if(!o.length)return n;if(void 0===r)return n=[...e.childNodes];let t=o[0];if(t.parentNode!==e)return n;const i=[t];for(;(t=t.nextSibling)!==r;)i.push(t);return n=i}if(0===o.length){if(n=Le(e,n,r),a)return n}else l?0===n.length?Me(e,o,r):function(e,t,n){let r=n.length,i=t.length,s=r,o=0,a=0,l=t[i-1].nextSibling,c=null;for(;o<i||a<s;)if(t[o]!==n[a]){for(;t[i-1]===n[s-1];)i--,s--;if(i===o){const t=s<r?a?n[a-1].nextSibling:n[s-a]:l;for(;a<s;)e.insertBefore(n[a++],t)}else if(s===a)for(;o<i;)c&&c.has(t[o])||t[o].remove(),o++;else if(t[o]===n[s-1]&&n[a]===t[i-1]){const r=t[--i].nextSibling;e.insertBefore(n[a++],t[o++].nextSibling),e.insertBefore(n[--s],r),t[i]=n[s]}else{if(!c){c=new Map;let e=a;for(;e<s;)c.set(n[e],e++)}const r=c.get(t[o]);if(null!=r)if(a<r&&r<s){let l,u=o,h=1;for(;++u<i&&u<s&&null!=(l=c.get(t[u]))&&l===r+h;)h++;if(h>r-a){const i=t[o];for(;a<r;)e.insertBefore(n[a++],i)}else e.replaceChild(n[a++],t[o++])}else o++;else t[o++].remove()}}else o++,a++}(e,n,o):(n&&Le(e),Me(e,o));n=o}else if(t.nodeType){if(s&&t.parentNode)return n=a?[t]:t;if(Array.isArray(n)){if(a)return n=Le(e,n,r,t);Le(e,n,null,t)}else null!=n&&""!==n&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);n=t}}return n}function Oe(e,t,n,r){let i=!1;for(let s=0,o=t.length;s<o;s++){let o,a=t[s],l=n&&n[e.length];if(null==a||!0===a||!1===a);else if("object"==(o=typeof a)&&a.nodeType)e.push(a);else if(Array.isArray(a))i=Oe(e,a,l)||i;else if("function"===o)if(r){for(;"function"==typeof a;)a=a();i=Oe(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||i}else e.push(a),i=!0;else{const t=String(a);l&&3===l.nodeType&&l.data===t?e.push(l):e.push(document.createTextNode(t))}}return i}function Me(e,t,n=null){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Le(e,t,n,r){if(void 0===n)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let r=!1;for(let s=t.length-1;s>=0;s--){const o=t[s];if(i!==o){const t=o.parentNode===e;r||s?t&&o.remove():t?e.replaceChild(i,o):e.insertBefore(i,n)}else r=!0}}else e.insertBefore(i,n);return[i]}function Ue(e){const{useShadow:t}=e,n=document.createTextNode(""),r=O();let s,o=!!i.context;return I(()=>{o&&(O().user=o=!1),s||(s=M(r,()=>T(()=>e.children)));const i=e.mount||document.body;if(i instanceof HTMLHeadElement){const[e,t]=D(!1),n=()=>t(!0);C(t=>Te(i,()=>e()?t():s(),null)),N(n)}else{const r=function(e,t=!1,n){return t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e,{is:n})}(e.isSVG?"g":"div",e.isSVG),o=t&&r.attachShadow?r.attachShadow({mode:"open"}):r;Object.defineProperty(r,"_$host",{get:()=>n.parentNode,configurable:!0}),Te(o,s),i.appendChild(r),e.ref&&e.ref(r),N(()=>i.removeChild(r))}},void 0,{render:!o}),n}Symbol();var qe=n(72),je=n.n(qe),Ve=n(825),Be=n.n(Ve),ze=n(659),$e=n.n(ze),He=n(56),Ge=n.n(He),We=n(540),Ke=n.n(We),Qe=n(113),Ye=n.n(Qe),Je=n(790),Xe={};Xe.styleTagTransform=Ye(),Xe.setAttributes=Ge(),Xe.insert=$e().bind(null,"head"),Xe.domAPI=Be(),Xe.insertStyleElement=Ke(),je()(Je.A,Xe),Je.A&&Je.A.locals&&Je.A.locals;var Ze=ve("<svg stroke-width=0>");function et(e,t){const n=ce(e.a,t),[r,i]=function(e,...t){if(l&&a in e){const n=new Set(t.length>1?t.flat():t[0]),r=t.map(t=>new Proxy({get:n=>t.includes(n)?e[n]:void 0,has:n=>t.includes(n)&&n in e,keys:()=>t.filter(t=>t in e)},oe));return r.push(new Proxy({get:t=>n.has(t)?void 0:e[t],has:t=>!n.has(t)&&t in e,keys:()=>Object.keys(e).filter(e=>!n.has(e))},oe)),r}const n={},r=t.map(()=>({}));for(const i of Object.getOwnPropertyNames(e)){const s=Object.getOwnPropertyDescriptor(e,i),o=!s.get&&!s.set&&s.enumerable&&s.writable&&s.configurable;let a=!1,l=0;for(const e of t)e.includes(i)&&(a=!0,o?r[l][i]=s.value:Object.defineProperty(r[l],i,s)),++l;a||(o?n[i]=s.value:Object.defineProperty(n,i,s))}return[...r,n]}(n,["src"]),[s,o]=D(""),c=T(()=>t.title?`${e.c}<title>${t.title}</title>`:e.c);return I(()=>o(c())),N(()=>{o("")}),function(e,t={},n,r){const i={};r||S(()=>i.children=Fe(e,t.children,i.children)),S(()=>"function"==typeof t.ref&&Ie(t.ref,e)),S(()=>function(e,t,n,r,i={},s=!1){t||(t={});for(const r in i)if(!(r in t)){if("children"===r)continue;i[r]=Re(e,r,null,i[r],n,s,t)}for(const o in t){if("children"===o){r||Fe(e,t.children);continue}const a=t[o];i[o]=Re(e,o,a,i[o],n,s,t)}}(e,t,n,!0,i,!0))}(u=Ze(),ce({get stroke(){return e.a?.stroke},get color(){return t.color||"currentColor"},get fill(){return t.color||"currentColor"},get style(){return{...t.style,overflow:"visible"}}},i,{get height(){return t.size||"1em"},get width(){return t.size||"1em"},xmlns:"http://www.w3.org/2000/svg",get innerHTML(){return s()}}),!0,!0),Te(u,()=>!1),u;var u}function tt(e){return et({a:{viewBox:"0 0 512 512"},c:'<path d="M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48Zm108.25 138.29-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32 122.59-145.91a16 16 0 0 1 24.5 20.58Z"/>'},e)}function nt(e){return et({a:{viewBox:"0 0 512 512"},c:'<path d="m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34Z"/>'},e)}function rt(e){return et({a:{viewBox:"0 0 512 512"},c:'<path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M262.29 192.31a64 64 0 1 0 57.4 57.4 64.13 64.13 0 0 0-57.4-57.4ZM416.39 256a154.34 154.34 0 0 1-1.53 20.79l45.21 35.46a10.81 10.81 0 0 1 2.45 13.75l-42.77 74a10.81 10.81 0 0 1-13.14 4.59l-44.9-18.08a16.11 16.11 0 0 0-15.17 1.75A164.48 164.48 0 0 1 325 400.8a15.94 15.94 0 0 0-8.82 12.14l-6.73 47.89a11.08 11.08 0 0 1-10.68 9.17h-85.54a11.11 11.11 0 0 1-10.69-8.87l-6.72-47.82a16.07 16.07 0 0 0-9-12.22 155.3 155.3 0 0 1-21.46-12.57 16 16 0 0 0-15.11-1.71l-44.89 18.07a10.81 10.81 0 0 1-13.14-4.58l-42.77-74a10.8 10.8 0 0 1 2.45-13.75l38.21-30a16.05 16.05 0 0 0 6-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 0 0-6.07-13.94l-38.19-30A10.81 10.81 0 0 1 49.48 186l42.77-74a10.81 10.81 0 0 1 13.14-4.59l44.9 18.08a16.11 16.11 0 0 0 15.17-1.75A164.48 164.48 0 0 1 187 111.2a15.94 15.94 0 0 0 8.82-12.14l6.73-47.89A11.08 11.08 0 0 1 213.23 42h85.54a11.11 11.11 0 0 1 10.69 8.87l6.72 47.82a16.07 16.07 0 0 0 9 12.22 155.3 155.3 0 0 1 21.46 12.57 16 16 0 0 0 15.11 1.71l44.89-18.07a10.81 10.81 0 0 1 13.14 4.58l42.77 74a10.8 10.8 0 0 1-2.45 13.75l-38.21 30a16.05 16.05 0 0 0-6.05 14.08c.33 4.14.55 8.3.55 12.47Z"/>'},e)}function it(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path fill-rule="evenodd" d="M10.961 12.365a1.99 1.99 0 0 0 .522-1.103l3.11 1.382A1 1 0 0 0 16 11.731V4.269a1 1 0 0 0-1.406-.913l-3.111 1.382A2 2 0 0 0 9.5 3H4.272l.714 1H9.5a1 1 0 0 1 1 1v6a1 1 0 0 1-.144.518l.605.847zM1.428 4.18A.999.999 0 0 0 1 5v6a1 1 0 0 0 1 1h5.014l.714 1H2a2 2 0 0 1-2-2V5c0-.675.334-1.272.847-1.634l.58.814zM15 11.73l-3.5-1.555v-4.35L15 4.269v7.462zm-4.407 3.56-10-14 .814-.58 10 14-.814.58z"/>'},e)}function st(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path fill-rule="evenodd" d="M0 5a2 2 0 0 1 2-2h7.5a2 2 0 0 1 1.983 1.738l3.11-1.382A1 1 0 0 1 16 4.269v7.462a1 1 0 0 1-1.406.913l-3.111-1.382A2 2 0 0 1 9.5 13H2a2 2 0 0 1-2-2V5zm11.5 5.175 3.5 1.556V4.269l-3.5 1.556v4.35zM2 4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h7.5a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1H2z"/>'},e)}function ot(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/><path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"/>'},e)}function at(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path fill-rule="evenodd" d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>'},e)}function lt(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M13 8c0 .564-.094 1.107-.266 1.613l-.814-.814A4.02 4.02 0 0 0 12 8V7a.5.5 0 0 1 1 0v1zm-5 4c.818 0 1.578-.245 2.212-.667l.718.719a4.973 4.973 0 0 1-2.43.923V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 1 0v1a4 4 0 0 0 4 4zm3-9v4.879l-1-1V3a2 2 0 0 0-3.997-.118l-.845-.845A3.001 3.001 0 0 1 11 3z"/><path d="m9.486 10.607-.748-.748A2 2 0 0 1 6 8v-.878l-1-1V8a3 3 0 0 0 4.486 2.607zm-7.84-9.253 12 12 .708-.708-12-12-.708.708z"/>'},e)}function ct(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"/><path d="M10 8a2 2 0 1 1-4 0V3a2 2 0 1 1 4 0v5zM8 0a3 3 0 0 0-3 3v5a3 3 0 0 0 6 0V3a3 3 0 0 0-3-3z"/>'},e)}function ut(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576 6.636 10.07Zm6.787-8.201L1.591 6.602l4.339 2.76 7.494-7.493Z"/>'},e)}const[ht,dt]=D(""),[pt,mt]=D(!1);var gt=ve("<label>Outfit"),ft=ve('<label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=outfit value=Casual><span>Casual'),yt=ve('<label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=outfit value=Busi><span>Business'),wt=ve('<label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=outfit value=Medi><span>Medical'),bt=ve('<label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=outfit value=Milit><span>Military'),vt=ve('<label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=outfit value=Util><span>Utility'),_t=ve('<div class="flex w-full flex-wrap gap-x-6">'),xt=ve('<div class="flex flex-col gap-2"><label class=font-bold>Your avatar</label><label>Gender</label><div class="flex w-full flex-wrap gap-x-6"><label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=gender value=F><span>Female</span></label><label class="flex w-20 items-center gap-2"><input class=form-radio type=radio name=gender value=M><span>Male</span></label></div><div class="w-full border border-gray-200 rounded-lg bg-gray-50 p-6 mb-6"><div class="avatar-scroll-container flex flex-row gap-4 overflow-x-auto pb-2 -mx-6 px-6"style="scrollbar-width:thin;scrollbar-color:#cbd5e1 #f1f5f9;-webkit-overflow-scrolling:touch">'),kt=ve('<button class="relative aspect-square w-24 sm:w-28 md:w-32 flex-shrink-0 cursor-pointer rounded-lg border-2 border-transparent hover:border-gray-300 focus:border-blue-500 focus:outline-none transition-all duration-200 group"><img class="absolute inset-0 w-full h-full rounded-lg object-cover"loading=lazy><div class="absolute inset-0 bg-white/30 backdrop-brightness-125 rounded-lg transition-opacity duration-200"></div><div class="absolute inset-0 ring-4 ring-blue-500 rounded-lg"></div><div class="absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 rounded-b-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200">',!0,!1,!1);if("undefined"!=typeof document){const e="avatar-scroll-styles";if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent="\n      .avatar-scroll-container::-webkit-scrollbar {\n        height: 8px;\n      }\n      .avatar-scroll-container::-webkit-scrollbar-track {\n        background: #f1f5f9;\n        border-radius: 4px;\n      }\n      .avatar-scroll-container::-webkit-scrollbar-thumb {\n        background: #cbd5e1;\n        border-radius: 4px;\n      }\n      .avatar-scroll-container::-webkit-scrollbar-thumb:hover {\n        background: #94a3b8;\n      }\n    ",document.head.appendChild(t)}}const[Ct,Dt]=D("F"),[Et,St]=D("Casual"),It=["Casual","Busi","Medi","Milit","Util"],Tt=e=>{const t=e.outfits??It;return 1===t.length&&St(t[0]),I(()=>{if(ht()){const t=e.avatars.findIndex(e=>ht().endsWith(e.model));if(-1===t)return;const n=`avatar-${t}`;queueMicrotask(()=>{const e=document.getElementById(n);e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})}}),i=(r=(n=xt()).firstChild.nextSibling.nextSibling).firstChild,s=i.firstChild,o=i.nextSibling.firstChild,l=(a=r.nextSibling).firstChild,s.$$click=()=>Dt("F"),o.$$click=()=>Dt("M"),Te(n,ie(he,{get when(){return t.length>1},get children(){return[gt(),(e=_t(),Te(e,ie(he,{get when(){return t.includes("Casual")},get children(){var e=ft(),t=e.firstChild;return t.$$click=()=>St("Casual"),S(()=>t.checked="Casual"===Et()),e}}),null),Te(e,ie(he,{get when(){return t.includes("Busi")},get children(){var e=yt(),t=e.firstChild;return t.$$click=()=>St("Busi"),S(()=>t.checked="Busi"===Et()),e}}),null),Te(e,ie(he,{get when(){return t.includes("Medi")},get children(){var e=wt(),t=e.firstChild;return t.$$click=()=>St("Medi"),S(()=>t.checked="Medi"===Et()),e}}),null),Te(e,ie(he,{get when(){return t.includes("Milit")},get children(){var e=bt(),t=e.firstChild;return t.$$click=()=>St("Milit"),S(()=>t.checked="Milit"===Et()),e}}),null),Te(e,ie(he,{get when(){return t.includes("Util")},get children(){var e=vt(),t=e.firstChild;return t.$$click=()=>St("Util"),S(()=>t.checked="Util"===Et()),e}}),null),e)];var e}}),a),Te(l,ie(ue,{get each(){return e.avatars},children:(e,t)=>ie(he,{get when(){return we(()=>e.gender===Ct())()&&e.outfit===Et()},get children(){var n=kt(),r=n.firstChild,i=r.nextSibling,s=i.nextSibling,o=s.nextSibling;return n.$$click=()=>{dt(IE+e.model)},Te(o,()=>e.text),S(o=>{var a=`avatar-${t()}`,l=pt(),c=`avatar ${e.text}`,u=IE+e.image,h={hidden:ht().endsWith(e.model),"group-hover:opacity-75":!ht().endsWith(e.model)},d=!ht().endsWith(e.model);return a!==o.e&&xe(n,"id",o.e=a),l!==o.t&&(n.disabled=o.t=l),c!==o.a&&xe(r,"alt",o.a=c),u!==o.o&&xe(r,"src",o.o=u),o.i=De(i,h,o.i),d!==o.n&&s.classList.toggle("hidden",o.n=d),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),n}})})),S(()=>s.checked="F"===Ct()),S(()=>o.checked="M"===Ct()),n;var n,r,i,s,o,a,l};_e(["click"]);var At=ve('<button class="btn-secondary btn-rounded">');const Pt=localStorage.getItem("micEnabled"),[Rt,Nt]=D("true"===Pt),[Ft,Ot]=D(!1),[Mt,Lt]=D(!1),[Ut,qt]=D(""),[jt,Vt]=D(!1);document.addEventListener("DOMContentLoaded",()=>{Vt(!0);const e=document.querySelector("a-scene"),t=()=>{const t=e?.getAttribute("networked-scene"),n=t.adapter;qt(n),"easyrtc"!==n&&"janus"!==n||("easyrtc"!==n||t.audio)&&Lt(!0)};e.hasLoaded?t():e.addEventListener("loaded",t)});const Bt=e=>{const t=T(()=>!Rt()),n=T(()=>t()?"Unmute Mic":"Mute Mic");return R(()=>{if(NAF.connection.isConnected())Ot(!0);else{const e=()=>{Ot(!0),NAF.connection.adapter?.enableMicrophone?.(P(Rt))};document.body.addEventListener("connected",e),N(()=>{document.body.removeEventListener("connected",e)})}}),I(()=>{if(!jt())return;const n={muted:t()};document.querySelector(e.entity??"#player")?.setAttribute("player-info",n)}),I(()=>{const e=Rt();if(localStorage.setItem("micEnabled",e.toString()),Ft()){if(!NAF.connection.adapter?.enableMicrophone)return void console.error('The specified NAF adapter doesn\'t have the enableMicrophone method, please be sure you have networked-scene="adapter:easyrtc;audio:true" options and networked-audio-source on your avatar template.');NAF.connection.adapter.enableMicrophone(e)}}),ie(he,{get when(){return Mt()},get children(){var e=At();return e.$$click=()=>{Nt(e=>!e),document.activeElement.blur(),document.body.focus()},Te(e,ie(he,{get when(){return!t()},get children(){return ie(ct,{size:24})}}),null),Te(e,ie(he,{get when(){return t()},get children(){return ie(lt,{size:24})}}),null),S(r=>{var i=!t(),s=n();return i!==r.e&&e.classList.toggle("active",r.e=i),s!==r.t&&xe(e,"title",r.t=s),r},{e:void 0,t:void 0}),e}})};_e(["click"]);var zt=ve('<input id=avatarcolor type=color title="Pick a color for your avatar"class="h-7 w-7">'),$t=ve('<div class="flex flex-row items-center"><input id=username type=text class="form-input h-7 px-1">');const[Ht,Gt]=D("user-"+Math.round(1e4*Math.random())),[Wt,Kt]=D("#"+new THREE.Color(Math.random(),Math.random(),Math.random()).getHexString()),[Qt,Yt]=D(!1);document.addEventListener("DOMContentLoaded",()=>{Yt(!0)});const Jt=e=>{return R(()=>{const e=localStorage.getItem("userUsername");if(e)Gt(e),console.log("[Auth] Using authenticated username:",e);else{const e=localStorage.getItem("username");e&&Gt(e)}const t=localStorage.getItem("color");t&&Kt(t)}),I(()=>{if(localStorage.setItem("username",Ht()),localStorage.setItem("color",Wt()),!Qt())return;const t=localStorage.getItem("userUsername")||Ht();console.log("[UsernameInput] Setting display name:",t);const n={name:t,color:Wt()},r=document.querySelector(e.entity??"#player");r?(r.setAttribute("player-info",n),console.log("[UsernameInput] Updated player-info with name:",t)):console.warn("[UsernameInput] Entity not found:",e.entity??"#player")}),t=$t(),(n=t.firstChild).$$input=e=>{Gt(e.target.value)},Te(t,ie(he,{get when(){return e.enableColorPicker??!0},get children(){var e=zt();return e.addEventListener("change",e=>{Kt(e.target.value)}),S(()=>e.value=Wt()),e}}),null),S(()=>n.value=Ht()),t;var t,n};_e(["input"]);const Xt=Symbol("store-raw"),Zt=Symbol("store-node"),en=Symbol("store-has"),tn=Symbol("store-self");function nn(e){let t=e[a];if(!t&&(Object.defineProperty(e,a,{value:t=new Proxy(e,un)}),!Array.isArray(e))){const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let i=0,s=n.length;i<s;i++){const s=n[i];r[s].get&&Object.defineProperty(e,s,{enumerable:r[s].enumerable,get:r[s].get.bind(t)})}}return t}function rn(e){let t;return null!=e&&"object"==typeof e&&(e[a]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function sn(e,t=new Set){let n,r,i,s;if(n=null!=e&&e[Xt])return n;if(!rn(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,s=e.length;n<s;n++)i=e[n],(r=sn(i,t))!==i&&(e[n]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const n=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let a=0,l=n.length;a<l;a++)s=n[a],o[s].get||(i=e[s],(r=sn(i,t))!==i&&(e[s]=r))}return e}function on(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function an(e,t,n){if(e[t])return e[t];const[r,i]=D(n,{equals:!1,internal:!0});return r.$=i,e[t]=r}function ln(e){F()&&an(on(e,Zt),tn)()}function cn(e){return ln(e),Reflect.ownKeys(e)}const un={get(e,t,n){if(t===Xt)return e;if(t===a)return n;if(t===c)return ln(e),n;const r=on(e,Zt),i=r[t];let s=i?i():e[t];if(t===Zt||t===en||"__proto__"===t)return s;if(!i){const n=Object.getOwnPropertyDescriptor(e,t);!F()||"function"==typeof s&&!e.hasOwnProperty(t)||n&&n.get||(s=an(r,t,s)())}return rn(s)?nn(s):s},has:(e,t)=>t===Xt||t===a||t===c||t===Zt||t===en||"__proto__"===t||(F()&&an(on(e,en),t)(),t in e),set:()=>!0,deleteProperty:()=>!0,ownKeys:cn,getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return n&&!n.get&&n.configurable&&t!==a&&t!==Zt?(delete n.value,delete n.writable,n.get=()=>e[a][t],n):n}};function hn(e,t,n,r=!1){if(!r&&e[t]===n)return;const i=e[t],s=e.length;void 0===n?(delete e[t],e[en]&&e[en][t]&&void 0!==i&&e[en][t].$()):(e[t]=n,e[en]&&e[en][t]&&void 0===i&&e[en][t].$());let o,a=on(e,Zt);if((o=an(a,t,i))&&o.$(()=>n),Array.isArray(e)&&e.length!==s){for(let t=e.length;t<s;t++)(o=a[t])&&o.$();(o=an(a,"length",s))&&o.$(e.length)}(o=a[tn])&&o.$()}function dn(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const i=n[r];hn(e,i,t[i])}}function pn(e,t,n=[]){let r,i=e;if(t.length>1){r=t.shift();const s=typeof r,o=Array.isArray(e);if(Array.isArray(r)){for(let i=0;i<r.length;i++)pn(e,[r[i]].concat(t),n);return}if(o&&"function"===s){for(let i=0;i<e.length;i++)r(e[i],i)&&pn(e,[i].concat(t),n);return}if(o&&"object"===s){const{from:i=0,to:s=e.length-1,by:o=1}=r;for(let r=i;r<=s;r+=o)pn(e,[r].concat(t),n);return}if(t.length>1)return void pn(e[r],t,[r].concat(n));i=e[r],n=[r].concat(n)}let s=t[0];"function"==typeof s&&(s=s(i,n),s===i)||void 0===r&&null==s||(s=sn(s),void 0===r||rn(i)&&rn(s)&&!Array.isArray(s)?dn(i,s):hn(e,r,s))}function mn(...[e,t]){const n=sn(e||{}),r=Array.isArray(n);return[nn(n),function(...e){A(()=>{r&&1===e.length?function(e,t){if("function"==typeof t&&(t=t(e)),t=sn(t),Array.isArray(t)){if(e===t)return;let n=0,r=t.length;for(;n<r;n++){const r=t[n];e[n]!==r&&hn(e,n,r)}hn(e,"length",r)}else dn(e,t)}(n,e[0]):pn(n,e)})}]}const gn={get(e,t,n){if(t===Xt)return e;if(t===a)return n;if(t===c)return ln(e),n;const r=on(e,Zt),i=r[t];let s=i?i():e[t];if(t===Zt||t===en||"__proto__"===t)return s;if(!i){const i=Object.getOwnPropertyDescriptor(e,t),o="function"==typeof s;if(!F()||o&&!e.hasOwnProperty(t)||i&&i.get){if(null!=s&&o&&s===Array.prototype[t])return(...e)=>A(()=>Array.prototype[t].apply(n,e))}else s=an(r,t,s)()}return rn(s)?fn(s):s},has:(e,t)=>t===Xt||t===a||t===c||t===Zt||t===en||"__proto__"===t||(F()&&an(on(e,en),t)(),t in e),set:(e,t,n)=>(A(()=>hn(e,t,sn(n))),!0),deleteProperty:(e,t)=>(A(()=>hn(e,t,void 0,!0)),!0),ownKeys:cn,getOwnPropertyDescriptor:function(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||n.set||!n.configurable||t===a||t===Zt||(delete n.value,delete n.writable,n.get=()=>e[a][t],n.set=n=>e[a][t]=n),n}};function fn(e){let t=e[a];if(!t){Object.defineProperty(e,a,{value:t=new Proxy(e,gn)});const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e),i=Object.getPrototypeOf(e),s=null!==i&&null!==e&&"object"==typeof e&&!Array.isArray(e)&&i!==Object.prototype;if(s){let e=i;for(;null!=e;){const t=Object.getOwnPropertyDescriptors(e);n.push(...Object.keys(t)),Object.assign(r,t),e=Object.getPrototypeOf(e)}}for(let i=0,o=n.length;i<o;i++){const o=n[i];if(!s||"constructor"!==o){if(r[o].get){const n=r[o].get.bind(t);Object.defineProperty(e,o,{get:n,configurable:!0})}if(r[o].set){const n=r[o].set,i=e=>A(()=>n.call(t,e));Object.defineProperty(e,o,{set:i,configurable:!0})}}}}return t}Symbol("store-root"),new WeakMap;let yn=/[\.,"]$/;var wn=ve("<a rel=noopener>");let bn=0;function vn(e){return Te(t=wn(),()=>e.children||e.url),S(n=>{var r=e.url.replace(yn,""),i=e.url,s=e.url,o=e.blank||0!==e.url.indexOf(window.location.protocol+"//"+window.location.host+"/")?"_blank"+bn++:null;return r!==n.e&&xe(t,"href",n.e=r),i!==n.t&&xe(t,"title",n.t=i),s!==n.a&&xe(t,"alt",n.a=s),o!==n.o&&xe(t,"target",n.o=o),n},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t}var _n=ve("<video loop autoplay muted><source>");function xn(e){return ie(vn,{get url(){return e.url},blank:!0,get children(){var t=_n(),n=t.firstChild;return Ce(t,"canplay",e.scroll),S(r=>{var i=e.url.replace(yn,""),s=e.url,o=e.url,a=e.url.replace(yn,"");return i!==r.e&&xe(t,"src",r.e=i),s!==r.t&&xe(t,"alt",r.t=s),o!==r.a&&xe(t,"title",r.a=o),a!==r.o&&xe(n,"src",r.o=a),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t}})}var kn=ve("<audio controls=true><source>");function Cn(e){return t=kn(),n=t.firstChild,Ce(t,"canplay",e.scroll),S(r=>{var i=e.url.replace(yn,""),s=e.url,o=e.url,a=e.url.replace(yn,"");return i!==r.e&&xe(t,"src",r.e=i),s!==r.t&&xe(t,"alt",r.t=s),o!==r.a&&xe(t,"title",r.a=o),a!==r.o&&xe(n,"src",r.o=a),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n}var Dn=ve("<img>");function En(e){return ie(vn,{get url(){return e.url},blank:!0,get children(){var t=Dn();return Ce(t,"load",e.scroll),S(n=>{var r=e.url.replace(yn,""),i=e.url,s=e.url;return r!==n.e&&xe(t,"src",n.e=r),i!==n.t&&xe(t,"alt",n.t=i),s!==n.a&&xe(t,"title",n.a=s),n},{e:void 0,t:void 0,a:void 0}),t}})}function Sn(e){let t=fn(sn({url:e}||{}));return fetch(e).then(e=>e.blob()).then(e=>{t.url=URL.createObjectURL(e)}),t}function In(e){let t=e.url;if(/^data:video\/(webm|mp4|mpg|ogv);base64/.test(t)){let n=Sn(t);return ie(xn,{get url(){return n.url},get scroll(){return e.scroll}})}if(/^data:audio\/(wav|mp3|m4a|ogg|oga|opus);base64/.test(t)){let n=Sn(t);return ie(Cn,{get url(){return n.url},get scroll(){return e.scroll}})}if(/^data:image\/(png|apng|jpg|jpeg|gif|svg|webp);base64/.test(t)){let n=Sn(t);return ie(En,{get url(){return n.url},get scroll(){return e.scroll}})}if(/^data:/.test(t)){let e=Sn(t);return ie(vn,{get url(){return e.url}})}return/[\.\/](webm|mp4|mpg|ogv)/gi.test(e.type||t)?ie(xn,{url:t,get scroll(){return e.scroll}}):/[\.\/](wav|mp3|m4a|ogg|oga|opus)/gi.test(e.type||t)?ie(Cn,{url:t,get scroll(){return e.scroll}}):/[\.\/](png|apng|jpg|jpeg|gif|svg|webp)/gi.test(e.type||t)?ie(En,{url:t,get scroll(){return e.scroll}}):e.type?void 0:e.guessType&&/^[^/]+\/\/[^/]+\/.+/.test(t)?function(e,t){const[n,r]=D(e.fallback||t||"");return(e.promise||e).then(e=>void 0!==e&&r(e)),n}(async function(e,t){let n=await fetch(e,{method:0===e.indexOf("blob:")?"GET":"HEAD"});return ie(In,{url:e,scroll:t,type:n.headers.get("Content-Type")})}(t,e.scroll),ie(vn,{url:t})):ie(vn,{url:t})}const Tn=JSON.parse('{"#ABW":"","#AC":"","#AD":"","#AE":"","#AF":"","#AFG":"","#AG":"","#AGO":"","#AHO":"","#AI":"","#AIA":"","#AL":"","#ALA":"","#ALB":"","#ALD":"","#ALG":"","#AM":"","#AND":"","#ANG":"","#ANT":"","#AO":"","#AQ":"","#AR":"","#ARE":"","#ARG":"","#ARM":"","#ARU":"","#AS":"","#ASA":"","#ASM":"","#AT":"","#ATA":"","#ATF":"","#ATG":"","#AU":"","#AUS":"","#AUT":"","#AW":"","#AX":"","#AZ":"","#AZE":"","#BA":"","#BAH":"","#BAN":"","#BAR":"","#BB":"","#BD":"","#BDI":"","#BE":"","#BEL":"","#BEN":"","#BER":"","#BES":"","#BF":"","#BFA":"","#BG":"","#BGD":"","#BGR":"","#BH":"","#BHR":"","#BHS":"","#BHU":"","#BI":"","#BIH":"","#BIZ":"","#BJ":"","#BL":"","#BLM":"","#BLR":"","#BLZ":"","#BM":"","#BMU":"","#BN":"","#BO":"","#BOL":"","#BOT":"","#BQ":"","#BR":"","#BRA":"","#BRB":"","#BRN":"","#BRU":"","#BS":"","#BT":"","#BTN":"","#BUL":"","#BUR":"","#BV":"","#BVT":"","#BW":"","#BWA":"","#BY":"","#BZ":"","#CA":"","#CAF":"","#CAM":"","#CAN":"","#CAY":"","#CC":"","#CCK":"","#CD":"","#CF":"","#CG":"","#CGO":"","#CH":"","#CHA":"","#CHE":"","#CHI":"","#CHL":"","#CHN":"","#CI":"","#CIV":"","#CK":"","#CL":"","#CM":"","#CMR":"","#CN":"","#CO":"","#COD":"","#COG":"","#COK":"","#COL":"","#COM":"","#CP":"","#CPV":"","#CR":"","#CRC":"","#CRI":"","#CRO":"","#CTA":"","#CU":"","#CUB":"","#CUW":"","#CV":"","#CW":"","#CX":"","#CXR":"","#CY":"","#CYM":"","#CYP":"","#CZ":"","#CZE":"","#DE":"","#DEN":"","#DEU":"","#DG":"","#DJ":"","#DJI":"","#DK":"","#DM":"","#DMA":"","#DNK":"","#DO":"","#DOM":"","#DZ":"","#DZA":"","#EA":"","#EC":"","#ECU":"","#EE":"","#EG":"","#EGY":"","#EH":"","#ENG":"","#EQG":"","#ER":"","#ERI":"","#ES":"","#ESA":"","#ESH":"","#ESP":"","#EST":"","#ET":"","#ETH":"","#EU":"","#FAR":"","#FGU":"","#FI":"","#FIJ":"","#FIN":"","#FJ":"","#FJI":"","#FK":"","#FLK":"","#FM":"","#FO":"","#FPO":"","#FR":"","#FRA":"","#FRO":"","#FSM":"","#GA":"","#GAB":"","#GAE":"","#GAM":"","#GAY":"","#GB":"","#GBG":"","#GBJ":"","#GBM":"","#GBR":"","#GBS":"","#GBZ":"","#GD":"","#GE":"","#GEO":"","#GEQ":"","#GER":"","#GF":"","#GG":"","#GGY":"","#GH":"","#GHA":"","#GI":"","#GIB":"","#GIN":"","#GL":"","#GLP":"","#GM":"","#GMB":"","#GN":"","#GNB":"","#GNQ":"","#GP":"","#GQ":"","#GR":"","#GRC":"","#GRD":"","#GRE":"","#GRL":"","#GRN":"","#GS":"","#GT":"","#GTM":"","#GU":"","#GUA":"","#GUD":"","#GUF":"","#GUI":"","#GUM":"","#GUY":"","#GW":"","#GY":"","#HAI":"","#HEL":"","#HK":"","#HKG":"","#HM":"","#HMD":"","#HN":"","#HND":"","#HON":"","#HR":"","#HRV":"","#HT":"","#HTI":"","#HU":"","#HUN":"","#IC":"","#ID":"","#IDN":"","#IE":"","#IL":"","#IM":"","#IMN":"","#IN":"","#INA":"","#IND":"","#IO":"","#IOT":"","#IQ":"","#IR":"","#IRI":"","#IRL":"","#IRN":"","#IRQ":"","#IS":"","#ISL":"","#ISR":"","#ISV":"","#IT":"","#ITA":"","#IVB":"","#JAM":"","#JE":"","#JEY":"","#JM":"","#JO":"","#JOR":"","#JP":"","#JPN":"","#KAZ":"","#KE":"","#KEN":"","#KG":"","#KGZ":"","#KH":"","#KHM":"","#KI":"","#KIR":"","#KM":"","#KN":"","#KNA":"","#KOR":"","#KP":"","#KR":"","#KSA":"","#KUW":"","#KVX":"","#KW":"","#KWT":"","#KY":"","#KZ":"","#LA":"","#LAO":"","#LAT":"","#LB":"","#LBA":"","#LBN":"","#LBR":"","#LBY":"","#LC":"","#LCA":"","#LES":"","#LI":"","#LIB":"","#LIE":"","#LK":"","#LKA":"","#LR":"","#LS":"","#LSO":"","#LT":"","#LTU":"","#LU":"","#LUX":"","#LV":"","#LVA":"","#LY":"","#MA":"","#MAC":"","#MAD":"","#MAF":"","#MAR":"","#MAS":"","#MAW":"","#MAY":"","#MC":"","#MCO":"","#MD":"","#MDA":"","#MDG":"","#MDV":"","#ME":"","#MEX":"","#MF":"","#MG":"","#MGL":"","#MGO":"","#MH":"","#MHL":"","#MK":"","#MKD":"","#ML":"","#MLI":"","#MLT":"","#MM":"","#MMR":"","#MN":"","#MNE":"","#MNG":"","#MNP":"","#MNT":"","#MO":"","#MON":"","#MOZ":"","#MP":"","#MQ":"","#MR":"","#MRI":"","#MRT":"","#MS":"","#MSH":"","#MSR":"","#MT":"","#MTN":"","#MTQ":"","#MU":"","#MUS":"","#MV":"","#MW":"","#MWI":"","#MX":"","#MY":"","#MYA":"","#MYS":"","#MYT":"","#MZ":"","#NA":"","#NAM":"","#NC":"","#NCA":"","#NCD":"","#NCL":"","#NE":"","#NED":"","#NEP":"","#NER":"","#NF":"","#NFI":"","#NFK":"","#NG":"","#NGA":"","#NGR":"","#NI":"","#NIC":"","#NIG":"","#NIU":"","#NL":"","#NLD":"","#NMA":"","#NMI":"","#NO":"","#NOR":"","#NP":"","#NPL":"","#NR":"","#NRU":"","#NU":"","#NZ":"","#NZL":"","#OM":"","#OMA":"","#OMN":"","#PA":"","#PAK":"","#PAN":"","#PAR":"","#PCN":"","#PE":"","#PER":"","#PF":"","#PG":"","#PH":"","#PHI":"","#PHL":"","#PK":"","#PL":"","#PLE":"","#PLU":"","#PLW":"","#PM":"","#PN":"","#PNG":"","#POL":"","#POR":"","#PR":"","#PRI":"","#PRK":"","#PRT":"","#PRY":"","#PS":"","#PSE":"","#PT":"","#PUR":"","#PW":"","#PY":"","#PYF":"","#QA":"","#QAT":"","#RE":"","#REU":"","#RO":"","#ROS":"","#ROU":"","#RS":"","#RSA":"","#RU":"","#RUS":"","#RW":"","#RWA":"","#SA":"","#SAH":"","#SAM":"","#SAU":"","#SB":"","#SC":"","#SCO":"","#SCT":"","#SD":"","#SDN":"","#SE":"","#SEN":"","#SEY":"","#SG":"","#SGP":"","#SGS":"","#SH":"","#SHN":"","#SI":"","#SIN":"","#SJ":"","#SJM":"","#SK":"","#SKN":"","#SL":"","#SLB":"","#SLE":"","#SLO":"","#SLV":"","#SM":"","#SMR":"","#SN":"","#SO":"","#SOL":"","#SOM":"","#SPM":"","#SR":"","#SRB":"","#SRI":"","#SS":"","#SSD":"","#ST":"","#STP":"","#SUD":"","#SUI":"","#SUR":"","#SV":"","#SVK":"","#SVN":"","#SWE":"","#SWZ":"","#SX":"","#SXM":"","#SY":"","#SYC":"","#SYR":"","#SZ":"","#TA":"","#TAH":"","#TAN":"","#TC":"","#TCA":"","#TCD":"","#TD":"","#TF":"","#TG":"","#TGA":"","#TGO":"","#TH":"","#THA":"","#TJ":"","#TJK":"","#TK":"","#TKL":"","#TKM":"","#TKS":"","#TL":"","#TLS":"","#TM":"","#TN":"","#TO":"","#TOG":"","#TON":"","#TPE":"","#TR":"","#TRI":"","#TT":"","#TTO":"","#TUN":"","#TUR":"","#TUV":"","#TV":"","#TW":"","#TWN":"","#TZ":"","#TZA":"","#UA":"","#UAE":"","#UG":"","#UGA":"","#UKR":"","#UM":"","#UMI":"","#UN":"","#URU":"","#URY":"","#US":"","#USA":"","#UY":"","#UZ":"","#UZB":"","#VA":"","#VAN":"","#VAT":"","#VC":"","#VCT":"","#VE":"","#VEN":"","#VG":"","#VGB":"","#VI":"","#VIE":"","#VIN":"","#VIR":"","#VN":"","#VNM":"","#VU":"","#VUT":"","#WAF":"","#WAL":"","#WF":"","#WLF":"","#WLS":"","#WS":"","#WSM":"","#XK":"","#YE":"","#YEM":"","#YT":"","#ZA":"","#ZAF":"","#ZAM":"","#ZIM":"","#ZM":"","#ZMB":"","#ZW":"","#ZWE":"","#":"#",":#:":"#",":*:":"*",":+1:":"",":-1:":"",":0:":"0",":100:":"",":1234:":"",":1:":"1",":2:":"2",":3:":"3",":4:":"4",":5:":"5",":6:":"6",":7:":"7",":8:":"8",":8ball:":"",":9:":"9",":a:":"",":ab:":"",":abacus:":"",":abc:":"",":abcd:":"",":ac:":"",":accept:":"",":ad:":"",":adhesive_bandage:":"",":admission_tickets:":"",":adult:":"",":ae:":"",":aerial_tramway:":"",":af:":"",":ag:":"",":ai:":"",":airplane:":"",":airplane_arriving:":"",":airplane_departure:":"",":airplane_small:":"",":al:":"",":alarm_clock:":"",":alembic:":"",":alien:":"",":am:":"",":ambulance:":"",":amphora:":"",":anchor:":"",":angel:":"",":anger:":"",":anger_right:":"",":angry:":"",":anguished:":"",":ant:":"",":ao:":"",":apple:":"",":aq:":"",":aquarius:":"",":ar:":"",":archery:":"",":aries:":"",":arrow_backward:":"",":arrow_double_down:":"",":arrow_double_up:":"",":arrow_down:":"",":arrow_down_small:":"",":arrow_forward:":"",":arrow_heading_down:":"",":arrow_heading_up:":"",":arrow_left:":"",":arrow_lower_left:":"",":arrow_lower_right:":"",":arrow_right:":"",":arrow_right_hook:":"",":arrow_up:":"",":arrow_up_down:":"",":arrow_up_small:":"",":arrow_upper_left:":"",":arrow_upper_right:":"",":arrows_clockwise:":"",":arrows_counterclockwise:":"",":art:":"",":articulated_lorry:":"",":as:":"",":asterisk:":"*",":asterisk_symbol:":"*",":astonished:":"",":at:":"",":athletic_shoe:":"",":atm:":"",":atom:":"",":atom_symbol:":"",":au:":"",":auto_rickshaw:":"",":avocado:":"",":aw:":"",":ax:":"",":axe:":"",":az:":"",":b:":"",":ba:":"",":baby:":"",":baby_bottle:":"",":baby_chick:":"",":baby_symbol:":"",":back:":"",":back_of_hand:":"",":bacon:":"",":badger:":"",":badminton:":"",":bagel:":"",":baggage_claim:":"",":baguette_bread:":"",":bald:":"",":ballet_shoes:":"",":balloon:":"",":ballot_box:":"",":bamboo:":"",":banana:":"",":bangbang:":"",":banjo:":"",":bank:":"",":bar_chart:":"",":barber:":"",":baseball:":"",":basket:":"",":basketball:":"",":basketball_player:":"",":bat:":"",":bath:":"",":bathtub:":"",":battery:":"",":bb:":"",":bd:":"",":be:":"",":beach:":"",":beach_umbrella:":"",":beach_with_umbrella:":"",":bear:":"",":bearded_person:":"",":bed:":"",":bee:":"",":beer:":"",":beers:":"",":beetle:":"",":beginner:":"",":bell:":"",":bellhop:":"",":bellhop_bell:":"",":bento:":"",":beverage_box:":"",":bf:":"",":bg:":"",":bh:":"",":bi:":"",":bicyclist:":"",":bike:":"",":bikini:":"",":billed_cap:":"",":biohazard:":"",":biohazard_sign:":"",":bird:":"",":birthday:":"",":bj:":"",":bl:":"",":black_circle:":"",":black_heart:":"",":black_joker:":"",":black_large_square:":"",":black_medium_square:":"",":black_nib:":"",":black_small_square:":"",":black_square_button:":"",":blond-haired_man:":"",":blond-haired_woman:":"",":blond_haired_person:":"",":blossom:":"",":blowfish:":"",":blue_book:":"",":blue_car:":"",":blue_circle:":"",":blue_heart:":"",":blue_square:":"",":blush:":"",":bm:":"",":bn:":"",":bo:":"",":boar:":"",":bomb:":"",":bone:":"",":book:":"",":bookmark:":"",":bookmark_tabs:":"",":books:":"",":boom:":"",":boot:":"",":bouquet:":"",":bow:":"",":bow_and_arrow:":"",":bowl_with_spoon:":"",":bowling:":"",":boxing_glove:":"",":boxing_gloves:":"",":boy:":"",":bq:":"",":br:":"",":brain:":"",":bread:":"",":breast_feeding:":"",":bricks:":"",":bride_with_veil:":"",":bridge_at_night:":"",":briefcase:":"",":briefs:":"",":broccoli:":"",":broken_heart:":"",":broom:":"",":brown_circle:":"",":brown_heart:":"",":brown_square:":"",":bs:":"",":bt:":"",":bug:":"",":building_construction:":"",":bulb:":"",":bullettrain_front:":"",":bullettrain_side:":"",":burrito:":"",":bus:":"",":busstop:":"",":bust_in_silhouette:":"",":busts_in_silhouette:":"",":butter:":"",":butterfly:":"",":bv:":"",":bw:":"",":by:":"",":bz:":"",":ca:":"",":cactus:":"",":cake:":"",":calendar:":"",":calendar_spiral:":"",":call_me:":"",":call_me_hand:":"",":calling:":"",":camel:":"",":camera:":"",":camera_with_flash:":"",":camping:":"",":cancer:":"",":candle:":"",":candy:":"",":canned_food:":"",":canoe:":"",":capital_abcd:":"",":capricorn:":"",":card_box:":"",":card_file_box:":"",":card_index:":"",":card_index_dividers:":"",":carousel_horse:":"",":carrot:":"",":cartwheel:":"",":cat2:":"",":cat:":"",":cc:":"",":cd:":"",":cf:":"",":cg:":"",":ch:":"",":chains:":"",":chair:":"",":champagne:":"",":champagne_glass:":"",":chart:":"",":checkered_flag:":"",":cheese:":"",":cheese_wedge:":"",":cherries:":"",":cherry_blossom:":"",":chess_pawn:":"",":chestnut:":"",":chicken:":"",":child:":"",":children_crossing:":"",":chile:":"",":chipmunk:":"",":chocolate_bar:":"",":chopsticks:":"",":christmas_tree:":"",":church:":"",":ci:":"",":cinema:":"",":circus_tent:":"",":city_dusk:":"",":city_sunrise:":"",":city_sunset:":"",":cityscape:":"",":ck:":"",":cl:":"",":clap:":"",":clapper:":"",":classical_building:":"",":clinking_glass:":"",":clipboard:":"",":clock1030:":"",":clock10:":"",":clock1130:":"",":clock11:":"",":clock1230:":"",":clock12:":"",":clock130:":"",":clock1:":"",":clock230:":"",":clock2:":"",":clock330:":"",":clock3:":"",":clock430:":"",":clock4:":"",":clock530:":"",":clock5:":"",":clock630:":"",":clock6:":"",":clock730:":"",":clock7:":"",":clock830:":"",":clock8:":"",":clock930:":"",":clock9:":"",":clock:":"",":closed_book:":"",":closed_umbrella:":"",":cloud:":"",":cloud_lightning:":"",":cloud_rain:":"",":cloud_snow:":"",":cloud_tornado:":"",":cloud_with_lightning:":"",":cloud_with_rain:":"",":cloud_with_snow:":"",":cloud_with_tornado:":"",":clown:":"",":clown_face:":"",":clubs:":"",":cm:":"",":cn:":"",":co:":"",":coat:":"",":cocktail:":"",":coconut:":"",":coffee:":"",":coffin:":"",":cold_face:":"",":cold_sweat:":"",":comet:":"",":compass:":"",":compression:":"",":computer:":"",":confetti_ball:":"",":confounded:":"",":confused:":"",":congo:":"",":congratulations:":"",":construction:":"",":construction_site:":"",":construction_worker:":"",":control_knobs:":"",":convenience_store:":"",":cookie:":"",":cooking:":"",":cool:":"",":cop:":"",":copyright:":"",":corn:":"",":couch:":"",":couch_and_lamp:":"",":couple:":"",":couple_mm:":"",":couple_with_heart:":"",":couple_ww:":"",":couplekiss:":"",":couplekiss_mm:":"",":couplekiss_ww:":"",":cow2:":"",":cow:":"",":cowboy:":"",":cp:":"",":cr:":"",":crab:":"",":crayon:":"",":credit_card:":"",":crescent_moon:":"",":cricket:":"",":cricket_bat_ball:":"",":cricket_game:":"",":crocodile:":"",":croissant:":"",":cross:":"",":crossed_flags:":"",":crossed_swords:":"",":crown:":"",":cruise_ship:":"",":cry:":"",":crying_cat_face:":"",":crystal_ball:":"",":cu:":"",":cucumber:":"",":cup_with_straw:":"",":cupcake:":"",":cupid:":"",":curling_stone:":"",":curly_haired:":"",":curly_loop:":"",":currency_exchange:":"",":curry:":"",":custard:":"",":customs:":"",":cut_of_meat:":"",":cv:":"",":cw:":"",":cx:":"",":cy:":"",":cyclone:":"",":cz:":"",":dagger:":"",":dagger_knife:":"",":dancer:":"",":dancers:":"",":dango:":"",":dark_sunglasses:":"",":dart:":"",":dash:":"",":date:":"",":de:":"",":deaf_man:":"",":deaf_person:":"",":deaf_woman:":"",":deciduous_tree:":"",":deer:":"",":department_store:":"",":derelict_house_building:":"",":desert:":"",":desert_island:":"",":desktop:":"",":desktop_computer:":"",":detective:":"",":dg:":"",":diamonds:":"",":disappointed:":"",":disappointed_relieved:":"",":dividers:":"",":diving_mask:":"",":diya_lamp:":"",":dizzy:":"",":dizzy_face:":"",":dj:":"",":dk:":"",":dm:":"",":dna:":"",":do:":"",":do_not_litter:":"",":dog2:":"",":dog:":"",":dollar:":"",":dolls:":"",":dolphin:":"",":door:":"",":double_vertical_bar:":"",":doughnut:":"",":dove:":"",":dove_of_peace:":"",":dragon:":"",":dragon_face:":"",":dress:":"",":dromedary_camel:":"",":drool:":"",":drooling_face:":"",":drop_of_blood:":"",":droplet:":"",":drum:":"",":drum_with_drumsticks:":"",":duck:":"",":dumpling:":"",":dvd:":"",":dz:":"",":e-mail:":"",":ea:":"",":eagle:":"",":ear:":"",":ear_of_rice:":"",":earth_africa:":"",":earth_americas:":"",":earth_asia:":"",":ec:":"",":ee:":"",":eg:":"",":egg:":"",":eggplant:":"",":eh:":"",":eight:":"8",":eight_spoked_asterisk:":"",":eject:":"",":eject_symbol:":"",":electric_plug:":"",":elephant:":"",":elf:":"",":email:":"",":end:":"",":england:":"",":envelope:":"",":envelope_with_arrow:":"",":er:":"",":es:":"",":et:":"",":eu:":"",":euro:":"",":european_castle:":"",":european_post_office:":"",":evergreen_tree:":"",":exclamation:":"",":expecting_woman:":"",":exploding_head:":"",":expressionless:":"",":eye:":"",":eyeglasses:":"",":eyes:":"",":face_palm:":"",":face_vomiting:":"",":face_with_monocle:":"",":face_with_thermometer:":"",":facepalm:":"",":factory:":"",":fairy:":"",":falafel:":"",":fallen_leaf:":"",":family:":"",":family_man_boy:":"",":family_man_girl:":"",":family_mmb:":"",":family_mmbb:":"",":family_mmg:":"",":family_mmgb:":"",":family_mmgg:":"",":family_mwbb:":"",":family_mwg:":"",":family_mwgb:":"",":family_mwgg:":"",":family_woman_boy:":"",":family_woman_girl:":"",":family_wwb:":"",":family_wwbb:":"",":family_wwg:":"",":family_wwgb:":"",":family_wwgg:":"",":fast_forward:":"",":fax:":"",":fearful:":"",":feet:":"",":female_sign:":"",":fencer:":"",":fencing:":"",":ferris_wheel:":"",":ferry:":"",":fi:":"",":field_hockey:":"",":file_cabinet:":"",":file_folder:":"",":film_frames:":"",":film_projector:":"",":fingers_crossed:":"",":fire:":"",":fire_engine:":"",":fire_extinguisher:":"",":firecracker:":"",":fireworks:":"",":first_place:":"",":first_place_medal:":"",":first_quarter_moon:":"",":fish:":"",":fish_cake:":"",":fist:":"",":five:":"5",":fj:":"",":fk:":"",":flag_ac:":"",":flag_ad:":"",":flag_ae:":"",":flag_af:":"",":flag_ag:":"",":flag_ai:":"",":flag_al:":"",":flag_am:":"",":flag_ao:":"",":flag_aq:":"",":flag_ar:":"",":flag_as:":"",":flag_at:":"",":flag_au:":"",":flag_aw:":"",":flag_ax:":"",":flag_az:":"",":flag_ba:":"",":flag_bb:":"",":flag_bd:":"",":flag_be:":"",":flag_bf:":"",":flag_bg:":"",":flag_bh:":"",":flag_bi:":"",":flag_bj:":"",":flag_bl:":"",":flag_black:":"",":flag_bm:":"",":flag_bn:":"",":flag_bo:":"",":flag_bq:":"",":flag_br:":"",":flag_bs:":"",":flag_bt:":"",":flag_bv:":"",":flag_bw:":"",":flag_by:":"",":flag_bz:":"",":flag_ca:":"",":flag_cc:":"",":flag_cd:":"",":flag_cf:":"",":flag_cg:":"",":flag_ch:":"",":flag_ci:":"",":flag_ck:":"",":flag_cl:":"",":flag_cm:":"",":flag_cn:":"",":flag_co:":"",":flag_cp:":"",":flag_cr:":"",":flag_cu:":"",":flag_cv:":"",":flag_cw:":"",":flag_cx:":"",":flag_cy:":"",":flag_cz:":"",":flag_de:":"",":flag_dg:":"",":flag_dj:":"",":flag_dk:":"",":flag_dm:":"",":flag_do:":"",":flag_dz:":"",":flag_ea:":"",":flag_ec:":"",":flag_ee:":"",":flag_eg:":"",":flag_eh:":"",":flag_er:":"",":flag_es:":"",":flag_et:":"",":flag_eu:":"",":flag_fi:":"",":flag_fj:":"",":flag_fk:":"",":flag_fm:":"",":flag_fo:":"",":flag_fr:":"",":flag_ga:":"",":flag_gb:":"",":flag_gd:":"",":flag_ge:":"",":flag_gf:":"",":flag_gg:":"",":flag_gh:":"",":flag_gi:":"",":flag_gl:":"",":flag_gm:":"",":flag_gn:":"",":flag_gp:":"",":flag_gq:":"",":flag_gr:":"",":flag_gs:":"",":flag_gt:":"",":flag_gu:":"",":flag_gw:":"",":flag_gy:":"",":flag_hk:":"",":flag_hm:":"",":flag_hn:":"",":flag_hr:":"",":flag_ht:":"",":flag_hu:":"",":flag_ic:":"",":flag_id:":"",":flag_ie:":"",":flag_il:":"",":flag_im:":"",":flag_in:":"",":flag_io:":"",":flag_iq:":"",":flag_ir:":"",":flag_is:":"",":flag_it:":"",":flag_je:":"",":flag_jm:":"",":flag_jo:":"",":flag_jp:":"",":flag_ke:":"",":flag_kg:":"",":flag_kh:":"",":flag_ki:":"",":flag_km:":"",":flag_kn:":"",":flag_kp:":"",":flag_kr:":"",":flag_kw:":"",":flag_ky:":"",":flag_kz:":"",":flag_la:":"",":flag_lb:":"",":flag_lc:":"",":flag_li:":"",":flag_lk:":"",":flag_lr:":"",":flag_ls:":"",":flag_lt:":"",":flag_lu:":"",":flag_lv:":"",":flag_ly:":"",":flag_ma:":"",":flag_mc:":"",":flag_md:":"",":flag_me:":"",":flag_mf:":"",":flag_mg:":"",":flag_mh:":"",":flag_mk:":"",":flag_ml:":"",":flag_mm:":"",":flag_mn:":"",":flag_mo:":"",":flag_mp:":"",":flag_mq:":"",":flag_mr:":"",":flag_ms:":"",":flag_mt:":"",":flag_mu:":"",":flag_mv:":"",":flag_mw:":"",":flag_mx:":"",":flag_my:":"",":flag_mz:":"",":flag_na:":"",":flag_nc:":"",":flag_ne:":"",":flag_nf:":"",":flag_ng:":"",":flag_ni:":"",":flag_nl:":"",":flag_no:":"",":flag_np:":"",":flag_nr:":"",":flag_nu:":"",":flag_nz:":"",":flag_om:":"",":flag_pa:":"",":flag_pe:":"",":flag_pf:":"",":flag_pg:":"",":flag_ph:":"",":flag_pk:":"",":flag_pl:":"",":flag_pm:":"",":flag_pn:":"",":flag_pr:":"",":flag_ps:":"",":flag_pt:":"",":flag_pw:":"",":flag_py:":"",":flag_qa:":"",":flag_re:":"",":flag_ro:":"",":flag_rs:":"",":flag_ru:":"",":flag_rw:":"",":flag_sa:":"",":flag_sb:":"",":flag_sc:":"",":flag_sd:":"",":flag_se:":"",":flag_sg:":"",":flag_sh:":"",":flag_si:":"",":flag_sj:":"",":flag_sk:":"",":flag_sl:":"",":flag_sm:":"",":flag_sn:":"",":flag_so:":"",":flag_sr:":"",":flag_ss:":"",":flag_st:":"",":flag_sv:":"",":flag_sx:":"",":flag_sy:":"",":flag_sz:":"",":flag_ta:":"",":flag_tc:":"",":flag_td:":"",":flag_tf:":"",":flag_tg:":"",":flag_th:":"",":flag_tj:":"",":flag_tk:":"",":flag_tl:":"",":flag_tm:":"",":flag_tn:":"",":flag_to:":"",":flag_tr:":"",":flag_tt:":"",":flag_tv:":"",":flag_tw:":"",":flag_tz:":"",":flag_ua:":"",":flag_ug:":"",":flag_um:":"",":flag_us:":"",":flag_uy:":"",":flag_uz:":"",":flag_va:":"",":flag_vc:":"",":flag_ve:":"",":flag_vg:":"",":flag_vi:":"",":flag_vn:":"",":flag_vu:":"",":flag_wf:":"",":flag_white:":"",":flag_ws:":"",":flag_xk:":"",":flag_ye:":"",":flag_yt:":"",":flag_za:":"",":flag_zm:":"",":flag_zw:":"",":flags:":"",":flame:":"",":flamingo:":"",":flan:":"",":flashlight:":"",":fleur-de-lis:":"",":floppy_disk:":"",":flower_playing_cards:":"",":flushed:":"",":flying_disc:":"",":flying_saucer:":"",":fm:":"",":fo:":"",":fog:":"",":foggy:":"",":foot:":"",":football:":"",":footprints:":"",":fork_and_knife:":"",":fork_knife_plate:":"",":fortune_cookie:":"",":fountain:":"",":four:":"4",":four_leaf_clover:":"",":fox:":"",":fox_face:":"",":fr:":"",":frame_photo:":"",":frame_with_picture:":"",":free:":"",":french_bread:":"",":fried_shrimp:":"",":fries:":"",":frog:":"",":frowning2:":"",":frowning:":"",":fuelpump:":"",":full_moon:":"",":funeral_urn:":"",":ga:":"",":game_die:":"",":garlic:":"",":gay_pride_flag:":"",":gb:":"",":gd:":"",":ge:":"",":gear:":"",":gem:":"",":gemini:":"",":genie:":"",":gf:":"",":gg:":"",":gh:":"",":ghost:":"",":gi:":"",":gift:":"",":gift_heart:":"",":giraffe:":"",":girl:":"",":gl:":"",":glass_of_milk:":"",":globe_with_meridians:":"",":gloves:":"",":gm:":"",":gn:":"",":goal:":"",":goal_net:":"",":goat:":"",":goggles:":"",":golf:":"",":golfer:":"",":gorilla:":"",":gp:":"",":gq:":"",":gr:":"",":grandma:":"",":grapes:":"",":green_apple:":"",":green_book:":"",":green_circle:":"",":green_heart:":"",":green_salad:":"",":green_square:":"",":grey_exclamation:":"",":grey_question:":"",":grimacing:":"",":grin:":"",":grinning:":"",":gs:":"",":gt:":"",":gu:":"",":guard:":"",":guardsman:":"",":guide_dog:":"",":guitar:":"",":gun:":"",":gw:":"",":gy:":"",":haircut:":"",":hamburger:":"",":hammer:":"",":hammer_and_pick:":"",":hammer_and_wrench:":"",":hammer_pick:":"",":hamster:":"",":hand_splayed:":"",":handbag:":"",":handball:":"",":handshake:":"",":hankey:":"",":hash:":"#",":hatched_chick:":"",":hatching_chick:":"",":head_bandage:":"",":headphones:":"",":hear_no_evil:":"",":heart:":"",":heart_decoration:":"",":heart_exclamation:":"",":heart_eyes:":"",":heart_eyes_cat:":"",":heartbeat:":"",":heartpulse:":"",":hearts:":"",":heavy_check_mark:":"",":heavy_division_sign:":"",":heavy_dollar_sign:":"",":heavy_minus_sign:":"",":heavy_multiplication_x:":"",":heavy_plus_sign:":"",":hedgehog:":"",":helicopter:":"",":helmet_with_cross:":"",":herb:":"",":hibiscus:":"",":high_brightness:":"",":high_heel:":"",":hiking_boot:":"",":hindu_temple:":"",":hippopotamus:":"",":hk:":"",":hm:":"",":hn:":"",":hockey:":"",":hole:":"",":homes:":"",":honey_pot:":"",":horse:":"",":horse_racing:":"",":hospital:":"",":hot_dog:":"",":hot_face:":"",":hot_pepper:":"",":hotdog:":"",":hotel:":"",":hotsprings:":"",":hourglass:":"",":hourglass_flowing_sand:":"",":house:":"",":house_abandoned:":"",":house_buildings:":"",":house_with_garden:":"",":hr:":"",":ht:":"",":hu:":"",":hugging:":"",":hugging_face:":"",":hushed:":"",":ic:":"",":ice_cream:":"",":ice_cube:":"",":ice_skate:":"",":icecream:":"",":id:":"",":ideograph_advantage:":"",":ie:":"",":il:":"",":im:":"",":imp:":"",":in:":"",":inbox_tray:":"",":incoming_envelope:":"",":indonesia:":"",":infinity:":"",":information_desk_person:":"",":information_source:":"",":innocent:":"",":interrobang:":"",":io:":"",":iphone:":"",":iq:":"",":ir:":"",":is:":"",":island:":"",":it:":"",":izakaya_lantern:":"",":jack_o_lantern:":"",":japan:":"",":japanese_castle:":"",":japanese_goblin:":"",":japanese_ogre:":"",":je:":"",":jeans:":"",":jigsaw:":"",":jm:":"",":jo:":"",":joy:":"",":joy_cat:":"",":joystick:":"",":jp:":"",":juggler:":"",":juggling:":"",":kaaba:":"",":kangaroo:":"",":karate_uniform:":"",":kayak:":"",":ke:":"",":key2:":"",":key:":"",":keyboard:":"",":keycap_asterisk:":"*",":keycap_ten:":"",":kg:":"",":kh:":"",":ki:":"",":kimono:":"",":kiss:":"",":kiss_mm:":"",":kiss_woman_man:":"",":kiss_ww:":"",":kissing:":"",":kissing_cat:":"",":kissing_closed_eyes:":"",":kissing_heart:":"",":kissing_smiling_eyes:":"",":kite:":"",":kiwi:":"",":kiwifruit:":"",":km:":"",":kn:":"",":knife:":"",":koala:":"",":koko:":"",":kp:":"",":kr:":"",":kw:":"",":ky:":"",":kz:":"",":la:":"",":lab_coat:":"",":label:":"",":lacrosse:":"",":large_blue_diamond:":"",":large_orange_diamond:":"",":last_quarter_moon:":"",":latin_cross:":"",":laughing:":"",":lb:":"",":lc:":"",":leafy_green:":"",":leaves:":"",":ledger:":"",":left_facing_fist:":"",":left_fist:":"",":left_luggage:":"",":left_right_arrow:":"",":left_speech_bubble:":"",":leg:":"",":lemon:":"",":leo:":"",":leopard:":"",":level_slider:":"",":levitate:":"",":li:":"",":liar:":"",":libra:":"",":lifter:":"",":light_rail:":"",":link:":"",":linked_paperclips:":"",":lion:":"",":lion_face:":"",":lips:":"",":lipstick:":"",":lizard:":"",":lk:":"",":llama:":"",":lobster:":"",":lock:":"",":lollipop:":"",":loop:":"",":loud_sound:":"",":loudspeaker:":"",":love_hotel:":"",":love_letter:":"",":love_you_gesture:":"",":low_brightness:":"",":lower_left_crayon:":"",":lower_left_paintbrush:":"",":lr:":"",":ls:":"",":lt:":"",":lu:":"",":luggage:":"",":lv:":"",":ly:":"",":lying_face:":"",":m:":"",":ma:":"",":mag:":"",":mag_right:":"",":mage:":"",":magnet:":"",":mahjong:":"",":mailbox:":"",":mailbox_closed:":"",":mailbox_with_mail:":"",":male_dancer:":"",":male_sign:":"",":man:":"",":man_artist:":"",":man_astronaut:":"",":man_bald:":"",":man_biking:":"",":man_bouncing_ball:":"",":man_bowing:":"",":man_cartwheeling:":"",":man_climbing:":"",":man_construction_worker:":"",":man_cook:":"",":man_curly_haired:":"",":man_dancing:":"",":man_detective:":"",":man_elf:":"",":man_facepalming:":"",":man_factory_worker:":"",":man_fairy:":"",":man_farmer:":"",":man_firefighter:":"",":man_frowning:":"",":man_genie:":"",":man_gesturing_no:":"",":man_gesturing_ok:":"",":man_getting_haircut:":"",":man_golfing:":"",":man_guard:":"",":man_health_worker:":"",":man_in_tuxedo:":"",":man_judge:":"",":man_juggling:":"",":man_kneeling:":"",":man_lifting_weights:":"",":man_mage:":"",":man_mechanic:":"",":man_mountain_biking:":"",":man_office_worker:":"",":man_pilot:":"",":man_playing_handball:":"",":man_police_officer:":"",":man_pouting:":"",":man_raising_hand:":"",":man_red_haired:":"",":man_rowing_boat:":"",":man_running:":"",":man_scientist:":"",":man_shrugging:":"",":man_singer:":"",":man_standing:":"",":man_student:":"",":man_superhero:":"",":man_supervillain:":"",":man_surfing:":"",":man_swimming:":"",":man_teacher:":"",":man_technologist:":"",":man_tipping_hand:":"",":man_vampire:":"",":man_walking:":"",":man_wearing_turban:":"",":man_white_haired:":"",":man_with_turban:":"",":man_zombie:":"",":mango:":"",":mans_shoe:":"",":mantlepiece_clock:":"",":manual_wheelchair:":"",":map:":"",":maple_leaf:":"",":martial_arts_uniform:":"",":mask:":"",":massage:":"",":mate:":"",":mc:":"",":md:":"",":me:":"",":meat_on_bone:":"",":mechanical_arm:":"",":mechanical_leg:":"",":medal:":"",":medical_symbol:":"",":mega:":"",":melon:":"",":memo:":"",":men_wrestling:":"",":menorah:":"",":mens:":"",":mermaid:":"",":merman:":"",":merperson:":"",":metal:":"",":metro:":"",":mf:":"",":mg:":"",":mh:":"",":microbe:":"",":microphone2:":"",":microphone:":"",":microscope:":"",":middle_finger:":"",":military_medal:":"",":milk:":"",":milky_way:":"",":minibus:":"",":minidisc:":"",":mk:":"",":ml:":"",":mm:":"",":mn:":"",":mo:":"",":mobile_phone_off:":"",":money_mouth:":"",":money_mouth_face:":"",":money_with_wings:":"",":moneybag:":"",":monkey:":"",":monkey_face:":"",":monorail:":"",":moon_cake:":"",":mortar_board:":"",":mosque:":"",":mosquito:":"",":mother_christmas:":"",":motor_scooter:":"",":motorbike:":"",":motorboat:":"",":motorcycle:":"",":motorized_wheelchair:":"",":motorway:":"",":mount_fuji:":"",":mountain:":"",":mountain_bicyclist:":"",":mountain_cableway:":"",":mountain_railway:":"",":mountain_snow:":"",":mouse2:":"",":mouse:":"",":mouse_three_button:":"",":movie_camera:":"",":moyai:":"",":mp:":"",":mq:":"",":mr:":"",":mrs_claus:":"",":ms:":"",":mt:":"",":mu:":"",":muscle:":"",":mushroom:":"",":musical_keyboard:":"",":musical_note:":"",":musical_score:":"",":mute:":"",":mv:":"",":mw:":"",":mx:":"",":my:":"",":mz:":"",":na:":"",":nail_care:":"",":name_badge:":"",":national_park:":"",":nauseated_face:":"",":nazar_amulet:":"",":nc:":"",":ne:":"",":necktie:":"",":nerd:":"",":nerd_face:":"",":neutral_face:":"",":new:":"",":new_moon:":"",":newspaper2:":"",":newspaper:":"",":next_track:":"",":nf:":"",":ng:":"",":ni:":"",":nigeria:":"",":night_with_stars:":"",":nine:":"9",":nl:":"",":no:":"",":no_bell:":"",":no_bicycles:":"",":no_entry:":"",":no_entry_sign:":"",":no_good:":"",":no_mobile_phones:":"",":no_mouth:":"",":no_pedestrians:":"",":no_smoking:":"",":non-potable_water:":"",":nose:":"",":notebook:":"",":notepad_spiral:":"",":notes:":"",":np:":"",":nr:":"",":nu:":"",":nut_and_bolt:":"",":nz:":"",":o2:":"",":o:":"",":ocean:":"",":octagonal_sign:":"",":octopus:":"",":oden:":"",":office:":"",":oil:":"",":oil_drum:":"",":ok:":"",":ok_hand:":"",":ok_woman:":"",":old_key:":"",":older_adult:":"",":older_man:":"",":older_woman:":"",":om:":"",":om_symbol:":"",":on:":"",":oncoming_automobile:":"",":oncoming_bus:":"",":oncoming_police_car:":"",":oncoming_taxi:":"",":one:":"1",":one_piece_swimsuit:":"",":onion:":"",":open_file_folder:":"",":open_hands:":"",":open_mouth:":"",":ophiuchus:":"",":orange_book:":"",":orange_circle:":"",":orange_heart:":"",":orange_square:":"",":orangutan:":"",":orthodox_cross:":"",":otter:":"",":outbox_tray:":"",":owl:":"",":ox:":"",":oyster:":"",":pa:":"",":package:":"",":paella:":"",":page_facing_up:":"",":page_with_curl:":"",":pager:":"",":paintbrush:":"",":palm_tree:":"",":palms_up_together:":"",":pancakes:":"",":panda_face:":"",":paperclip:":"",":paperclips:":"",":parachute:":"",":park:":"",":parking:":"",":parrot:":"",":part_alternation_mark:":"",":partly_sunny:":"",":partying_face:":"",":passenger_ship:":"",":passport_control:":"",":pause_button:":"",":paw_prints:":"",":pe:":"",":peace:":"",":peace_symbol:":"",":peach:":"",":peacock:":"",":peanuts:":"",":pear:":"",":pen_ballpoint:":"",":pen_fountain:":"",":pencil2:":"",":pencil:":"",":penguin:":"",":pensive:":"",":people_holding_hands:":"",":people_wrestling:":"",":performing_arts:":"",":persevere:":"",":person_biking:":"",":person_bouncing_ball:":"",":person_bowing:":"",":person_climbing:":"",":person_doing_cartwheel:":"",":person_facepalming:":"",":person_fencing:":"",":person_frowning:":"",":person_gesturing_no:":"",":person_gesturing_ok:":"",":person_getting_haircut:":"",":person_getting_massage:":"",":person_golfing:":"",":person_juggling:":"",":person_kneeling:":"",":person_lifting_weights:":"",":person_mountain_biking:":"",":person_playing_handball:":"",":person_pouting:":"",":person_raising_hand:":"",":person_rowing_boat:":"",":person_running:":"",":person_shrugging:":"",":person_standing:":"",":person_surfing:":"",":person_swimming:":"",":person_tipping_hand:":"",":person_walking:":"",":person_wearing_turban:":"",":person_with_ball:":"",":petri_dish:":"",":pf:":"",":pg:":"",":ph:":"",":pick:":"",":pie:":"",":pig2:":"",":pig:":"",":pig_nose:":"",":pill:":"",":pinching_hand:":"",":pineapple:":"",":ping_pong:":"",":pirate_flag:":"",":pisces:":"",":pizza:":"",":pk:":"",":pl:":"",":place_of_worship:":"",":play_pause:":"",":pleading_face:":"",":pm:":"",":pn:":"",":point_down:":"",":point_left:":"",":point_right:":"",":point_up:":"",":point_up_2:":"",":police_car:":"",":police_officer:":"",":poo:":"",":poodle:":"",":poop:":"",":popcorn:":"",":post_office:":"",":postal_horn:":"",":postbox:":"",":potable_water:":"",":potato:":"",":pouch:":"",":poultry_leg:":"",":pound:":"",":pound_symbol:":"#",":pouting_cat:":"",":pr:":"",":pray:":"",":prayer_beads:":"",":pregnant_woman:":"",":pretzel:":"",":previous_track:":"",":prince:":"",":princess:":"",":printer:":"",":probing_cane:":"",":projector:":"",":ps:":"",":pt:":"",":pudding:":"",":punch:":"",":purple_circle:":"",":purple_heart:":"",":purple_square:":"",":purse:":"",":pushpin:":"",":pw:":"",":py:":"",":qa:":"",":question:":"",":rabbit2:":"",":rabbit:":"",":raccoon:":"",":race_car:":"",":racehorse:":"",":racing_car:":"",":racing_motorcycle:":"",":radio:":"",":radio_button:":"",":radioactive:":"",":radioactive_sign:":"",":rage:":"",":railroad_track:":"",":railway_car:":"",":railway_track:":"",":rainbow:":"",":rainbow_flag:":"",":raised_hand:":"",":raised_hands:":"",":raising_hand:":"",":ram:":"",":ramen:":"",":rat:":"",":razor:":"",":re:":"",":receipt:":"",":record_button:":"",":recycle:":"",":red_car:":"",":red_circle:":"",":red_envelope:":"",":red_haired:":"",":red_square:":"",":registered:":"",":relaxed:":"",":relieved:":"",":reminder_ribbon:":"",":repeat:":"",":repeat_one:":"",":restroom:":"",":revolving_hearts:":"",":rewind:":"",":rhino:":"",":rhinoceros:":"",":ribbon:":"",":rice:":"",":rice_ball:":"",":rice_cracker:":"",":rice_scene:":"",":right_anger_bubble:":"",":right_facing_fist:":"",":right_fist:":"",":ring:":"",":ringed_planet:":"",":ro:":"",":robot:":"",":robot_face:":"",":rocket:":"",":rofl:":"",":roll_of_paper:":"",":rolled_up_newspaper:":"",":roller_coaster:":"",":rolling_eyes:":"",":rooster:":"",":rose:":"",":rosette:":"",":rotating_light:":"",":round_pushpin:":"",":rowboat:":"",":rs:":"",":ru:":"",":rugby_football:":"",":runner:":"",":rw:":"",":sa:":"",":safety_pin:":"",":safety_vest:":"",":sagittarius:":"",":sailboat:":"",":sake:":"",":salad:":"",":salt:":"",":sandal:":"",":sandwich:":"",":santa:":"",":sari:":"",":satellite:":"",":satellite_orbital:":"",":satisfied:":"",":saudi:":"",":saudiarabia:":"",":sauropod:":"",":saxophone:":"",":sb:":"",":sc:":"",":scales:":"",":scarf:":"",":school:":"",":school_satchel:":"",":scissors:":"",":scooter:":"",":scorpion:":"",":scorpius:":"",":scotland:":"",":scream:":"",":scream_cat:":"",":scroll:":"",":sd:":"",":se:":"",":seat:":"",":second_place:":"",":second_place_medal:":"",":secret:":"",":see_no_evil:":"",":seedling:":"",":selfie:":"",":service_dog:":"",":seven:":"7",":sg:":"",":sh:":"",":shaking_hands:":"",":shamrock:":"",":shark:":"",":shaved_ice:":"",":sheep:":"",":shell:":"",":shelled_peanut:":"",":shield:":"",":shinto_shrine:":"",":ship:":"",":shirt:":"",":shit:":"",":shopping_bags:":"",":shopping_cart:":"",":shopping_trolley:":"",":shorts:":"",":shower:":"",":shrimp:":"",":shrug:":"",":shushing_face:":"",":si:":"",":sick:":"",":signal_strength:":"",":six:":"6",":six_pointed_star:":"",":sj:":"",":sk:":"",":skateboard:":"",":skeleton:":"",":ski:":"",":skier:":"",":skull:":"",":skull_and_crossbones:":"",":skull_crossbones:":"",":skunk:":"",":sl:":"",":sled:":"",":sleeping:":"",":sleeping_accommodation:":"",":sleepy:":"",":sleuth_or_spy:":"",":slight_frown:":"",":slight_smile:":"",":slightly_frowning_face:":"",":slightly_smiling_face:":"",":slot_machine:":"",":sloth:":"",":sm:":"",":small_airplane:":"",":small_blue_diamond:":"",":small_orange_diamond:":"",":small_red_triangle:":"",":smile:":"",":smile_cat:":"",":smiley:":"",":smiley_cat:":"",":smiling_imp:":"",":smirk:":"",":smirk_cat:":"",":smoking:":"",":sn:":"",":snail:":"",":snake:":"",":sneeze:":"",":sneezing_face:":"",":snow_capped_mountain:":"",":snowboarder:":"",":snowflake:":"",":snowman2:":"",":snowman:":"",":so:":"",":soap:":"",":sob:":"",":soccer:":"",":socks:":"",":softball:":"",":soon:":"",":sos:":"",":sound:":"",":space_invader:":"",":spades:":"",":spaghetti:":"",":sparkle:":"",":sparkler:":"",":sparkles:":"",":sparkling_heart:":"",":speak_no_evil:":"",":speaker:":"",":speaking_head:":"",":speech_balloon:":"",":speech_left:":"",":speedboat:":"",":spider:":"",":spider_web:":"",":spiral_calendar_pad:":"",":spiral_note_pad:":"",":sponge:":"",":spoon:":"",":sports_medal:":"",":spy:":"",":squeeze_bottle:":"",":squid:":"",":sr:":"",":ss:":"",":st:":"",":stadium:":"",":star2:":"",":star:":"",":star_and_crescent:":"",":star_of_david:":"",":star_struck:":"",":stars:":"",":station:":"",":statue_of_liberty:":"",":steam_locomotive:":"",":stethoscope:":"",":stew:":"",":stop_button:":"",":stop_sign:":"",":stopwatch:":"",":straight_ruler:":"",":strawberry:":"",":stuck_out_tongue:":"",":studio_microphone:":"",":stuffed_flatbread:":"",":stuffed_pita:":"",":sun_with_face:":"",":sunflower:":"",":sunglasses:":"",":sunny:":"",":sunrise:":"",":sunrise_over_mountains:":"",":superhero:":"",":supervillain:":"",":surfer:":"",":sushi:":"",":suspension_railway:":"",":sv:":"",":swan:":"",":sweat:":"",":sweat_drops:":"",":sweat_smile:":"",":sweet_potato:":"",":swimmer:":"",":sx:":"",":sy:":"",":symbols:":"",":synagogue:":"",":syringe:":"",":sz:":"",":t_rex:":"",":ta:":"",":table_tennis:":"",":taco:":"",":tada:":"",":takeout_box:":"",":tanabata_tree:":"",":tangerine:":"",":taurus:":"",":taxi:":"",":tc:":"",":td:":"",":tea:":"",":teddy_bear:":"",":telephone:":"",":telephone_receiver:":"",":telescope:":"",":tennis:":"",":tent:":"",":test_tube:":"",":tf:":"",":tg:":"",":th:":"",":thermometer:":"",":thermometer_face:":"",":thinking:":"",":thinking_face:":"",":third_place:":"",":third_place_medal:":"",":thought_balloon:":"",":thread:":"",":three:":"3",":three_button_mouse:":"",":thumbdown:":"",":thumbsdown:":"",":thumbsup:":"",":thumbup:":"",":thunder_cloud_rain:":"",":ticket:":"",":tickets:":"",":tiger2:":"",":tiger:":"",":timer:":"",":timer_clock:":"",":tired_face:":"",":tj:":"",":tk:":"",":tl:":"",":tm:":"",":tn:":"",":to:":"",":toilet:":"",":tokyo_tower:":"",":tomato:":"",":tongue:":"",":toolbox:":"",":tools:":"",":tooth:":"",":top:":"",":tophat:":"",":tr:":"",":track_next:":"",":track_previous:":"",":trackball:":"",":tractor:":"",":traffic_light:":"",":train2:":"",":train:":"",":tram:":"",":triangular_ruler:":"",":trident:":"",":triumph:":"",":trolleybus:":"",":trophy:":"",":tropical_drink:":"",":tropical_fish:":"",":truck:":"",":trumpet:":"",":tt:":"",":tulip:":"",":tumbler_glass:":"",":turkey:":"",":turkmenistan:":"",":turtle:":"",":tuvalu:":"",":tv:":"",":tw:":"",":twisted_rightwards_arrows:":"",":two:":"2",":two_hearts:":"",":tz:":"",":u5272:":"",":u5408:":"",":u55b6:":"",":u6307:":"",":u6708:":"",":u6709:":"",":u6e80:":"",":u7121:":"",":u7533:":"",":u7981:":"",":u7a7a:":"",":ua:":"",":ug:":"",":um:":"",":umbrella2:":"",":umbrella:":"",":umbrella_on_ground:":"",":unamused:":"",":underage:":"",":unicorn:":"",":unicorn_face:":"",":united_nations:":"",":unlock:":"",":up:":"",":upside_down:":"",":upside_down_face:":"",":urn:":"",":us:":"",":uy:":"",":uz:":"",":v:":"",":va:":"",":vampire:":"",":vc:":"",":ve:":"",":vertical_traffic_light:":"",":vg:":"",":vhs:":"",":vi:":"",":vibration_mode:":"",":video_camera:":"",":video_game:":"",":violin:":"",":virgo:":"",":vn:":"",":volcano:":"",":volleyball:":"",":vs:":"",":vu:":"",":vulcan:":"",":waffle:":"",":wales:":"",":walking:":"",":waning_crescent_moon:":"",":waning_gibbous_moon:":"",":warning:":"",":wastebasket:":"",":watch:":"",":water_buffalo:":"",":water_polo:":"",":watermelon:":"",":wave:":"",":waving_black_flag:":"",":waving_white_flag:":"",":wavy_dash:":"",":waxing_crescent_moon:":"",":waxing_gibbous_moon:":"",":wc:":"",":weary:":"",":wedding:":"",":weight_lifter:":"",":wf:":"",":whale2:":"",":whale:":"",":wheel_of_dharma:":"",":wheelchair:":"",":whisky:":"",":white_check_mark:":"",":white_circle:":"",":white_flower:":"",":white_frowning_face:":"",":white_haired:":"",":white_heart:":"",":white_large_square:":"",":white_medium_square:":"",":white_small_square:":"",":white_square_button:":"",":white_sun_cloud:":"",":wilted_flower:":"",":wilted_rose:":"",":wind_blowing_face:":"",":wind_chime:":"",":wine_glass:":"",":wink:":"",":wolf:":"",":woman:":"",":woman_artist:":"",":woman_astronaut:":"",":woman_bald:":"",":woman_biking:":"",":woman_bouncing_ball:":"",":woman_bowing:":"",":woman_cartwheeling:":"",":woman_climbing:":"",":woman_construction_worker:":"",":woman_cook:":"",":woman_curly_haired:":"",":woman_detective:":"",":woman_elf:":"",":woman_facepalming:":"",":woman_factory_worker:":"",":woman_fairy:":"",":woman_farmer:":"",":woman_firefighter:":"",":woman_frowning:":"",":woman_genie:":"",":woman_gesturing_no:":"",":woman_gesturing_ok:":"",":woman_getting_haircut:":"",":woman_golfing:":"",":woman_guard:":"",":woman_health_worker:":"",":woman_judge:":"",":woman_juggling:":"",":woman_kneeling:":"",":woman_lifting_weights:":"",":woman_mage:":"",":woman_mechanic:":"",":woman_mountain_biking:":"",":woman_office_worker:":"",":woman_pilot:":"",":woman_playing_handball:":"",":woman_police_officer:":"",":woman_pouting:":"",":woman_raising_hand:":"",":woman_red_haired:":"",":woman_rowing_boat:":"",":woman_running:":"",":woman_scientist:":"",":woman_shrugging:":"",":woman_singer:":"",":woman_standing:":"",":woman_student:":"",":woman_superhero:":"",":woman_supervillain:":"",":woman_surfing:":"",":woman_swimming:":"",":woman_teacher:":"",":woman_technologist:":"",":woman_tipping_hand:":"",":woman_vampire:":"",":woman_walking:":"",":woman_wearing_turban:":"",":woman_white_haired:":"",":woman_with_headscarf:":"",":woman_zombie:":"",":womans_clothes:":"",":womans_flat_shoe:":"",":womans_hat:":"",":women_wrestling:":"",":womens:":"",":woozy_face:":"",":world_map:":"",":worried:":"",":worship_symbol:":"",":wrench:":"",":wrestlers:":"",":wrestling:":"",":writing_hand:":"",":ws:":"",":x:":"",":xk:":"",":yarn:":"",":yawning_face:":"",":ye:":"",":yellow_circle:":"",":yellow_heart:":"",":yellow_square:":"",":yen:":"",":yin_yang:":"",":yo_yo:":"",":yt:":"",":yum:":"",":za:":"",":zany_face:":"",":zap:":"",":zebra:":"",":zero:":"0",":zipper_mouth:":"",":zipper_mouth_face:":"",":zm:":"",":zombie:":"",":zw:":"",":zzz:":""}'),An=/(\uD83C\uDFF4(?:\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74)\uDB40\uDC7F|\u200D\u2620\uFE0F)|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|\uD83D\uDC69\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83D\uDC69\u200D[\u2695\u2696\u2708])\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC68(?:\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D[\uDC66\uDC67])|\uD83C[\uDFFB-\uDFFF])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])\uFE0F?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDD1-\uDDDD]))/g;var Pn=ve("<b>"),Rn=ve("<em>"),Nn=ve("<u>"),Fn=ve("<s>"),On=ve("<spoiler>"),Mn=ve("<code>`<!>`");const Ln=e=>e,Un=e=>{return Te(t=Pn(),e),t;var t},qn=e=>{return Te(t=Rn(),e),t;var t},jn=e=>{return Te(t=Nn(),e),t;var t},Vn=e=>{return Te(t=Fn(),e),t;var t},Bn=e=>{e.currentTarget.style.backgroundColor="inherit",e.currentTarget.style.color="inherit"},zn=e=>{return(t=On()).$$click=Bn,Te(t,e),t;var t},$n=()=>{},Hn=e=>{return t=Mn(),(n=t.firstChild.nextSibling).nextSibling,t.$$click=()=>navigator.clipboard.writeText(e).then($n).catch($n),Te(t,e,n),t;var t,n},Gn={"*":(e,t,n,r,i)=>Qn({name:"*",wrap:Un,nLine:0},e,t,n,r,i),"/":(e,t,n,r,i)=>Qn({name:"/",wrap:qn,nLine:1},e,t,n,r,i),_:(e,t,n,r,i)=>Qn({name:"_",wrap:jn,nLine:1},e,t,n,r,i),"-":(e,t,n,r,i)=>Qn({name:"-",wrap:Vn,nLine:0},e,t,n,r,i),"|":(e,t,n,r,i)=>Qn({name:"|",wrap:zn,nLine:1},e,t,n,r,i),"`":(e,t,n,r,i)=>Qn({name:"`",wrap:Hn,nLine:1},e,t,n,r,i)};function Wn(e,t,n){switch(e){case'"':case"'":case"[":case"(":case"{":case"":case"":return/\s/.test(t[n-1]);default:return/\s/.test(e)}}function Kn(e,t,n){switch(e){case"?":case"!":case".":case",":case"]":case")":case"}":case'"':case"'":return n+2===t.length||/\s/.test(t[n+2]);default:return n+1===t.length||/\s/.test(e)}}function Qn(e,t,n,r,i,s){let o=n,a="",l=!1;for(n+=1;n<t.length;n++){if(t[n]===e.name&&Kn(t[n+1],t,n)){l=!0;break}if(!e.nLine&&"\n"===t[n])break;a+=t[n]}return l?(r.data+s!==""&&i.push({s:r.data+s,name:"text",wrap:Ln}),r.data="",i.push({s:a,name:e.name,wrap:e.wrap})):n=o-1,n}_e(["click"]);var Yn=ve("<q>"),Jn=ve("<em>"),Xn=ve("<emoji>"),Zn=ve("<mark>");const er=()=>{},tr=/(\s+)/,nr=function(e){let t,n=e.scroll||er,r=!!e.mark&&e.mark.toLowerCase();t=e.trim?(e.text||"").split("\n").map(e=>e.trim()).join("\n").trim():(e.text||"").trim();let i=e=>e,s=e=>e;t.startsWith(">")&&(t=t.replace(/^>\s*/,"").trim(),i=e=>{return Te(t=Yn(),e),t;var t}),t.startsWith("/ ")&&(t=t.replace(/^\/\s+/,"").trim(),s=e=>{return Te(t=Jn(),e),t;var t});let o=function(e){e=" "+(e||"").trim();let t=[],n={data:""};for(let r=0;r<e.length;r++){if(Gn[e[r+1]]&&Wn(e[r],e,r)){let i=Gn[e[r+1]](e,r+1,n,t,e[r]);if(r!==i){r=i;continue}r=i}"\\"===e[r]&&Gn[e[r+1]]&&Wn(e[r-1],e,r-1)||(n.data+=e[r])}return""!==n.data&&t.push({s:n.data,name:"text",wrap:Ln}),t[0].s=t[0].s.trimStart(),""===t[0].s&&t.shift(),t}(t),a=[];for(let i of o){t=i.s.split(tr);let s=[];for(let i=0,o=t.length;i<o;i++)An.lastIndex=0,e.emoji&&Tn[t[i]]?s.push((()=>{var e,n=Xn();return Te(n,(e=we(()=>"#"===t[i][0]),()=>e()?t[i]+" "+Tn[t[i]]:Tn[t[i]])),n})()):0!==t[i].indexOf("http://")&&0!==t[i].indexOf("https://")&&0!==t[i].indexOf("blob:")&&0!==t[i].indexOf("data:")||"http://"==t[i]||"https://"==t[i]||"blob:"==t[i]||"data:"==t[i]?!1!==r&&r===t[i].toLowerCase()?s.push((()=>{var e=Zn();return Te(e,()=>t[i]),e})()):e.emoji&&!/[a-z0-9&*#]/i.test(t[i])&&An.test(t[i])?s.push((()=>{var e=Xn();return Te(e,()=>t[i]),e})()):"string"==typeof s[s.length-1]?s[s.length-1]+=t[i]:s.push(t[i]):s.push(ie(In,{get url(){return t[i]},scroll:n,get guessType(){return e.guessType}}));a.push(i.wrap(s))}return we(()=>i(s(a)))};function rr(e){return et({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path fill-rule="evenodd" d="m7.116 8-4.558 4.558.884.884L8 8.884l4.558 4.558.884-.884L8.884 8l4.558-4.558-.884-.884L8 7.116 3.442 2.558l-.884.884L7.116 8z" clip-rule="evenodd"/>'},e)}function ir(e){return et({a:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"},c:'<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><path d="M9 3A4 4 0 1 0 9 11 4 4 0 1 0 9 3z"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>'},e)}const[sr,or]=mn([]);document.body.addEventListener("clientDisconnected",e=>{const t=e.detail.clientId;or(sr.filter(e=>e.id!==t))}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("a-scene");if(!e)return;const t=e=>{const{el:t,data:n,oldData:r}=e.detail;if(!t||!t.components||!t.components["player-info"])return void console.warn("[Presence] Invalid element or missing player-info component",t);const i=t.components?.networked?.data?.owner,s=i||"local";if(t.components["player-info"].presenceAdded){if(r){const e=sr.findIndex(e=>e.id===s);if(-1!==e){const t=[...sr];let i=!1;r.muted!==n.muted&&(t[e]={...t[e],muted:n.muted},i=!0),r.name!==n.name&&(t[e]={...t[e],name:n.name},i=!0),r.squadId!==n.squadId&&(t[e]={...t[e],squadId:n.squadId||null},i=!0),i&&or(t)}}}else-1===sr.findIndex(e=>e.id===s)&&or([...sr,{id:s,muted:n.muted,name:n.name,squadId:n.squadId||null}]),t.components["player-info"].presenceAdded=!0};e.addEventListener("player-info-updated",t);const n=document.querySelector("[player-info]");document.body.addEventListener("connected",async()=>{or([]),n?(n.components&&n.components["player-info"]&&(n.components["player-info"].presenceAdded=!1),await NAF.utils.getNetworkedEntity(n),n.components&&n.components["player-info"]&&t({detail:{el:n,data:n.components["player-info"].data},oldData:{}})):console.warn("[Presence] No player-info element found")})});var ar=ve('<button type=button class="btn-secondary btn-rounded relative"title=Users><span class=counter>'),lr=ve('<div class="bg-panel absolute bottom-14 left-2 right-2 z-20 mb-3 mt-3 flex max-w-full flex-col space-y-4 rounded-lg p-4 shadow-lg ring-1 ring-black ring-opacity-5 sm:left-auto sm:w-screen sm:max-w-sm"><div class="flex justify-end space-x-2 pb-2"><button class="btn-secondary btn-rounded"type=button title=Close>'),cr=ve('<div class="flex items-center space-x-1 text-sm font-medium"><span>');const[ur,hr]=D(!1),dr=()=>{const e=T(()=>sr.length);return[(t=ar(),n=t.firstChild,t.$$click=()=>{hr(e=>!e),ur()&&Pr(!1)},Te(t,ie(ir,{size:24}),n),Te(n,e),S(()=>t.classList.toggle("active",!!ur())),t),ie(Ue,{get children(){return ie(he,{get when(){return ur()},get children(){var e=lr(),t=e.firstChild.firstChild;return t.$$click=()=>hr(!1),Te(t,ie(rr,{size:16})),Te(e,ie(ue,{each:sr,children:e=>{return n=(t=cr()).firstChild,Te(t,ie(he,{get when(){return we(()=>!e.muted)()&&Mt()},get children(){return ie(ct,{size:20})}}),n),Te(t,ie(he,{get when(){return we(()=>!!e.muted)()&&Mt()},get children(){return ie(lt,{size:20})}}),n),Te(n,()=>e.name),t;var t,n}}),null),e}})}})];var t,n};_e(["click"]);var pr=ve('<span class="animation-ping counter-red">'),mr=ve("<span class=counter-red><span>"),gr=ve('<button type=button class="btn-secondary btn-rounded relative"title=Chat>'),fr=ve('<span class="text-sm font-normal">'),yr=ve('<div class="pointer-events-auto mb-2 mr-2 flex flex-col"><div class="whitespace-pre-wrap rounded-xl p-2 text-base font-normal text-gray-900">'),wr=ve('<div class="rounded-lg bg-amber-100 p-3 text-sm text-amber-700">Chat hanya tersedia setelah kamu bergabung ke salah satu squad.'),br=ve('<div class="bg-panel absolute bottom-16 left-2 right-2 top-16 z-10 flex max-w-full flex-col justify-between rounded-lg p-4 shadow-lg ring-1 ring-black ring-opacity-5 sm:left-auto sm:w-screen sm:max-w-sm"><div class="flex justify-end space-x-2 pb-2"><button class="btn-secondary btn-rounded"type=button title=Close></button></div><div class="flex grow flex-col overflow-y-auto"><div></div></div><form class="relative flex"><textarea class="form-textarea flex grow resize-none rounded-lg pr-10"></textarea><div class="absolute right-0 flex h-full items-center justify-center"><button type=submit class="btn-in-input pr-4"title="Send message">'),vr=ve('<div class="relative w-full"><div class="absolute w-full text-center text-sm font-bold text-red-600">unread from here');const[_r,xr]=D(!0),[kr,Cr]=D(""),[Dr,Er]=mn({entries:[],firstUnreadKey:null}),[Sr,Ir]=D(null);"undefined"!=typeof window&&(Ir((()=>{const e=window.roomSession;return e?.squadId??null})()),window.addEventListener("room:squad-changed",e=>{const t=e.detail,n=t?.squadId??null;n!==Sr()&&(e=>{Ir(e),Er("entries",[]),Er("firstUnreadKey",null)})(n)}));const Tr=e=>{const t=Sr();t&&e.squadId===t&&(e.key=Date.now().toString(),e.viewed=_r()&&Ar(),Dr.firstUnreadKey||e.viewed||Er("firstUnreadKey",e.key),Er("entries",t=>[...t,e]))};NAF.connection.subscribeToDataChannel("chat",(e,t,n,r)=>{Tr(n)});const[Ar,Pr]=D(!1),Rr=()=>{R(()=>{const e=()=>{xr("visible"===document.visibilityState)};e(),document.addEventListener("visibilitychange",e),N(()=>{document.removeEventListener("visibilitychange",e)})});const e=T(()=>Dr.entries.reduce((e,t)=>e+(t.viewed?0:1),0));return[(t=gr(),t.$$click=()=>{Pr(e=>!e),Ar()&&hr(!1)},Te(t,ie(ot,{size:24}),null),Te(t,ie(he,{get when(){return 0!==e()},get children(){return[pr(),(t=mr(),Te(t.firstChild,e),t)];var t}}),null),S(()=>t.classList.toggle("active",!!Ar())),t),ie(Ue,{get children(){return ie(he,{get when(){return Ar()},get children(){return ie(Fr,{})}})}})];var t},Nr=e=>{return t=yr(),n=t.firstChild,Te(t,ie(he,{get when(){return e.entry.fromClientId!==NAF.clientId},get children(){var t=fr();return Te(t,()=>e.entry.name),t}}),n),Te(n,ie(nr,{get text(){return e.entry.text},guessType:!1,emoji:!0,trim:!1,get scroll(){return e.scroll}})),S(r=>{var i=!(e.entry.fromClientId!==NAF.clientId),s=!(e.entry.fromClientId===NAF.clientId),o=!(e.entry.fromClientId!==NAF.clientId),a=!(e.entry.fromClientId===NAF.clientId);return i!==r.e&&t.classList.toggle("items-end",r.e=i),s!==r.t&&t.classList.toggle("items-start",r.t=s),o!==r.a&&n.classList.toggle("bg-sky-200",r.a=o),a!==r.o&&n.classList.toggle("bg-gray-200",r.o=a),r},{e:void 0,t:void 0,a:void 0,o:void 0}),t;var t,n},Fr=e=>{const t=e=>{e.preventDefault(),i.value.length>0&&Sr()&&(((e,t)=>{const n=Sr();if(!n)return void console.warn("[Chat] Unable to send message without joining a squad.");const r={type:"chat",text:e,name:t,fromClientId:NAF.clientId,squadId:n};Tr(r);const i=(e=>e?sr.filter(t=>t.squadId===e).map(e=>"local"===e.id?NAF.clientId:e.id).filter(e=>Boolean(e)):[])(n).filter(e=>e!==NAF.clientId);"function"==typeof NAF.connection.sendDataGuaranteed?i.forEach(e=>{NAF.connection.sendDataGuaranteed?.(e,"chat",r)}):console.warn("[Chat] Targeted messaging is not supported by this adapter.")})(i.value,Ht()),Cr(""))},[n,r]=D(1);let i,s;I(()=>{let e=kr().split("\n").length;1===e&&kr().length>35&&(e=2),r(0===e?1:e>6?6:e),i&&(i.scrollTop=i.scrollHeight)}),I(()=>{0===kr().length&&Dr.entries.length>0&&o()}),I(()=>{Ar()&&(setTimeout(()=>{s?.scrollIntoView()},100),setTimeout(()=>{Er("entries",e=>!e.viewed,"viewed",e=>!e),Er("firstUnreadKey",null)},3e3))});const o=()=>{s?.scrollIntoView({behavior:"smooth"})};return ie(he,{get when(){return Ar()},get children(){var e=br(),r=e.firstChild,a=r.firstChild,l=r.nextSibling,c=l.firstChild,u=l.nextSibling,h=u.firstChild,d=h.nextSibling.firstChild;return a.$$click=()=>Pr(!1),Te(a,ie(rr,{size:16})),Te(l,ie(he,{get when(){return!Sr()},get children(){return wr()}}),c),Te(l,ie(ue,{get each(){return Dr.entries},children:e=>[ie(he,{get when(){return Dr.firstUnreadKey===e.key},get children(){return vr()}}),ie(Nr,{entry:e,scroll:o})]}),c),"function"==typeof s?Ie(s,c):s=c,u.addEventListener("submit",t),h.$$keydown=e=>{"Enter"!==e.key||e.shiftKey||t(e)},h.$$input=e=>{Cr(i.value)},"function"==typeof i?Ie(i,h):i=h,Te(d,ie(ut,{size:24})),S(e=>{var t=n(),r=Sr()?"Pesan untuk squad kamu":"Gabung ke squad untuk mulai chat",i=!Sr(),s=0===kr().length;return t!==e.e&&xe(h,"rows",e.e=t),r!==e.t&&xe(h,"placeholder",e.t=r),i!==e.a&&(h.disabled=e.a=i),s!==e.o&&(d.disabled=e.o=s),e},{e:void 0,t:void 0,a:void 0,o:void 0}),S(()=>h.value=kr()),e}})};_e(["click","input","keydown"]);var Or=ve('<div><div class="relative flex h-full"><span class="absolute left-0 flex justify-center"><span class="flex rounded-lg bg-black/50 p-2 pb-1 pt-1 text-slate-50"></span></span><div>'),Mr=ve('<div class="pointer-events-none absolute bottom-0 left-0 right-0 top-0 z-10 flex select-none justify-center p-2 [&amp;>*]:pointer-events-auto">');const Lr=e=>{R(()=>{r.appendChild(e.video),e.video.setAttribute("class","rounded-lg cursor-pointer")}),N(()=>{e.video.remove()});const[t,n]=D(!1);let r;return i=Or(),s=i.firstChild.firstChild,o=s.firstChild,a=s.nextSibling,i.$$click=()=>{n(e=>!e)},Te(o,()=>e.name),"function"==typeof r?Ie(r,a):r=a,S(e=>{var n={"absolute top-14 mt-3 h-48 w-48 md:static md:top-0 md:mt-0":!t(),"absolute bottom-0 left-2 right-2 top-14 mb-2 mt-2 flex justify-center":t()},r={"top-0 m-2":!t(),"top-0 m-2 md:-top-10 md:left-0 md:right-0 md:m-0":t()},o={"animation-pop flex grow [&>*]:h-full":t()};return e.e=De(i,n,e.e),e.t=De(s,r,e.t),e.a=De(a,o,e.a),e},{e:void 0,t:void 0,a:void 0}),i;var i,s,o,a},Ur=()=>{const[e,t]=mn([]);return I(()=>{const n=document.querySelector("a-scene");if(!n)return;const r=({detail:{video:n,el:r,clientId:i}})=>{t([...e,{video:n,el:r,clientId:i}])},i=({detail:{video:n}})=>{t(e.filter(e=>e.video!==n))};n.addEventListener("video-added",r),n.addEventListener("video-removed",i),N(()=>{n.removeEventListener("video-added",r),n.removeEventListener("video-removed",i)})}),ie(ue,{each:e,children:e=>ie(Lr,{get video(){return e.video},get name(){return(e=>{const t=sr.find(t=>t.id===e);return t?t.name:"Unknown"})(e.clientId)}})})},qr=()=>{return Te(e=Mr(),ie(Ur,{})),e;var e};function jr(e){return et({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-screen-share-off",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 12v3a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10a1 1 0 0 1 1 -1h9"/><path d="M7 20l10 0"/><path d="M9 16l0 4"/><path d="M15 16l0 4"/><path d="M17 8l4 -4m-4 0l4 4"/>'},e)}function Vr(e){return et({a:{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-screen-share",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},c:'<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 12v3a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1v-10a1 1 0 0 1 1 -1h9"/><path d="M7 20l10 0"/><path d="M9 16l0 4"/><path d="M15 16l0 4"/><path d="M17 4h4v4"/><path d="M16 9l5 -5"/>'},e)}_e(["click"]);var Br=ve('<button class="btn-rounded btn-secondary">');const zr={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},$r=(e,t)=>{console.error(e,t)};let Hr=null,Gr=!1;const Wr=async(e,t,n=!1)=>{const r=AFRAME.scenes[0],i=r.systems.audio,s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o=n?"Failed to share the screen":"Failed to share the camera";if(n&&(void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.getDisplayMedia))return void window.alert("Sorry, screen share doesn't work on mobile.");if(Hr&&await Yr(),Gr)return;let a;Gr=!0;try{a=n?await navigator.mediaDevices.getDisplayMedia(t):await navigator.mediaDevices.getUserMedia(t)}catch(e){if("NotAllowedError"===e.name){let t="Please verify sharing the screen or camera is allowed in the permissions.";s||(t+=" Click on the lock icon in the url bar to see the allowed permissions."),AFRAME.utils.device.isMobile()?$r(n?"Sorry, screen share doesn't work on mobile.":t,o):"Permission denied by system"===e.message?$r("The browser returned the following error: Permission denied by system. Are you using Chrome on macOS? Sharing a Chrome tab should work. If you want to share your screen or a window, please go to System Preferences > Security & Privacy > Privacy > Camera & Microphone, and make sure Chrome is listed and has a checkbox.",o):$r(t,o)}else console.error(e),$r("The browser returned the following error: "+e.name+": "+e.message,"Failed to share the screen or camera");return Gr=!1,void r.emit("share_video_failed")}const l=i.outboundStream,c=a?a.getVideoTracks():[];if(c.length>0){c.forEach(e=>{l.addTrack(e),e.onended=()=>{r.emit("action_end_video_sharing")}}),a&&a.getAudioTracks().length>0&&i.addStreamToOutboundAudio("screenshare",a),await(NAF.connection.adapter?.setLocalMediaStream(l));const t=r.systems["media-frame"];Hr=t.getMediaFrameById(e),Hr&&Hr.setAttribute("video-texture-target",{src:`naf://clients/${NAF.clientId}/video`}),r.emit("share_video_enabled",{source:n?"screen":"camera",mediaFrameId:e})}else r.emit("share_video_failed",{message:"No video track"});Gr=!1},Kr=e=>{Wr(e,{video:{mediaSource:"camera",width:{max:1280,ideal:640},height:{ideal:360},frameRate:30}})},Qr=e=>{Wr(e,{video:{width:{max:1600},height:{max:900}},audio:zr},!0)},Yr=async()=>{if(Gr)return;Gr=!0;const e=AFRAME.scenes[0],t=e.systems.audio,n=t.outboundStream;for(const e of n.getVideoTracks())e.onended=null,e.stop(),n.removeTrack(e);t.removeStreamFromOutboundAudio("screenshare"),await(NAF.connection.adapter?.setLocalMediaStream(n)),Hr=null,e.emit("share_video_disabled"),Gr=!1},[Jr,Xr]=D(!1),[Zr,ei]=D(!1),ti=()=>{const e=T(()=>Jr()?"Stop sharing screen":"Share screen");return(t=Br()).$$click=()=>{if(Jr())Yr();else{const e=AFRAME.scenes[0].systems["media-frame"].getClosestMediaFrame("video");e&&Qr(e.id)}document.activeElement.blur(),document.body.focus()},Te(t,ie(he,{get when(){return Jr()},get children(){return ie(Vr,{size:24})}}),null),Te(t,ie(he,{get when(){return!Jr()},get children(){return ie(jr,{size:24})}}),null),S(n=>{var r=!!Jr(),i=e();return r!==n.e&&t.classList.toggle("active",n.e=r),i!==n.t&&xe(t,"title",n.t=i),n},{e:void 0,t:void 0}),t;var t},ni=()=>{const e=T(()=>Zr()?"Stop sharing camera":"Share camera");return(t=Br()).$$click=()=>{if(Zr())Yr();else{const e=AFRAME.scenes[0].systems["media-frame"].getClosestMediaFrame();e&&Kr(e.id)}document.activeElement.blur(),document.body.focus()},Te(t,ie(he,{get when(){return Zr()},get children(){return ie(st,{size:24})}}),null),Te(t,ie(he,{get when(){return!Zr()},get children(){return ie(it,{size:24})}}),null),S(n=>{var r=!!Zr(),i=e();return r!==n.e&&t.classList.toggle("active",n.e=r),i!==n.t&&xe(t,"title",n.t=i),n},{e:void 0,t:void 0}),t;var t};_e(["click"]);var ri=ve('<svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round xmlns=http://www.w3.org/2000/svg><path d="M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z"></path><path d="M8 10h8"></path><path d="M8 18h8"></path><path d="M8 22v-6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v6"></path><path d="M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2">'),ii=ve('<div class="fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4"><div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class=relative><button type=button class="absolute top-4 right-4 p-2 bg-white/90 hover:bg-white rounded-full shadow-lg transition-colors z-10"></button><div class="bg-transparent p-8 flex items-center justify-center min-h-[200px]"></div></div><div class=p-6><span class="inline-block mb-3 px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-full font-medium"></span><h2 class="text-2xl font-bold text-gray-800 mb-4"></h2><div class="prose max-w-none"><p class="text-gray-600 leading-relaxed whitespace-pre-line">'),si=ve('<img class="max-w-full max-h-[300px] object-contain rounded-lg">'),oi=ve("<span class=text-8xl>"),ai=ve('<div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200 hover:border-blue-400 hover:shadow-md transition-all cursor-pointer"><div class=flex-shrink-0></div><div class="flex-grow min-w-0"><h3 class="font-semibold text-gray-800 truncate"></h3><p class="text-sm text-gray-500 truncate"></p><span class="inline-block mt-1 px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded-full">'),li=ve('<img class="w-16 h-16 object-contain rounded">'),ci=ve("<span class=text-4xl>"),ui=ve("<div class=space-y-3>"),hi=ve('<div class="fixed inset-y-0 right-0 w-full sm:w-96 bg-white shadow-2xl z-50 flex flex-col"><div class="flex flex-wrap items-center justify-between gap-3 p-4 border-b border-blue-600/30 bg-gradient-to-r from-blue-500 to-blue-600"><div class="flex items-center gap-3 min-w-0"><div class="flex h-11 w-11 items-center justify-center rounded-2xl bg-white/10 text-white shadow-inner"></div><div class=min-w-0><p class="text-xs uppercase tracking-[0.35em] text-white/60">Inventori</p><h2 class="text-2xl font-bold text-white leading-tight truncate">Backpack</h2></div></div><div class="flex items-center gap-2"><span class="px-3 py-1 text-xs font-semibold text-white bg-white/25 rounded-full"> item</span><button type=button class="p-2 text-white/90 hover:bg-white/20 rounded-lg transition-colors"></button></div></div><div class="sticky top-[72px] z-20 bg-gradient-to-r from-gray-50 via-white to-gray-50 border-b border-gray-100 shadow-sm"><div class="flex gap-2 p-3 overflow-x-auto items-center"></div></div><div class="flex-grow overflow-y-auto px-4 pb-4 pt-6"></div><div class="p-4 border-t border-gray-200 bg-gray-50"><div class="flex justify-around text-center"><div><p class="text-2xl font-bold text-blue-600"></p><p class="text-xs text-gray-500">Total Items</p></div><div><p class="text-2xl font-bold text-green-600"></p><p class="text-xs text-gray-500">Pakaian Adat'),di=ve("<button type=button><span class=relative>"),pi=ve('<span class="absolute inset-0 bg-blue-500"aria-hidden=true>'),mi=ve('<div class="flex flex-col items-center justify-center h-full text-center p-8"><p class="text-gray-500 font-medium">Backpack kosong</p><p class="text-sm text-gray-400 mt-2">Kumpulkan item saat menjelajahi Nusantara Quest!'),gi=ve('<span class="absolute -top-1 -right-1 min-w-[20px] h-5 flex items-center justify-center px-1.5 text-xs font-bold bg-blue-500 text-white rounded-full border-2 border-white">'),fi=ve('<button type=button class="btn-secondary btn-rounded relative"title="Backpack - Inventori">');const yi=e=>{const t=e.size||24;return xe(n=ri(),"width",t),xe(n,"height",t),S(()=>xe(n,"class",e.class)),n;var n},[wi,bi]=D(!1),[vi,_i]=D([]),[xi,ki]=D(!1),[Ci,Di]=D(0),Ei={"baju-koteka-papua":{id:"baju-koteka-papua",name:"Pakaian Koteka dari Papua",description:"Pakaian Adat Koteka dan Rok Rumbai adalah busana tradisional yang identik dengan masyarakat adat di wilayah Pegunungan Tengah Papua (seperti Suku Dani, Lani, dan Yali), terkenal karena kesederhanaan bahan alamnya dan sarat akan makna status sosial.",icon:"/assets/baju_adat/bapapua.png",category:"costume"},"baju-ulee-balang-aceh":{id:"baju-ulee-balang-aceh",name:"Pakaian Ulee Balang dari Aceh",description:"Pakaian Adat Ulee Balang adalah busana tradisional khas Aceh yang melambangkan kebesaran, kemuliaan, dan status sosial tinggi, yang pada masa kesultanan hanya dikenakan oleh golongan bangsawan (Ulee Balang). Kini, pakaian ini populer sebagai busana pernikahan adat.",icon:"/assets/baju_adat/baaceh.png",category:"costume"},"baju-pepadun-lampung":{id:"baju-pepadun-lampung",name:"Pakaian Pepadun dari Sumatra",description:"Pakaian Adat Pepadun adalah busana kebesaran dari masyarakat Lampung yang menganut sistem adat Pepadun (dataran tinggi/pedalaman). Pakaian ini secara umum berwarna putih dan emas, melambangkan kesucian dan kemuliaan, serta sering dikenakan sebagai busana pengantin.",icon:"/assets/baju_adat/basumatra.png",category:"costume"},"baju-dayak-kalimantan":{id:"baju-dayak-kalimantan",name:"Pakaian Sapei Sapaq dari Kalimantan",description:"Pakaian Sapei Sapaq dan Ta'a adalah pasangan busana adat tradisional dari Suku Dayak, khususnya sub-Suku Dayak Kenyah yang mendiami wilayah Kalimantan Timur. Pakaian ini merupakan busana kebesaran yang dikenakan untuk upacara adat penting atau tarian penyambutan.",icon:"/assets/baju_adat/badayak.png",category:"costume"},"baju-bundo-kanduang-sumbar":{id:"baju-bundo-kanduang-sumbar",name:"Baju Bundo Kanduang dari Sumatra Barat",description:"Baju adat Bundo Kanduang adalah pakaian kebesaran perempuan Minangkabau yang melambangkan kewibawaan pemimpin adat dengan suntiang tinggi dan kain songket penuh filosofi.",icon:"/assets/baju_adat/basumbar.png",category:"costume"},"baju-ulos-batak-sumut":{id:"baju-ulos-batak-sumut",name:"Pakaian Ulos Batak Sumatra Utara",description:"Busana adat Batak dipadukan dengan kain Ulos sebagai simbol restu dan kehangatan yang wajib ada di setiap upacara adat penting masyarakat Sumatra Utara.",icon:"/assets/baju_adat/babatak.png",category:"costume"},"baju-nggoli-sulteng":{id:"baju-nggoli-sulteng",name:"Pakaian Ngata Tolitoli - Sulawesi Tengah",description:"Busana adat Ngata Tolitoli dikenakan oleh bangsawan Sulawesi Tengah dengan perpaduan warna cerah dan aksen sulam emas yang menonjolkan status sosial.",icon:"/assets/baju_adat/batolitoli.png",category:"costume"},"baju-payas-agung-bali":{id:"baju-payas-agung-bali",name:"Payas Agung Bali",description:"Payas Agung adalah busana adat kebesaran Bali yang dipakai dalam upacara sakral dan pernikahan dengan dominasi warna emas dan hiasan ukiran rumit.",icon:"/assets/baju_adat/babali.png",category:"costume"},"baju-beskap-jawa":{id:"baju-beskap-jawa",name:"Pakaian Beskap dari Jawa",description:"Beskap adalah baju adat pria Jawa (terutama dari wilayah Solo dan Yogyakarta) yang merupakan atasan resmi dan elegan, sering disamakan dengan jas tutup. Pakaian ini sarat akan filosofi dan umumnya dikenakan dalam acara-acara penting, seperti pernikahan, upacara adat, dan pertemuan resmi.",icon:"/assets/baju_adat/bajawa.png",category:"costume"},"baju-bodo-sulsel":{id:"baju-bodo-sulsel",name:"Pakaian Bodo dari Sulawesi Selatan",description:"Pakaian Bodo adalah pakaian adat wanita suku Bugis-Makassar (Sulawesi Selatan) yang berbentuk blus longgar, segi empat, berlengan sangat pendek (bodo). Terbuat dari kain tipis transparan, Baju Bodo dipadukan dengan sarung sutra dan memiliki keunikan pada warna yang melambangkan status dan usia pemakainya (misalnya, hijau untuk bangsawan). Busana ini mewah, kaya perhiasan emas, dan digunakan dalam upacara adat.",icon:"/assets/baju_adat/basulsel.png",category:"costume"}},Si=async()=>{try{const e=localStorage.getItem("userId");if(!e)return void console.log(" Backpack: No user ID, skipping load from Firestore");if(window.getUserDataFromFirestore){console.log(" Backpack: Loading collected items from Firestore...");const t=await window.getUserDataFromFirestore(e);if(t&&t.collectedItems&&Array.isArray(t.collectedItems)){console.log(" Backpack: Found",t.collectedItems.length,"collected items");const e=t.collectedItems.map(e=>{const t=Ei[e];return t?{...t,quantity:1}:(console.warn(" Backpack: Unknown item ID:",e),null)}).filter(e=>null!==e);_i(e),ki(!0),Di(Date.now()),console.log(" Backpack: Loaded",e.length,"items from Firestore")}else console.log(" Backpack: No collected items found in Firestore"),ki(!0)}else console.log(" Backpack: getUserDataFromFirestore not available yet, will retry"),setTimeout(()=>Si(),2e3)}catch(e){console.error(" Backpack: Error loading collected items from Firestore:",e),ki(!0)}},Ii=e=>{const t=vi().find(t=>t.id===e.id);_i(t?t=>t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):t=>[...t,e]),console.log("Item added to backpack:",e.name),setTimeout(()=>{Si()},2e3)},Ti=()=>{Si()},Ai=e=>"costume"===e?"Pakaian Adat":"Lainnya",[Pi,Ri]=D(null),Ni=e=>ie(Ue,{get children(){var t,n=ii(),r=n.firstChild,i=r.firstChild,s=i.firstChild,o=s.nextSibling,a=i.nextSibling.firstChild,l=a.nextSibling,c=l.nextSibling.firstChild;return n.$$click=()=>Ri(null),r.$$click=e=>e.stopPropagation(),s.$$click=()=>Ri(null),Te(s,ie(nt,{size:24,class:"text-gray-700"})),Te(o,(t=we(()=>!(!e.item.icon.startsWith("http")&&!e.item.icon.startsWith("/"))),()=>{return t()?(r=si(),S(t=>{var n=e.item.icon,i=e.item.name;return n!==t.e&&xe(r,"src",t.e=n),i!==t.t&&xe(r,"alt",t.t=i),t},{e:void 0,t:void 0}),r):(Te(n=oi(),()=>e.item.icon),n);var n,r})),Te(a,()=>Ai(e.item.category)),Te(l,()=>e.item.name),Te(c,()=>e.item.description),n}}),Fi=e=>{return o=(s=(i=(r=(n=ai()).firstChild).nextSibling.firstChild).nextSibling).nextSibling,n.$$click=()=>Ri(e.item),Te(r,(t=we(()=>!(!e.item.icon.startsWith("http")&&!e.item.icon.startsWith("/"))),()=>{return t()?(r=li(),S(t=>{var n=e.item.icon,i=e.item.name;return n!==t.e&&xe(r,"src",t.e=n),i!==t.t&&xe(r,"alt",t.t=i),t},{e:void 0,t:void 0}),r):(Te(n=ci(),()=>e.item.icon),n);var n,r})),Te(i,()=>e.item.name),Te(s,()=>e.item.description),Te(o,()=>Ai(e.item.category)),n;var t,n,r,i,s,o},Oi=()=>{const[e,t]=D("all"),n=()=>{const t=e();return"all"===t?vi():vi().filter(e=>e.category===t)},r={all:"Semua",costume:"Pakaian",other:"Lainnya"};return a=(o=(s=(i=hi()).firstChild).firstChild).firstChild,c=(l=o.nextSibling.firstChild).firstChild,u=l.nextSibling,d=(h=s.nextSibling).firstChild,g=(m=(p=h.nextSibling).nextSibling.firstChild.firstChild).firstChild,f=m.nextSibling.firstChild,Te(a,ie(yi,{size:22,class:"text-white"})),Te(l,()=>vi().length,c),Te(l,()=>1!==vi().length?"s":"",null),u.$$click=()=>bi(!1),Te(u,ie(nt,{size:22})),Te(d,ie(ue,{each:["all","costume","other"],children:n=>{return o=(s=di()).firstChild,s.$$click=()=>t(n),Te(s,(i=we(()=>e()===n),()=>i()&&pi()),o),Te(o,()=>r[n]),S(()=>ke(s,"relative h-10 px-4 text-sm font-semibold rounded-full whitespace-nowrap transition-colors border overflow-hidden "+(e()===n?"text-white border-blue-500 shadow-sm":"text-gray-600 border-transparent hover:bg-gray-100"))),s;var i,s,o}})),Te(p,ie(he,{get when(){return n().length>0},get fallback(){return t=(e=mi()).firstChild,Te(e,ie(yi,{size:64,class:"text-gray-300 mb-4"}),t),e;var e,t},get children(){var e=ui();return Te(e,ie(ue,{get each(){return n()},children:e=>ie(Fi,{item:e})})),e}})),Te(g,()=>vi().reduce((e,t)=>e+t.quantity,0)),Te(f,()=>vi().filter(e=>"costume"===e.category).length),i;var i,s,o,a,l,c,u,h,d,p,m,g,f},Mi=()=>{const e=()=>vi().reduce((e,t)=>e+t.quantity,0);return R(()=>{window.addItemToBackpack=Ii,window.refreshBackpackFromFirestore=Ti,console.log(" Backpack: addItemToBackpack exposed to window"),Si()}),I(()=>{if(wi()){const e=Date.now(),t=e-Ci();(!xi()||t>5e3)&&(Si(),Di(e))}}),[(t=fi(),t.$$click=()=>{bi(e=>!e)},Te(t,ie(yi,{size:24}),null),Te(t,ie(he,{get when(){return e()>0},get children(){var t=gi();return Te(t,e),t}}),null),S(()=>t.classList.toggle("active",!!wi())),t),ie(Ue,{get children(){return ie(he,{get when(){return wi()},get children(){return ie(Oi,{})}})}}),ie(he,{get when(){return Pi()},children:e=>ie(Ni,{get item(){return e()}})})];var t};_e(["click"]);var Li=ve('<div class="fixed inset-0 z-50 bg-black/50 backdrop-blur-sm animate-fadeIn"style=overflow-y:auto;-webkit-overflow-scrolling:touch;touch-action:pan-y><div class="min-h-full flex items-start justify-center p-0 sm:p-4"><div class="bg-white rounded-t-2xl sm:rounded-2xl shadow-2xl max-w-md w-full overflow-hidden animate-scaleIn mt-auto sm:my-auto sm:mt-4 mb-0 sm:mb-4 flex flex-col"><div class="bg-gradient-to-r from-green-500 to-green-600 p-4 sm:p-6 text-center relative flex-shrink-0 sticky top-0 z-10"><button type=button class="absolute top-3 right-3 sm:top-4 sm:right-4 p-1 text-white/80 hover:text-white hover:bg-white/20 rounded-lg transition-colors z-10"></button><div class="flex justify-center mb-2 sm:mb-3"></div><h2 class="text-xl sm:text-2xl font-bold text-white mb-1">Item Ditemukan! </h2><p class="text-green-100 text-xs sm:text-sm">Item berhasil ditambahkan ke backpack Anda</p></div><div class="p-4 sm:p-6"><div class="mb-4 rounded-lg overflow-hidden border-2 border-gray-200 bg-gray-50"><img class="w-full h-48 sm:h-64 object-contain p-4"></div><div class="text-center mb-4"><h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-2"></h3><span class="inline-block px-3 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full"></span></div><div class="bg-gray-50 rounded-lg p-4 mb-4"><p class="text-sm text-gray-700 leading-relaxed text-justify"></p></div><button type=button class="w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all transform hover:scale-105 active:scale-95">Tutup');const[Ui,qi]=D(!1),[ji,Vi]=D(null);"undefined"!=typeof window&&(window.showItemCollection=e=>{Vi(e),qi(!0),console.log("Showing collection popup for:",e.name),setTimeout(()=>{qi(!1)},8e3)});const Bi=()=>{const e=ji();return e?ie(Ue,{get children(){return ie(he,{get when(){return Ui()},get children(){var t,n=Li(),r=n.firstChild.firstChild.firstChild,i=r.firstChild,s=i.nextSibling,o=r.nextSibling.firstChild,a=o.firstChild,l=o.nextSibling,c=l.firstChild,u=c.nextSibling,h=l.nextSibling,d=h.firstChild,p=h.nextSibling;return i.$$click=()=>qi(!1),Te(i,ie(nt,{size:24})),Te(s,ie(tt,{size:48,class:"text-white animate-bounce sm:w-16 sm:h-16"})),Te(c,()=>e.name),Te(u,(t=we(()=>"costume"===e.category),()=>t()?" Pakaian Adat":we(()=>"artifact"===e.category)()?"Artefak":"souvenir"===e.category?"Suvenir":"Lainnya")),Te(d,()=>e.description),p.$$click=()=>qi(!1),S(t=>{var n=e.imageUrl,r=e.name;return n!==t.e&&xe(a,"src",t.e=n),r!==t.t&&xe(a,"alt",t.t=r),t},{e:void 0,t:void 0}),n}})}}):null};_e(["click"]);var zi=ve('<div class="p-4 sm:p-6"><div class="mb-4 rounded-lg overflow-hidden"><img style=object-fit:contain></div><div class="text-center mb-4"><h3 class="font-bold text-xl mb-2"></h3><span class="inline-block px-3 py-1 text-xs font-medium rounded-full"></span></div><div class="rounded-lg p-4 mb-4"><p class="text-sm leading-relaxed"style=text-align:justify>'),$i=ve('<div class=notification-overlay><div class=notification-modal><div class="p-3 sm:p-4 text-center relative flex-shrink-0 sticky top-0 z-10"><h2 class="font-bold text-lg sm:text-xl mb-1"></h2><p class="text-xs sm:text-sm"></p></div><div class="flex-1 overflow-y-auto min-h-0"style=-webkit-overflow-scrolling:touch;touch-action:pan-y></div><div class="flex-shrink-0 p-4 sm:p-6 border-t border-gray-200"><button type=button class="w-full py-3 font-semibold rounded-lg transition-all">OK, Mengerti!');const[Hi,Gi]=D(!1),[Wi,Ki]=D(null),[Qi,Yi]=D([]),Ji=e=>{if(console.log(" Achievement Modal: Received item:",e),console.log(" Achievement Modal: Item title:",e?.title),e&&e.title){if(Hi())return console.log(" Achievement Modal: Adding to queue"),void Yi(t=>[...t,e]);console.log(" Achievement Modal: Showing achievement modal"),Ki(e),Gi(!0)}else console.error(" Achievement Modal: Invalid item data received!")},Xi=()=>{console.log(" Achievement Modal: Closing"),Gi(!1),Ki(null);const e=Qi();if(e.length>0){const t=e[0];Yi(e=>e.slice(1)),setTimeout(()=>{Ji(t)},500)}},Zi=()=>{const e=T(()=>Wi()),t=T(()=>"quiz"===e()?.category),n=T(()=>t()?e()?.title||"Penjaga Rumah Adat":" Selamat! "),r=T(()=>t()?e()?.description||"Anda sudah menjawab quiz penjaga rumah adat.":"Anda mendapatkan item baru!"),i=T(()=>t()?"linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)":"linear-gradient(135deg, #10b981 0%, #059669 100%)");return ie(Ue,{get children(){return ie(he,{get when(){return we(()=>!!Hi())()&&e()},get children(){var s=$i(),o=s.firstChild.firstChild,a=o.firstChild,l=a.nextSibling,c=o.nextSibling,u=c.nextSibling,h=u.firstChild;return Te(o,ie(tt,{size:40,class:"mx-auto mb-2",style:{color:"white"}}),a),Se(a,"color","white"),Te(a,n),Se(l,"color","rgba(255, 255, 255, 0.9)"),Te(l,r),Te(c,ie(he,{get when(){return!t()},get children(){var t,n=zi(),r=n.firstChild,i=r.firstChild,s=r.nextSibling,o=s.firstChild,a=o.nextSibling,l=s.nextSibling,c=l.firstChild;return Se(n,"background","white"),Se(r,"border","2px solid #e5e7eb"),Se(r,"background","#f9fafb"),i.addEventListener("error",e=>{console.log(" Image load error:",Wi()?.imageUrl),e.currentTarget.style.display="none"}),Se(i,"width","100%"),Se(i,"height","200px"),Se(i,"padding","1rem"),Se(o,"color","#1f2937"),Te(o,()=>e()?.title),Se(a,"background","#dbeafe"),Se(a,"color","#1e40af"),Te(a,(t=we(()=>"costume"===e()?.category),()=>t()?" Pakaian Adat":we(()=>"artifact"===e()?.category)()?" Artefak":we(()=>"souvenir"===e()?.category)()?" Suvenir":"quiz"===e()?.category?" Quiz Penjaga":" Lainnya")),Se(l,"background","#f9fafb"),Se(c,"color","#374151"),Te(c,()=>e()?.description),S(t=>{var n=e()?.imageUrl||"",r=e()?.title||"";return n!==t.e&&xe(i,"src",t.e=n),r!==t.t&&xe(i,"alt",t.t=r),t},{e:void 0,t:void 0}),n}})),Se(u,"background","white"),h.addEventListener("mouseleave",e=>{e.currentTarget.style.transform="scale(1)"}),h.addEventListener("mouseenter",e=>{e.currentTarget.style.transform="scale(1.05)"}),h.$$click=Xi,Se(h,"background","linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"),Se(h,"color","white"),S(e=>Se(o,"background",i())),s}})}})};_e(["click"]);var es=ve("<svg><line x1=2 y1=2 x2=22 y2=22 stroke=white stroke-width=3></svg>",!1,!0,!1),ts=ve('<div class="flex flex-col gap-6 p-4 w-full"><div class="flex justify-center"><button class="flex items-center justify-center w-12 h-12 rounded-full transition-all duration-200 hover:scale-105"><svg width=24 height=24 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round style=color:white><path d="M9 18V5l12-2v13"></path><circle cx=6 cy=18 r=3></circle><circle cx=18 cy=16 r=3></circle></svg></button></div><div class="flex flex-col gap-2 w-full"><span class="text-sm font-medium text-gray-700">Volume</span><div class="flex items-center gap-3 w-full"><button class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors duration-200 font-bold"title="Kurangi Volume">-</button><div class="flex-1 relative"><div class="w-full h-2 bg-gray-200 rounded-lg relative"><div class="h-2 bg-green-500 rounded-lg absolute top-0 left-0"></div><div class="absolute top-1/2 w-4 h-4 bg-green-500 rounded-full border-2 border-white shadow-lg cursor-pointer transform -translate-y-1/2"></div><input type=range min=0 max=100 class="absolute inset-0 w-full h-2 opacity-0 cursor-pointer"></div></div><button class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors duration-200 font-bold"title="Tambah Volume">+');const[ns,rs]=D(!0),[is,ss]=D(30),[os,as]=D(!1),ls=()=>{console.log("[Audio] Starting background music...");const e=document.getElementById("background-music-entity"),t=document.getElementById("background-music");e&&t?(t.volume=is()/100,ns()?t.play().then(()=>{console.log("[Audio]  Background music started successfully"),as(!0)}).catch(e=>{console.warn("[Audio]  Failed to play background music:",e),as(!1)}):(console.log("[Audio]  Music disabled in settings"),as(!1))):console.warn("[Audio]  Background music elements not found")},cs=()=>{const e=document.getElementById("background-music");e?(rs(!ns()),ns()?(e.volume=is()/100,e.play().then(()=>{as(!0),console.log("[Audio]  Music enabled and playing")}).catch(e=>{console.warn("[Audio]  Failed to play music:",e),as(!1)})):(e.pause(),as(!1),console.log("[Audio]  Music disabled"))):console.warn("[Audio]  Audio element not found")},us=e=>{const t=document.getElementById("background-music");t?(ss(e),t.volume=e/100,console.log(`[Audio] Volume set to ${e}%`)):console.warn("[Audio]  Audio element not found")};R(()=>{window.startBackgroundMusic=ls,window.toggleMusic=cs,window.updateVolume=us,window.musicEnabled=ns,window.currentVolume=is,window.isMusicPlaying=os,window.testMusicControl=()=>{console.log(" MusicControl Test:"),console.log("- musicEnabled:",ns()),console.log("- currentVolume:",is()),console.log("- isMusicPlaying:",os())}});const hs=()=>{return t=(e=ts()).firstChild,(r=(n=t.firstChild).firstChild).firstChild.nextSibling.nextSibling,s=(i=t.nextSibling.firstChild.nextSibling.firstChild).nextSibling,o=s.firstChild.firstChild,a=o.nextSibling,l=a.nextSibling,c=s.nextSibling,n.$$click=cs,Te(r,ie(he,{get when(){return!ns()},get children(){return es()}}),null),i.$$click=()=>us(Math.max(0,is()-10)),a.$$mousedown=e=>{const t=e.currentTarget.parentElement?.querySelector('input[type="range"]');t&&t.focus()},l.$$input=e=>us(parseInt(e.currentTarget.value)),c.$$click=()=>us(Math.min(100,is()+10)),S(e=>{var t=ns()?"linear-gradient(135deg, #10b981, #059669)":"linear-gradient(135deg, #ef4444, #dc2626)",r=ns()?"0 4px 12px rgba(16, 185, 129, 0.4)":"0 4px 12px rgba(239, 68, 68, 0.4)",i=ns()?"Matikan Musik":"Nyalakan Musik",s=`width: ${is()}%`,l=`left: calc(${is()}% - 8px)`;return t!==e.e&&Se(n,"background",e.e=t),r!==e.t&&Se(n,"box-shadow",e.t=r),i!==e.a&&xe(n,"title",e.a=i),e.o=Ee(o,s,e.o),e.i=Ee(a,l,e.i),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),S(()=>l.value=is()),e;var e,t,n,r,i,s,o,a,l,c};_e(["click","mousedown","input"]);var ds=ve('<div class="naf-centered-fullscreen scrollable"style=z-index:100020><div class="flex w-full max-w-2xl flex-col gap-4 p-4 pb-8"></div><div class="sticky bottom-0 bg-white/95 backdrop-blur-sm w-full flex justify-center py-4 border-t border-gray-200"><button type=button id=closeMusicSettingsButton class="btn min-w-[100px]">Tutup');const ps=()=>{return n=(t=(e=ds()).firstChild).nextSibling.firstChild,Te(t,ie(hs,{})),n.$$click=()=>{const e=new CustomEvent("closeMusicSettings");window.dispatchEvent(e)},e;var e,t,n};_e(["click"]);var ms=ve('<div><p class=font-semibold></p><p class="mt-2 text-sm leading-relaxed text-slate-600">'),gs=ve('<div class="fixed inset-0 z-[80] flex items-center justify-center p-4 sm:p-6"><div class="absolute inset-0 bg-slate-900/70 backdrop-blur-sm"></div><div class="relative w-full max-w-2xl rounded-3xl bg-white shadow-2xl ring-1 ring-white/60"><div class="relative overflow-hidden rounded-t-3xl px-6 pb-6 pt-8 text-white sm:px-10 sm:pb-8"><div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"><div><p class="text-xs uppercase tracking-[0.3em] text-blue-100">Penjaga</p><h2 class="mt-1 text-2xl font-bold sm:text-3xl"></h2><p class="text-sm text-blue-100 sm:text-base">Rumah </p></div><div class="rounded-2xl bg-white/15 px-4 py-2 text-center"><p class="text-xs uppercase tracking-[0.4em] text-blue-100">Pertanyaan</p><p class="text-xl font-semibold"></p></div></div><p class="mt-4 text-sm leading-relaxed text-blue-100 sm:text-base"></p></div><div class="max-h-[65vh] overflow-y-auto px-5 py-6 sm:px-8 sm:py-8"><div class="space-y-5 sm:space-y-6"><div class="rounded-2xl border border-blue-100 bg-blue-50/70 px-5 py-4 shadow-inner sm:px-6 sm:py-5"><p class="text-xs uppercase tracking-[0.4em] text-blue-500">Pertanyaan</p><h3 class="mt-2 text-base font-semibold text-slate-900 sm:text-lg"></h3></div><div class="space-y-3 sm:space-y-4">'),fs=ve('<button type=button><span class="flex items-start gap-3"><span class="mt-0.5 inline-flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full border text-sm font-semibold text-slate-500"></span><span>');const[ys,ws]=D(!1),[bs,vs]=D(null),[_s,xs]=D([]),ks=e=>{console.log(" Satpam Quiz: Showing dialog for",e.guardName),vs(e),ws(!0)},Cs=()=>{const[e,t]=D(0),[n,r]=D(null),[i,s]=D(!1),[o,a]=D(null);I(()=>{if(ys()&&bs()){const e=bs()?.startIndex??0,n=(bs()?.questions??[]).map(e=>{const t=e.options.map((t,n)=>({text:t,isCorrect:n===e.correctIndex,originalIndex:n}));return{id:e.id,prompt:e.prompt,explanation:e.explanation,options:Ds(t)}});xs(n),t(e>=n.length?0:e),r(null),s(!1),a(null)}});const l=T(()=>_s().length??0),c=T(()=>_s()[e()]??null),u=T(()=>`${e()+1}/${l()}`);return R(()=>{window.showSatpamDialog=ks,console.log(" Satpam Quiz: showSatpamDialog exposed to window")}),ie(Ue,{get children(){return ie(he,{get when(){return we(()=>!(!ys()||!bs()))()&&c()},children:h=>{return(y=(f=(g=(m=(p=(d=gs()).firstChild.nextSibling.firstChild).firstChild).firstChild).firstChild.nextSibling).nextSibling).firstChild,w=g.nextSibling.firstChild.nextSibling,b=m.nextSibling,x=(_=(v=p.nextSibling.firstChild).firstChild).firstChild.nextSibling,k=_.nextSibling,Se(p,"background","linear-gradient(135deg,#3b82f6 0%,#1e3a8a 100%)"),Te(f,()=>h().guardName),Te(y,()=>h().houseName,null),Te(w,u),Te(b,()=>h().intro),Te(x,()=>c()?.prompt),Te(k,()=>c()?.options.map((o,u)=>{return p=(d=(h=fs()).firstChild.firstChild).nextSibling,h.$$click=()=>(o=>{if(i()||null!==n()||!c())return;const u=c();if(!u)return;const h=u.options[o],d=h?.isCorrect??!1;r(o),a(d),s(!0),window.gameProgress&&"function"==typeof window.gameProgress.recordQuestionResult&&window.gameProgress.recordQuestionResult({guardId:bs()?.guardId,questionId:u.id,isCorrect:d}),(async()=>{try{const e=await window.getCurrentSquadId();e&&window.updateSquadPoints&&(d?await window.updateSquadPoints(e,5,`Correct quiz answer: ${bs()?.guardName}`):await window.updateSquadPoints(e,-3,`Wrong quiz answer: ${bs()?.guardName}`))}catch(e){console.error("[Quiz] Error updating squad points:",e)}})(),setTimeout(()=>{const n=e()+1;n>=l()?((async()=>{try{const e=await window.getCurrentSquadId();e&&window.updateMissionProgress&&await window.updateMissionProgress(e,"quiz")}catch(e){console.error("[Quiz] Error updating mission progress:",e)}})(),(()=>{console.log(" Satpam Quiz: Closing dialog"),ws(!1);const e=bs();e?.onClose&&e.onClose(),setTimeout(()=>{vs(null)},250)})()):(t(n),r(null),a(null),s(!1))},1400)})(u),Te(d,()=>String.fromCharCode(65+u)),Te(p,()=>o.text),S(e=>{var t=(e=>{const t="w-full rounded-xl border px-4 py-3 text-left text-sm transition-all duration-200 sm:text-base";if(null===n())return`${t} border-slate-200 bg-white hover:-translate-y-[2px] hover:border-blue-400 hover:shadow`;const r=c();return r?r.options[e]?.isCorrect?`${t} border-emerald-500 bg-emerald-50 text-emerald-700 shadow-inner`:e===n()?`${t} border-rose-500 bg-rose-50 text-rose-700 shadow-inner`:`${t} border-slate-200 bg-white opacity-70`:t})(u),r=null!==n();return t!==e.e&&ke(h,e.e=t),r!==e.t&&(h.disabled=e.t=r),e},{e:void 0,t:void 0}),h;var h,d,p})),Te(v,ie(he,{get when(){return we(()=>null!==n())()&&c()},get children(){var e=ms(),t=e.firstChild,n=t.nextSibling;return Te(t,()=>o()?"Jawabanmu benar! ":"Yah, kurang tepat. Semangat lanjut ya!"),Te(n,()=>c()?.explanation),S(()=>ke(e,"rounded-2xl border px-4 py-4 sm:px-5 "+(o()?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-rose-200 bg-rose-50 text-rose-700"))),e}}),null),d;var d,p,m,g,f,y,w,b,v,_,x,k}})}})};function Ds(e){const t=e.slice();for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}_e(["click"]);var Es=ve('<div class="fixed inset-0 z-[85] flex items-end justify-center bg-slate-900/50 backdrop-blur-sm sm:items-center"><div class="absolute inset-0"></div><div class="relative w-full max-w-[420px] rounded-t-3xl bg-white shadow-2xl sm:rounded-3xl sm:border sm:border-slate-100"><div class="flex items-center justify-between px-5 py-4 sm:px-6"><div><p class="text-xs font-semibold uppercase tracking-[0.4em] text-blue-500">Kuis / Rumah Adat</p><h2 class="text-xl font-bold text-slate-900 sm:text-2xl">Ringkasan Progres</h2></div><button type=button class="rounded-full bg-slate-100 p-2 text-slate-500 transition hover:bg-slate-200 hover:text-slate-700"></button></div><div class="grid grid-cols-2 gap-3 px-5 pb-5 sm:px-6"><div class="rounded-2xl border border-blue-100 bg-blue-50/60 p-4"><p class="text-[10px] font-semibold uppercase tracking-[0.2em] text-blue-600">Total Kuis</p><p class="mt-2 text-2xl font-bold text-blue-800"></p><p class="mt-1 text-xs text-blue-600">Jumlah pertanyaan tersedia</p></div><div class="rounded-2xl border border-emerald-100 bg-emerald-50/70 p-4"><p class="text-[10px] font-semibold uppercase tracking-[0.2em] text-emerald-600">Sudah Dijawab</p><p class="mt-2 text-2xl font-bold text-emerald-700"></p><p class="mt-1 text-xs text-emerald-600"><span class="font-semibold text-emerald-700"></span> benar,<span class="font-semibold text-rose-600"> </span> salah</p></div><div class="col-span-2 rounded-2xl border border-amber-100 bg-amber-50/70 p-4"><p class="text-[10px] font-semibold uppercase tracking-[0.2em] text-amber-500">Pertanyaan Tersisa</p><div class="mt-2 flex items-baseline justify-between"><p class="text-3xl font-bold text-amber-600"></p><p class="text-xs font-medium text-amber-600">/<!> selesai</p></div><div class="mt-3 h-2 rounded-full bg-amber-100"><div class="h-full rounded-full bg-gradient-to-r from-amber-400 to-orange-500 transition-all duration-500">');const Ss={answeredQuestions:0,totalQuestions:0,correctAnswers:0,wrongAnswers:0},Is=e=>{const[t,n]=D(Ss),r=e=>{if(!e.detail)return;const t=e.detail;n({answeredQuestions:t.answeredQuestions??0,totalQuestions:t.totalQuestions??0,correctAnswers:t.correctAnswers??0,wrongAnswers:t.wrongAnswers??0})};R(()=>{const e=e=>r(e);if(window.addEventListener("gameProgress:update",e),window.addEventListener("gameProgress:completed",e),window.gameProgress&&"function"==typeof window.gameProgress.getState){const e=window.gameProgress.getState();r(new CustomEvent("init",{detail:e}))}N(()=>{window.removeEventListener("gameProgress:update",e),window.removeEventListener("gameProgress:completed",e)})});const i=()=>{const e=t().totalQuestions||0,n=t().answeredQuestions||0;return Math.max(e-n,0)};return ie(Ue,{get children(){return ie(he,{get when(){return e.open},get children(){var n=Es(),r=n.firstChild,s=r.nextSibling.firstChild,o=s.firstChild.nextSibling,a=s.nextSibling.firstChild,l=a.firstChild.nextSibling,c=a.nextSibling,u=c.firstChild.nextSibling,h=u.nextSibling.firstChild,d=h.nextSibling.nextSibling,p=(d.firstChild,c.nextSibling.firstChild.nextSibling),m=p.firstChild,g=m.nextSibling,f=g.firstChild,y=f.nextSibling,w=(y.nextSibling,p.nextSibling.firstChild);return r.$$click=()=>e.onClose(),o.$$click=()=>e.onClose(),Te(o,ie(nt,{size:20})),Te(l,()=>t().totalQuestions),Te(u,()=>t().answeredQuestions),Te(h,()=>t().correctAnswers),Te(d,()=>t().wrongAnswers,null),Te(m,i),Te(g,()=>t().answeredQuestions,f),Te(g,()=>t().totalQuestions,y),S(e=>Se(w,"width",`${t().totalQuestions?Math.min(100,Math.round(t().answeredQuestions/t().totalQuestions*100)):0}%`)),n}})}})};_e(["click"]),AFRAME.registerSystem("video",{init(){!function(e,t){for(const n in t)e.events[n]=t[n].bind(e)}(this,this.events),this.eventsAttach()},eventsAttach:function(){this.eventsDetach();for(const e in this.events)this.el.addEventListener(e,this.events[e])},eventsDetach:function(){for(const e in this.events)this.el.removeEventListener(e,this.events[e])},events:{action_share_camera:e=>{const t=e.detail.el.id;Kr(t)},action_share_screen:e=>{const t=e.detail.el.id;Qr(t)},action_end_video_sharing:Yr,share_video_enabled:e=>{console.log("share video enabled",e),"camera"===e.detail.source&&ei(!0),"screen"===e.detail.source&&Xr(!0)},share_video_disabled:()=>{ei(!1),Xr(!1)},share_video_failed:()=>{}},play(){},pause(){}});const Ts={showRandomAvatarButton:!1,showDieButton:!0,...window.uiSettings},As=function(e,t){if(!e)throw Ps(t)},Ps=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},Rs=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Ns={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=i>>2,u=(3&i)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Rs(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new Fs;const l=i<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Fs extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Os=function(e){const t=Rs(e);return Ns.encodeByteArray(t,!0)},Ms=function(e){return Os(e).replace(/\./g,"")},Ls=function(e){try{return Ns.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Us(e){return qs(void 0,e)}function qs(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&js(n)&&(e[n]=qs(e[n],t[n]));return e}function js(e){return"__proto__"!==e}const Vs=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&Ls(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},Bs=e=>Vs()?.emulatorHosts?.[e],zs=e=>{const t=Bs(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},$s=()=>Vs()?.config,Hs=e=>Vs()?.[`_${e}`];class Gs{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Ws(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ks(e){return(await fetch(e,{credentials:"include"})).ok}function Qs(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[Ms(JSON.stringify({alg:"none",type:"JWT"})),Ms(JSON.stringify(s)),""].join(".")}const Ys={};let Js=!1;function Xs(e,t){if("undefined"==typeof window||"undefined"==typeof document||!Ws(window.location.host)||Ys[e]===t||Ys[e]||Js)return;function n(e){return`__firebase__banner__${e}`}Ys[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Ys))Ys[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),a=document.getElementById(o)||document.createElement("a"),l=n("preprendIcon"),c=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(a,o);const n=function(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Js=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(c,l),t.append(c,s,a,n),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",c.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(c.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function Zs(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function eo(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zs())}function to(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function no(){return!function(){const e=Vs()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class ro extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,ro.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,io.prototype.create)}}class io{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(so,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new ro(r,o,n)}}const so=/\{\$([^}]+)}/g;function oo(e){return JSON.parse(e)}function ao(e){return JSON.stringify(e)}const lo=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=oo(Ls(s[0])||""),n=oo(Ls(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function co(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function uo(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function ho(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function po(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function mo(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(go(n)&&go(s)){if(!mo(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function go(e){return null!==e&&"object"==typeof e}function fo(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function yo(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function wo(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class bo{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):e<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const t=(s<<5|s>>>27)+r+c+i+n[e]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class vo{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=_o),void 0===r.error&&(r.error=_o),void 0===r.complete&&(r.complete=_o);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _o(){}function xo(e,t){return`${e} failed: ${t} argument `}const ko=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Co(e){return e&&e._delegate?e._delegate:e}class Do{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Eo="[DEFAULT]";class So{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Gs;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Eo?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Io{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new So(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const To=[];var Ao;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ao||(Ao={}));const Po={debug:Ao.DEBUG,verbose:Ao.VERBOSE,info:Ao.INFO,warn:Ao.WARN,error:Ao.ERROR,silent:Ao.SILENT},Ro=Ao.INFO,No={[Ao.DEBUG]:"log",[Ao.VERBOSE]:"log",[Ao.INFO]:"info",[Ao.WARN]:"warn",[Ao.ERROR]:"error"},Fo=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=No[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class Oo{constructor(e){this.name=e,this._logLevel=Ro,this._logHandler=Fo,this._userLogHandler=null,To.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ao))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Po[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ao.DEBUG,...e),this._logHandler(this,Ao.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ao.VERBOSE,...e),this._logHandler(this,Ao.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ao.INFO,...e),this._logHandler(this,Ao.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ao.WARN,...e),this._logHandler(this,Ao.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ao.ERROR,...e),this._logHandler(this,Ao.ERROR,...e)}}let Mo,Lo;const Uo=new WeakMap,qo=new WeakMap,jo=new WeakMap,Vo=new WeakMap,Bo=new WeakMap;let zo={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return qo.get(e);if("objectStoreNames"===t)return e.objectStoreNames||jo.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ho(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function $o(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Lo||(Lo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Go(this),e),Ho(Uo.get(this))}:function(...e){return Ho(t.apply(Go(this),e))}:function(e,...n){const r=t.call(Go(this),e,...n);return jo.set(r,e.sort?e.sort():[e]),Ho(r)}:(e instanceof IDBTransaction&&function(e){if(qo.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});qo.set(e,t)}(e),n=e,(Mo||(Mo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>n instanceof e)?new Proxy(e,zo):e);var t,n}function Ho(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(Ho(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&Uo.set(t,e)}).catch(()=>{}),Bo.set(t,e),t}(e);if(Vo.has(e))return Vo.get(e);const t=$o(e);return t!==e&&(Vo.set(e,t),Bo.set(t,e)),t}const Go=e=>Bo.get(e),Wo=["get","getKey","getAll","getAllKeys","count"],Ko=["put","add","delete","clear"],Qo=new Map;function Yo(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Qo.get(t))return Qo.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ko.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Wo.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return Qo.set(t,s),s}var Jo;Jo=zo,zo={...Jo,get:(e,t,n)=>Yo(e,t)||Jo.get(e,t,n),has:(e,t)=>!!Yo(e,t)||Jo.has(e,t)};class Xo{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Zo="@firebase/app",ea="0.14.4",ta=new Oo("@firebase/app"),na="@firebase/app-compat",ra="@firebase/analytics-compat",ia="@firebase/analytics",sa="@firebase/app-check-compat",oa="@firebase/app-check",aa="@firebase/auth",la="@firebase/auth-compat",ca="@firebase/database",ua="@firebase/data-connect",ha="@firebase/database-compat",da="@firebase/functions",pa="@firebase/functions-compat",ma="@firebase/installations",ga="@firebase/installations-compat",fa="@firebase/messaging",ya="@firebase/messaging-compat",wa="@firebase/performance",ba="@firebase/performance-compat",va="@firebase/remote-config",_a="@firebase/remote-config-compat",xa="@firebase/storage",ka="@firebase/storage-compat",Ca="@firebase/firestore",Da="@firebase/ai",Ea="@firebase/firestore-compat",Sa="firebase",Ia="[DEFAULT]",Ta={[Zo]:"fire-core",[na]:"fire-core-compat",[ia]:"fire-analytics",[ra]:"fire-analytics-compat",[oa]:"fire-app-check",[sa]:"fire-app-check-compat",[aa]:"fire-auth",[la]:"fire-auth-compat",[ca]:"fire-rtdb",[ua]:"fire-data-connect",[ha]:"fire-rtdb-compat",[da]:"fire-fn",[pa]:"fire-fn-compat",[ma]:"fire-iid",[ga]:"fire-iid-compat",[fa]:"fire-fcm",[ya]:"fire-fcm-compat",[wa]:"fire-perf",[ba]:"fire-perf-compat",[va]:"fire-rc",[_a]:"fire-rc-compat",[xa]:"fire-gcs",[ka]:"fire-gcs-compat",[Ca]:"fire-fst",[Ea]:"fire-fst-compat",[Da]:"fire-vertex","fire-js":"fire-js",[Sa]:"fire-js-all"},Aa=new Map,Pa=new Map,Ra=new Map;function Na(e,t){try{e.container.addComponent(t)}catch(n){ta.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Fa(e){const t=e.name;if(Ra.has(t))return ta.debug(`There were multiple attempts to register component ${t}.`),!1;Ra.set(t,e);for(const t of Aa.values())Na(t,e);for(const t of Pa.values())Na(t,e);return!0}function Oa(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ma(e){return null!=e&&void 0!==e.settings}const La=new io("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ua{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Do("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw La.create("app-deleted",{appName:this._name})}}const qa="12.4.0";function ja(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r={name:Ia,automaticDataCollectionEnabled:!0,...t},i=r.name;if("string"!=typeof i||!i)throw La.create("bad-app-name",{appName:String(i)});if(n||(n=$s()),!n)throw La.create("no-options");const s=Aa.get(i);if(s){if(mo(n,s.options)&&mo(r,s.config))return s;throw La.create("duplicate-app",{appName:i})}const o=new Io(i);for(const e of Ra.values())o.addComponent(e);const a=new Ua(n,r,o);return Aa.set(i,a),a}function Va(e=Ia){const t=Aa.get(e);if(!t&&e===Ia&&$s())return ja();if(!t)throw La.create("no-app",{appName:e});return t}function Ba(e,t,n){let r=Ta[e]??e;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=[`Unable to register library "${r}" with version "${t}":`];return i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ta.warn(e.join(" "))}Fa(new Do(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const za="firebase-heartbeat-store";let $a=null;function Ha(){return $a||($a=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=Ho(o);return r&&o.addEventListener("upgradeneeded",e=>{r(Ho(o.result),e.oldVersion,e.newVersion,Ho(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(za)}catch(e){console.warn(e)}}}).catch(e=>{throw La.create("idb-open",{originalErrorMessage:e.message})})),$a}async function Ga(e,t){try{const n=(await Ha()).transaction(za,"readwrite"),r=n.objectStore(za);await r.put(t,Wa(e)),await n.done}catch(e){if(e instanceof ro)ta.warn(e.message);else{const t=La.create("idb-set",{originalErrorMessage:e?.message});ta.warn(t.message)}}}function Wa(e){return`${e.name}!${e.options.appId}`}class Ka{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ya(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Qa();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ta.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=Qa(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Ja(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ja(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=Ms(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return ta.warn(e),""}}}function Qa(){return(new Date).toISOString().substring(0,10)}class Ya{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Ha()).transaction(za),n=await t.objectStore(za).get(Wa(e));return await t.done,n}catch(e){if(e instanceof ro)ta.warn(e.message);else{const t=La.create("idb-get",{originalErrorMessage:e?.message});ta.warn(t.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return Ga(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return Ga(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function Ja(e){return Ms(JSON.stringify({version:2,heartbeats:e})).length}Fa(new Do("platform-logger",e=>new Xo(e),"PRIVATE")),Fa(new Do("heartbeat",e=>new Ka(e),"PRIVATE")),Ba(Zo,ea,""),Ba(Zo,ea,"esm2020"),Ba("fire-js",""),Ba("firebase","12.4.0","app");const Xa=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Za=new io("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),el=new Oo("@firebase/auth");function tl(e,...t){el.logLevel<=Ao.ERROR&&el.error(`Auth (${qa}): ${e}`,...t)}function nl(e,...t){throw ol(e,...t)}function rl(e,...t){return ol(e,...t)}function il(e,t,n){const r={...Xa(),[t]:n};return new io("auth","Firebase",r).create(t,{appName:e.name})}function sl(e){return il(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ol(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Za.create(e,...t)}function al(e,t,...n){if(!e)throw ol(t,...n)}function ll(e){const t="INTERNAL ASSERTION FAILED: "+e;throw tl(t),new Error(t)}function cl(e,t){e||ll(t)}function ul(){return"undefined"!=typeof self&&self.location?.href||""}function hl(){return"undefined"!=typeof self&&self.location?.protocol||null}function dl(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===hl()||"https:"===hl()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class pl{constructor(e,t){this.shortDelay=e,this.longDelay=t,cl(t>e,"Short delay should be less than long delay!"),this.isMobile=eo()||to()}get(){return dl()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ml(e,t){cl(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class gl{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ll("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ll("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ll("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fl={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},yl=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wl=new pl(3e4,6e4);function bl(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function vl(e,t,n,r,i={}){return _l(e,i,async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=fo({key:e.config.apiKey,...s}).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:a,...i};return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&Ws(e.emulatorConfig.host)&&(l.credentials="include"),gl.fetch()(await kl(e,e.config.apiHost,n,o),l)})}async function _l(e,t,n){e._canInitEmulator=!1;const r={...fl,...t};try{const t=new Dl(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw El(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw El(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw El(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw El(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw il(e,a,o);nl(e,a)}}catch(t){if(t instanceof ro)throw t;nl(e,"network-request-failed",{message:String(t)})}}async function xl(e,t,n,r,i={}){const s=await vl(e,t,n,r,i);return"mfaPendingCredential"in s&&nl(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function kl(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?ml(e.config,i):`${e.config.apiScheme}://${i}`;return yl.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())?s._getPersistence()._getFinalTarget(o).toString():o}function Cl(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Dl{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(rl(this.auth,"network-request-failed")),wl.get())})}}function El(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=rl(e,t,r);return i.customData._tokenResponse=n,i}function Sl(e){return void 0!==e&&void 0!==e.enterprise}class Il{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Cl(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Tl(e,t){return vl(e,"GET","/v2/recaptchaConfig",bl(e,t))}async function Al(e,t){return vl(e,"POST","/v1/accounts:lookup",t)}function Pl(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Rl(e){return 1e3*Number(e)}function Nl(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return tl("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ls(n);return e?JSON.parse(e):(tl("Failed to decode base64 JWT payload"),null)}catch(e){return tl("Caught error parsing JWT payload as JSON",e?.toString()),null}}function Fl(e){const t=Nl(e);return al(t,"internal-error"),al(void 0!==t.exp,"internal-error"),al(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Ol(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof ro&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Ml{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class Ll{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pl(this.lastLoginAt),this.creationTime=Pl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ul(e){const t=e.auth,n=await e.getIdToken(),r=await Ol(e,Al(t,{idToken:n}));al(r?.users.length,t,"internal-error");const i=r.users[0];e._notifyReloadListener(i);const s=i.providerUserInfo?.length?ql(i.providerUserInfo):[],o=(a=e.providerData,l=s,[...a.filter(e=>!l.some(t=>t.providerId===e.providerId)),...l]);var a,l;const c=e.isAnonymous,u=!(e.email&&i.passwordHash||o?.length),h=!!c&&u,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ll(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function ql(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}class jl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){al(e.idToken,"internal-error"),al(void 0!==e.idToken,"internal-error"),al(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Fl(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){al(0!==e.length,"internal-error");const t=Fl(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(al(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await _l(e,{},async()=>{const n=fo({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await kl(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&Ws(e.emulatorConfig.host)&&(a.credentials="include"),gl.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new jl;return n&&(al("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(al("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(al("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jl,this.toJSON())}_performRefresh(){return ll("not implemented")}}function Vl(e,t){al("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Bl{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new Ml(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Ll(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Ol(this,this.stsTokenManager.getToken(this.auth,e));return al(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Co(e),r=await n.getIdToken(t),i=Nl(r);al(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Pl(Rl(i.auth_time)),issuedAtTime:Pl(Rl(i.iat)),expirationTime:Pl(Rl(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=Co(e);await Ul(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(al(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Bl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){al(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ul(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ma(this.auth.app))return Promise.reject(sl(this.auth));const e=await this.getIdToken();return await Ol(this,async function(e,t){return vl(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,l=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:d,providerData:p,stsTokenManager:m}=t;al(u&&m,e,"internal-error");const g=jl.fromJSON(this.name,m);al("string"==typeof u,e,"internal-error"),Vl(n,e.name),Vl(r,e.name),al("boolean"==typeof h,e,"internal-error"),al("boolean"==typeof d,e,"internal-error"),Vl(i,e.name),Vl(s,e.name),Vl(o,e.name),Vl(a,e.name),Vl(l,e.name),Vl(c,e.name);const f=new Bl({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:o,stsTokenManager:g,createdAt:l,lastLoginAt:c});return p&&Array.isArray(p)&&(f.providerData=p.map(e=>({...e}))),a&&(f._redirectEventId=a),f}static async _fromIdTokenResponse(e,t,n=!1){const r=new jl;r.updateFromServerResponse(t);const i=new Bl({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Ul(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];al(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?ql(r.providerUserInfo):[],s=!(r.email&&r.passwordHash||i?.length),o=new jl;o.updateFromIdToken(n);const a=new Bl({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Ll(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||i?.length)};return Object.assign(a,l),a}}const zl=new Map;function $l(e){cl(e instanceof Function,"Expected a class definition");let t=zl.get(e);return t?(cl(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,zl.set(e,t),t)}class Hl{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Hl.type="NONE";const Gl=Hl;function Wl(e,t,n){return`firebase:${e}:${t}:${n}`}class Kl{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Wl(this.userKey,r.apiKey,i),this.fullPersistenceKey=Wl("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await Al(this.auth,{idToken:e}).catch(()=>{});return t?Bl._fromGetAccountInfoResponse(this.auth,t,e):null}return Bl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Kl($l(Gl),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||$l(Gl);const s=Wl(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){let r;if("string"==typeof t){const n=await Al(e,{idToken:t}).catch(()=>{});if(!n)break;r=await Bl._fromGetAccountInfoResponse(e,n,t)}else r=Bl._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch{}})),new Kl(i,e,n)):new Kl(i,e,n)}}function Ql(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Zl(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Yl(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(tc(t))return"Blackberry";if(nc(t))return"Webos";if(Jl(t))return"Safari";if((t.includes("chrome/")||Xl(t))&&!t.includes("edge/"))return"Chrome";if(ec(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function Yl(e=Zs()){return/firefox\//i.test(e)}function Jl(e=Zs()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Xl(e=Zs()){return/crios\//i.test(e)}function Zl(e=Zs()){return/iemobile/i.test(e)}function ec(e=Zs()){return/android/i.test(e)}function tc(e=Zs()){return/blackberry/i.test(e)}function nc(e=Zs()){return/webos/i.test(e)}function rc(e=Zs()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ic(e=Zs()){return rc(e)||ec(e)||nc(e)||tc(e)||/windows phone/i.test(e)||Zl(e)}function sc(e,t=[]){let n;switch(e){case"Browser":n=Ql(Zs());break;case"Worker":n=`${Ql(Zs())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${qa}/${r}`}class oc{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}}class ac{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class lc{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uc(this),this.idTokenSubscription=new uc(this),this.beforeStateQueue=new oc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Za,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$l(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Kl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Al(this,{idToken:e}),n=await Bl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ma(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,i=n?._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==i||!s?.user||(n=s.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return al(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ul(e)}catch(e){if("auth/network-request-failed"!==e?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ma(this.app))return Promise.reject(sl(this));const t=e?Co(e):null;return t&&al(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&al(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ma(this.app)?Promise.reject(sl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ma(this.app)?Promise.reject(sl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($l(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return vl(e,"GET","/v2/passwordPolicy",bl(e,t))}(this),t=new ac(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new io("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return vl(e,"POST","/v2/accounts:revokeToken",bl(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$l(e)||this._popupRedirectResolver;al(t,this,"argument-error"),this.redirectPersistenceManager=await Kl.create(this,[$l(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(al(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return al(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sc(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ma(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e,...t){el.logLevel<=Ao.WARN&&el.warn(`Auth (${qa}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function cc(e){return Co(e)}class uc{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e){const t=new vo(e,void 0);return t.subscribe.bind(t)}(e=>this.observer=e)}get next(){return al(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dc(e){return hc.loadJS(e)}function pc(e){return`__${e}${Math.floor(1e6*Math.random())}`}class mc{constructor(){this.enterprise=new gc}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class gc{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const fc="NO_RECAPTCHA";class yc{constructor(e){this.type="recaptcha-enterprise",this.auth=cc(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;Sl(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(fc)})}):r(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?(new mc).execute("siteKey",{action:"verify"}):new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Tl(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Il(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Sl(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=hc.recaptchaEnterpriseScript;0!==t.length&&(t+=i),dc(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function wc(e,t,n,r=!1,i=!1){const s=new yc(e);let o;if(i)o=fc;else try{o=await s.verify(n)}catch(e){o=await s.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function bc(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await wc(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await wc(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const i=await wc(e,t,n);return r(e,i).catch(async i=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await wc(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await wc(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}function vc(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function _c(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ll("not implemented")}_getIdTokenResponse(e){return ll("not implemented")}_linkToIdToken(e,t){return ll("not implemented")}_getReauthenticationResolver(e){return ll("not implemented")}}async function kc(e,t){return vl(e,"POST","/v1/accounts:signUp",t)}async function Cc(e,t){return xl(e,"POST","/v1/accounts:signInWithPassword",bl(e,t))}class Dc extends xc{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Dc(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Dc(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return bc(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Cc,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return xl(e,"POST","/v1/accounts:signInWithEmailLink",bl(e,t))}(e,{email:this._email,oobCode:this._password});default:nl(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return bc(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kc,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return xl(e,"POST","/v1/accounts:signInWithEmailLink",bl(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:nl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ec(e,t){return xl(e,"POST","/v1/accounts:signInWithIdp",bl(e,t))}class Sc extends xc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):nl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...i}=t;if(!n||!r)return null;const s=new Sc(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Ec(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ec(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ec(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=fo(t)}return e}}async function Ic(e,t){return vl(e,"POST","/v1/accounts:sendVerificationCode",bl(e,t))}const Tc={USER_NOT_FOUND:"user-not-found"};class Ac extends xc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ac({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ac({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return xl(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await xl(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,t));if(n.temporaryProof)throw El(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return xl(e,"POST","/v1/accounts:signInWithPhoneNumber",bl(e,{...t,operation:"REAUTH"}),Tc)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Ac({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Pc{constructor(e){const t=yo(wo(e)),n=t.apiKey??null,r=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);al(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=yo(wo(e)).link,n=t?yo(wo(t)).deep_link_id:null,r=yo(wo(e)).deep_link_id;return(r?yo(wo(r)).link:null)||r||n||t||e}(e);try{return new Pc(t)}catch{return null}}}class Rc{constructor(){this.providerId=Rc.PROVIDER_ID}static credential(e,t){return Dc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Pc.parseLink(t);return al(n,"argument-error"),Dc._fromEmailAndCode(e,n.code,n.tenantId)}}Rc.PROVIDER_ID="password",Rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Nc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Fc extends Nc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Oc extends Fc{constructor(){super("facebook.com")}static credential(e){return Sc._fromParams({providerId:Oc.PROVIDER_ID,signInMethod:Oc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oc.credentialFromTaggedObject(e)}static credentialFromError(e){return Oc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Oc.credential(e.oauthAccessToken)}catch{return null}}}Oc.FACEBOOK_SIGN_IN_METHOD="facebook.com",Oc.PROVIDER_ID="facebook.com";class Mc extends Fc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sc._fromParams({providerId:Mc.PROVIDER_ID,signInMethod:Mc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mc.credentialFromTaggedObject(e)}static credentialFromError(e){return Mc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Mc.credential(t,n)}catch{return null}}}Mc.GOOGLE_SIGN_IN_METHOD="google.com",Mc.PROVIDER_ID="google.com";class Lc extends Fc{constructor(){super("github.com")}static credential(e){return Sc._fromParams({providerId:Lc.PROVIDER_ID,signInMethod:Lc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lc.credentialFromTaggedObject(e)}static credentialFromError(e){return Lc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Lc.credential(e.oauthAccessToken)}catch{return null}}}Lc.GITHUB_SIGN_IN_METHOD="github.com",Lc.PROVIDER_ID="github.com";class Uc extends Fc{constructor(){super("twitter.com")}static credential(e,t){return Sc._fromParams({providerId:Uc.PROVIDER_ID,signInMethod:Uc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Uc.credentialFromTaggedObject(e)}static credentialFromError(e){return Uc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Uc.credential(t,n)}catch{return null}}}Uc.TWITTER_SIGN_IN_METHOD="twitter.com",Uc.PROVIDER_ID="twitter.com";class qc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Bl._fromIdTokenResponse(e,n,r),s=jc(n);return new qc({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=jc(n);return new qc({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function jc(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Vc extends ro{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Vc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Vc(e,t,n,r)}}function Bc(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Vc._fromErrorAndOperation(e,n,t,r);throw n})}function zc(e,t){return vl(e,"POST","/v2/accounts/mfaEnrollment:start",bl(e,t))}new WeakMap;const $c="__sak";class Hc{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($c,"1"),this.storage.removeItem($c),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Gc extends Hc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ic(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=Zs();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Gc.type="LOCAL";const Wc=Gc;class Kc extends Hc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Kc.type="SESSION";const Qc=Kc;class Yc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Yc(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Jc(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Yc.receivers=[];class Xc{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Jc("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Zc(){return window}function eu(){return void 0!==Zc().WorkerGlobalScope&&"function"==typeof Zc().importScripts}const tu="firebaseLocalStorageDb",nu="firebaseLocalStorage",ru="fbase_key";class iu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function su(e,t){return e.transaction([nu],t?"readwrite":"readonly").objectStore(nu)}function ou(){const e=indexedDB.open(tu,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(nu,{keyPath:ru})}catch(e){n(e)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(nu)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(tu);return new iu(e).toPromise()}(),t(await ou()))})})}async function au(e,t,n){const r=su(e,!0).put({[ru]:t,value:n});return new iu(r).toPromise()}function lu(e,t){const n=su(e,!0).delete(t);return new iu(n).toPromise()}class cu{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ou()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eu()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yc._getInstance(eu()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new Xc(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ou();return await au(e,$c,"1"),await lu(e,$c),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>au(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=su(e,!1).get(t),r=await new iu(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lu(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=su(e,!1).getAll();return new iu(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}cu.type="LOCAL";const uu=cu;function hu(e,t){return vl(e,"POST","/v2/accounts/mfaSignIn:start",bl(e,t))}pc("rcb"),new pl(3e4,6e4);const du="recaptcha";async function pu(e,t,n){if(!e._getRecaptchaConfig())try{await async function(e){const t=cc(e),n=await Tl(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Il(n);null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new yc(t).verify()}(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"==typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){al("enroll"===t.type,e,"internal-error");const i=bc(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},"mfaSmsEnrollment",async(e,t)=>t.phoneEnrollmentInfo.captchaResponse===fc?(al(n?.type===du,e,"argument-error"),zc(e,await mu(e,t,n))):zc(e,t),"PHONE_PROVIDER"),s=await i.catch(e=>Promise.reject(e));return s.phoneSessionInfo.sessionInfo}{al("signin"===t.type,e,"internal-error");const i=r.multiFactorHint?.uid||r.multiFactorUid;al(i,e,"missing-multi-factor-info");const s=bc(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},"mfaSmsSignIn",async(e,t)=>t.phoneSignInInfo.captchaResponse===fc?(al(n?.type===du,e,"argument-error"),hu(e,await mu(e,t,n))):hu(e,t),"PHONE_PROVIDER"),o=await s.catch(e=>Promise.reject(e));return o.phoneResponseInfo.sessionInfo}}{const t=bc(e,{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},"sendVerificationCode",async(e,t)=>t.captchaResponse===fc?(al(n?.type===du,e,"argument-error"),Ic(e,await mu(e,t,n))):Ic(e,t),"PHONE_PROVIDER"),i=await t.catch(e=>Promise.reject(e));return i.sessionInfo}}finally{n?._reset()}}async function mu(e,t,n){al(n.type===du,e,"argument-error");const r=await n.verify();al("string"==typeof r,e,"argument-error");const i={...t};if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class gu{constructor(e){this.providerId=gu.PROVIDER_ID,this.auth=cc(e)}verifyPhoneNumber(e,t){return pu(this.auth,e,Co(t))}static credential(e,t){return Ac._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gu.credentialFromTaggedObject(t)}static credentialFromError(e){return gu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Ac._fromTokenResponse(t,n):null}}gu.PROVIDER_ID="phone",gu.PHONE_SIGN_IN_METHOD="phone";class fu extends xc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ec(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ec(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ec(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function yu(e){return async function(e,t,n=!1){if(Ma(e.app))return Promise.reject(sl(e));const r="signIn",i=await Bc(e,r,t),s=await qc._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new fu(e),e.bypassAuthState)}function wu(e){const{auth:t,user:n}=e;return al(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if(Ma(r.app))return Promise.reject(sl(r));const i="reauthenticate";try{const s=await Ol(e,Bc(r,i,t,e),n);al(s.idToken,r,"internal-error");const o=Nl(s.idToken);al(o,r,"internal-error");const{sub:a}=o;return al(e.uid===a,r,"user-mismatch"),qc._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===e?.code&&nl(r,"user-mismatch"),e}}(n,new fu(e),e.bypassAuthState)}async function bu(e){const{auth:t,user:n}=e;return al(n,t,"internal-error"),async function(e,t,n=!1){const r=await Ol(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return qc._forOperation(e,"link",r)}(n,new fu(e),e.bypassAuthState)}class vu{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yu;case"linkViaPopup":case"linkViaRedirect":return bu;case"reauthViaPopup":case"reauthViaRedirect":return wu;default:nl(this.auth,"internal-error")}}resolve(e){cl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const _u=new pl(2e3,1e4);class xu extends vu{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,xu.currentPopupAction&&xu.currentPopupAction.cancel(),xu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return al(e,this.auth,"internal-error"),e}async onExecution(){cl(1===this.filter.length,"Popup operations only handle one event");const e=Jc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(rl(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(rl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xu.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(rl(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,_u.get())};e()}}xu.currentPopupAction=null;const ku=new Map;class Cu extends vu{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ku.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Wl("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return $l(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ku.set(this.auth._key(),e)}return this.bypassAuthState||ku.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Du(e,t){ku.set(e._key(),t)}async function Eu(e,t,n=!1){if(Ma(e.app))return Promise.reject(sl(e));const r=cc(e),i=function(e,t){return t?$l(t):(al(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new Cu(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Su{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tu(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Tu(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(rl(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Iu(e))}saveEventToCache(e){this.cachedEventUids.add(Iu(e)),this.lastProcessedEventTime=Date.now()}}function Iu(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Tu({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}const Au=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pu=/^https?/;function Ru(e){const t=ul(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Pu.test(n))return!1;if(Au.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Nu=new pl(3e4,6e4);function Fu(){const e=Zc().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function Ou(e){return new Promise((t,n)=>{function r(){Fu(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Fu(),n(rl(e,"network-request-failed"))},timeout:Nu.get()})}if(Zc().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!Zc().gapi?.load){const t=pc("iframefcb");return Zc()[t]=()=>{gapi.load?r():n(rl(e,"network-request-failed"))},dc(`${hc.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw Mu=null,e})}let Mu=null;const Lu=new pl(5e3,15e3),Uu={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qu=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ju(e){const t=e.config;al(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ml(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:qa},i=qu.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${fo(r).slice(1)}`}const Vu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Bu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const zu=encodeURIComponent("fac");async function $u(e,t,n,r,i,s){al(e.config.authDomain,e,"auth-domain-config-required"),al(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:qa,eventId:i};if(t instanceof Nc){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",ho(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Fc){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const l=await e._getAppCheckToken(),c=l?`#${zu}=${encodeURIComponent(l)}`:"";return`${function({config:e}){return e.emulator?ml(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${fo(a).slice(1)}${c}`}const Hu="webStorageSupport",Gu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qc,this._completeRedirectFn=Eu,this._overrideRedirectResult=Du}async _openPopup(e,t,n,r){return cl(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...Vu,width:r.toString(),height:i.toString(),top:s,left:o},c=Zs().toLowerCase();n&&(a=Xl(c)?"_blank":n),Yl(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Zs()){return rc(e)&&!!window.navigator?.standalone}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Bu(null);const h=window.open(t||"",a,u);al(h,e,"popup-blocked");try{h.focus()}catch(e){}return new Bu(h)}(e,await $u(e,t,n,ul(),r),Jc())}async _openRedirect(e,t,n,r){return await this._originValidation(e),i=await $u(e,t,n,ul(),r),Zc().location.href=i,new Promise(()=>{});var i}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(cl(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return Mu=Mu||Ou(e),Mu}(e),n=Zc().gapi;return al(n,e,"internal-error"),t.open({where:document.body,url:ju(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Uu,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=rl(e,"network-request-failed"),s=Zc().setTimeout(()=>{r(i)},Lu.get());function o(){Zc().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}(e),n=new Su(e);return t.register("authEvent",t=>(al(t?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Hu,{type:Hu},n=>{const r=n?.[0]?.[Hu];void 0!==r&&t(!!r),nl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return vl(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Ru(e))return}catch{}nl(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ic()||Jl()||rc()}};var Wu="@firebase/auth",Ku="1.11.0";class Qu{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){al(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Yu=Hs("authIdTokenMaxAge")||300;let Ju=null;var Xu,Zu;Xu={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=rl("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},hc=Xu,Zu="Browser",Fa(new Do("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;al(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Zu,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sc(Zu)},l=new lc(n,r,i,a);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map($l);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Fa(new Do("auth-internal",e=>(e=>new Qu(e))(cc(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Ba(Wu,Ku,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Zu)),Ba(Wu,Ku,"esm2020");var eh,th,nh="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},rh={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"==typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,o=e.g[3];s=t+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[3]+3250441966&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[7]+4249261313&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[11]+2304563134&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[15]+1236535329&4294967295,s=t+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[11]+643717713&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[15]+3634488961&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[3]+4107603335&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[7]+1735328473&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function s(e){return-128<=e&&e<128?function(e){var t=i;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=function(e){return new r([0|e],e<0?-1:0)}(e)}(e):new r([0|e],e<0?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(e<0)return d(o(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function p(e,t){return e.add(d(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function f(e,t){if(u(t))throw Error("division by zero");if(u(e))return new g(a,a);if(h(e))return t=f(d(e),t),new g(d(t.g),d(t.h));if(h(t))return t=f(e,d(t)),new g(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=w(n,1),s=w(r,1);for(r=w(r,2),n=w(n,2);!u(r);){var c=s.add(r);c.l(e)<=0&&(i=i.add(n),s=c),r=w(r,1),n=w(n,1)}return t=p(e,i.j(t)),new g(i,t)}for(i=a;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(s=o(n)).j(t);h(c)||c.l(e)>0;)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=p(e,c)}return new g(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function w(e,t){const n=t>>5;t%=32;const i=e.g.length-n,s=[];for(let r=0;r<i;r++)s[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=o(Math.pow(e,6));var n=this;let r="";for(;;){const i=f(n,t).g;let s=(((n=p(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=p(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),s=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=s>>>16,t&=65535,s&=65535,n[r]=s<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(c)<0&&e.l(c)<0)return o(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,s=65535&this.i(i),o=e.i(t)>>>16,a=65535&e.i(t);n[2*i+2*t]+=s*a,m(n,2*i+2*t),n[2*i+2*t+1]+=r*a,m(n,2*i+2*t+1),n[2*i+2*t+1]+=s*o,m(n,2*i+2*t+1),n[2*i+2*t+2]+=r*o,m(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return f(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,th=rh.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=o(Math.pow(n,8));let i=a;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);const a=parseInt(t.substring(e,e+s),n);s<8?(s=o(Math.pow(n,s)),i=i.j(s).add(o(a))):(i=i.j(r),i=i.add(o(a)))}return i},eh=rh.Integer=r}).apply(void 0!==nh?nh:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ih,sh,oh,ah,lh,ch,uh,hh,dh="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ph={};(function(){var e,t=Object.defineProperty,n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof dh&&dh];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},s=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=a).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var h="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function p(e,t){for(let t=1;t<arguments.length;t++){const r=arguments[t];var n=typeof r;if("array"==(n="object"!=n?n:r?Array.isArray(r)?"array":n:"null")||"object"==n&&"number"==typeof r.length){n=e.length||0;const t=r.length||0;e.length=n+t;for(let i=0;i<t;i++)e[n+i]=r[i]}else e.push(r)}}function m(e){s.setTimeout(()=>{throw e},0)}function g(){var e=v;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var f=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let w,b=!1,v=new class{constructor(){this.h=this.g=null}add(e,t){const n=f.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},_=()=>{const e=Promise.resolve(void 0);w=()=>{e.then(x)}};function x(){for(var e;e=g();){try{e.h.call(e.g)}catch(e){m(e)}var t=f;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}b=!1}function k(){this.u=this.u,this.C=this.C}function C(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},C.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(e){}return e}();function E(e){return/^[\s\xa0]*$/.test(e)}function S(e,t){C.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(S,C),S.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&S.Z.h.call(this)},S.prototype.h=function(){S.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var I="closure_listenable_"+(1e6*Math.random()|0),T=0;function A(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++T,this.da=this.fa=!1}function P(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function R(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function N(e){const t={};for(const n in e)t[n]=e[n];return t}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<F.length;t++)n=F[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function M(e){this.src=e,this.g={},this.h=0}function L(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(P(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function U(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}M.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const o=U(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new A(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),j={};function V(e,t,n,r,i){if(r&&r.once)return z(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)V(e,t[s],n,r,i);return null}return n=Y(n),e&&e[I]?e.J(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!1,r,i)}function B(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const a=o(i)?!!i.capture:!!i;let l=K(e);if(l||(e[q]=l=new M(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){const e=W;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)D||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(G(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function z(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)z(e,t[s],n,r,i);return null}return n=Y(n),e&&e[I]?e.K(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!0,r,i)}function $(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)$(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=Y(n),e&&e[I]?(e=e.i,(s=String(t).toString())in e.g&&(n=U(t=e.g[s],n,r,i))>-1&&(P(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--))):e&&(e=K(e))&&(t=e.g[t.toString()],e=-1,t&&(e=U(t,n,r,i)),(n=e>-1?t[e]:null)&&H(n))}function H(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[I])L(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(G(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=K(t))?(L(n,e),0==n.h&&(n.src=null,t[q]=null)):P(e)}}}function G(e){return e in j?j[e]:j[e]="on"+e}function W(e,t){if(e.da)e=!0;else{t=new S(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&H(e),e=n.call(r,t)}return e}function K(e){return(e=e[q])instanceof M?e:null}var Q="__closure_events_fn_"+(1e9*Math.random()>>>0);function Y(e){return"function"==typeof e?e:(e[Q]||(e[Q]=function(t){return e.handleEvent(t)}),e[Q])}function J(){k.call(this),this.i=new M(this),this.M=this,this.G=null}function X(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new C(t,e);else if(t instanceof C)t.target=t.target||e;else{var i=t;O(t=new C(r,e),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=t.g=n[o],i=Z(s,r,!0,t)&&i;if(s=t.g=e,i=Z(s,r,!0,t)&&i,i=Z(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=Z(s,r,!1,t)&&i}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const o=t[s];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&L(e.i,o),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!=typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(J,k),J.prototype[I]=!0,J.prototype.removeEventListener=function(e,t,n,r){$(this,e,t,n,r)},J.prototype.N=function(){if(J.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)P(n[e]);delete e.g[t],e.h--}}this.G=null},J.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},J.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends k{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){k.call(this),this.h=e,this.g={}}u(ne,k);var re=[];function ie(e){R(e.g,function(e,t){this.g.hasOwnProperty(t)&&H(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var se=s.JSON.stringify,oe=s.JSON.parse,ae=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){C.call(this,"d")}function de(){C.call(this,"c")}u(he,C),u(de,C);var pe={},me=null;function ge(){return me=me||new J}function fe(e){C.call(this,pe.Ia,e)}function ye(e){const t=ge();X(t,new fe(t))}function we(e,t){C.call(this,pe.STAT_EVENT,e),this.stat=t}function be(e){const t=ge();X(t,new we(t,e))}function ve(e,t){C.call(this,pe.Ja,e),this.size=t}function _e(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function xe(){this.g=!0}function ke(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return se(s)}catch(e){return t}}(e,n)+(r?" "+r:"")})}pe.Ia="serverreachability",u(fe,C),pe.STAT_EVENT="statevent",u(we,C),pe.Ja="timingevent",u(ve,C),xe.prototype.ua=function(){this.g=!1},xe.prototype.info=function(){};var Ce,De={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ee={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Se(){}function Ie(e){return encodeURIComponent(String(e))}function Te(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ae(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pe}function Pe(){this.i=null,this.g="",this.h=!1}u(Se,le),Se.prototype.g=function(){return new XMLHttpRequest},Ce=new Se;var Re={},Ne={};function Fe(e,t,n){e.M=1,e.A=st(et(t)),e.u=n,e.R=!0,Oe(e,null)}function Oe(e,t){e.F=Date.now(),Ue(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),bt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Pe,e.g=on(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let e=0;e<i.length;e++){const s=V(n,i[e],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.J?N(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s){var o="",a=s.split("&");for(let e=0;e<a.length;e++){var l=a[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+l+"&":o+(e+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Me(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function Le(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ne:(n=Number(t.substring(n,r)),isNaN(n)?Re:(r+=1)+n>t.length?Ne:(t=t.slice(r,r+n),e.C=r+n,t))}function Ue(e){e.T=Date.now()+e.H,qe(e,e.H)}function qe(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=_e(l(e.aa,e),t)}function je(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ve(e){0==e.j.I||e.K||en(e.j,e)}function Be(e){je(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function ze(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Ke(n.h,e)))if(!e.L&&Ke(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zt(n),zt(n)}Yt(n),be(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=_e(l(n.Va,n),6e3));We(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&Zt(n),!E(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"==typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Qe(s,s.h),s.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=sn(r,r.L?r.ba:null,r.W),o.L){Ye(r.h,o);var a=o,c=r.O;c&&(a.H=c),a.D&&(je(a),Ue(a)),r.g=o}else Qt(r);n.i.length>0&&Ht(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):Bt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ye()}catch(e){}}Ae.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Ut(e)?t.j():this.Y(e)},Ae.prototype.Y=function(e){try{if(e==this.g)e:{const l=Ut(this.g),c=this.g.ya();if(this.g.ca(),!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||qt(this.g)))){this.K||4!=l||7==c||ye(),je(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Me(e))return e.g.la();const t=qt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Ut(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return Be(e),Ve(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(r)){var o=r;break t}}o=null}if(!(e=o)){this.o=!1,this.m=3,be(12),Be(this),Ve(this);break e}ke(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ze(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Le(this,n),t==Ne){4==l&&(this.m=4,be(14),e=!1),ke(this.i,this.l,null,"[Incomplete Response]");break}if(t==Re){this.m=4,be(15),ke(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}ke(this.i,this.l,t,null),ze(this,t)}if(Me(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,be(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jt(a),a.P=!0,be(11))}}else ke(this.i,this.l,n,"[Invalid Chunked Response]"),Be(this),Ve(this)}else ke(this.i,this.l,n,null),ze(this,n);4==l&&Be(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,Ue(this)))}else(function(e){const t={};e=(e.g&&Ut(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(E(e[r]))continue;var n=Te(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),Be(this),Ve(this)}}}catch(e){}},Ae.prototype.cancel=function(){this.K=!0,Be(this)},Ae.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),be(17)),Be(this),this.m=2,Ve(this)):qe(this,this.T-e)};var $e=class{constructor(e,t){this.g=e,this.map=t}};function He(e){this.l=e||10,e=s.PerformanceNavigationTiming?(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ge(e){return!!e.h||!!e.g&&e.g.size>=e.j}function We(e){return e.h?1:e.g?e.g.size:0}function Ke(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Qe(e,t){e.g?e.g.add(t):e.h=t}function Ye(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Je(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}He.prototype.cancel=function(){if(this.i=Je(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Xe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,vt(e.i)),this.m=e.m):e&&(t=String(e).match(Xe))?(this.l=!1,tt(this,t[1]||"",!0),this.o=ot(t[2]||""),this.g=ot(t[3]||"",!0),nt(this,t[4]),this.h=ot(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=ot(t[7]||"")):(this.l=!1,this.i=new mt(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?ot(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof mt?(e.i=t,function(e,t){t&&!e.j&&(gt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(ft(this,t),bt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=at(t,dt)),e.i=new mt(t,e.l))}function it(e,t,n){e.i.set(t,n)}function st(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ot(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function at(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(at(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(at(t,ct,!0),"@"),e.push(Ie(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(at(n,"/"==n.charAt(0)?ht:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",at(n,pt)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,vt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,ht=/[#\?]/g,dt=/[#\?@]/g,pt=/#/g;function mt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function gt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function ft(e,t){gt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return gt(e),t=_t(e,t),e.g.has(t)}function wt(e,t){gt(e);let n=[];if("string"==typeof t)yt(e,t)&&(n=n.concat(e.g.get(_t(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function bt(e,t,n){ft(e,t),n.length>0&&(e.i=null,e.g.set(_t(e,t),d(n)),e.h+=n.length)}function vt(e){const t=new mt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function xt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(e){}}function kt(){this.g=new ae}function Ct(e){this.i=e.Sb||null,this.h=e.ab||!1}function Dt(e,t){J.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Et(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function St(e){e.readyState=4,e.l=null,e.j=null,e.B=null,It(e)}function It(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Tt(e){let t="";return R(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function At(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Tt(n),"string"==typeof e?null!=n&&Ie(n):it(e,t,n))}function Pt(e){J.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=mt.prototype).add=function(e,t){gt(this),this.i=null,e=_t(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){gt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return gt(this),this.i=null,yt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=wt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ie(n);n=wt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ie(n[t])),e.push(r)}}return this.i=e.join("&")},u(Ct,le),Ct.prototype.g=function(){return new Dt(this.i,this.h)},u(Dt,J),(e=Dt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,It(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,St(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,It(this)),this.g&&(this.readyState=3,It(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Et(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?St(this):It(this),3==this.readyState&&Et(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,St(this))},e.Na=function(e){this.g&&(this.response=e,St(this))},e.ga=function(){this.g&&St(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Dt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Pt,J);var Rt=/^https?$/i,Nt=["POST","PUT"];function Ft(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Ot(e),Lt(e)}function Ot(e){e.A||(e.A=!0,X(e,"complete"),X(e,"error"))}function Mt(e){if(e.h&&void 0!==i)if(e.v&&4==Ut(e))setTimeout(e.Ca.bind(e),0);else if(X(e,"readystatechange"),4==Ut(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(Xe)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!Rt.test(t?t.toLowerCase():"")}n=r}if(n)X(e,"complete"),X(e,"success");else{e.o=6;try{var o=Ut(e)>2?e.g.statusText:""}catch(e){o=""}e.l=o+" ["+e.ca()+"]",Ot(e)}}finally{Lt(e)}}}function Lt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const n=e.g;e.g=null,t||X(e,"ready");try{n.onreadystatechange=null}catch(e){}}}function Ut(e){return e.g?e.g.readyState:0}function qt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function jt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Vt(e){this.za=0,this.i=[],this.j=new xe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jt("baseRetryDelayMs",5e3,e),this.Za=jt("retryDelaySeedMs",1e4,e),this.Ta=jt("forwardChannelMaxRetries",2,e),this.va=jt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new He(e&&e.concurrentRequestLimit),this.Ba=new kt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Bt(e){if($t(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),Wt(e,n),(t=new Ae(e,e.j,t)).M=2,t.A=st(et(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=on(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Ue(t)}rn(e)}function zt(e){e.g&&(Jt(e),e.g.cancel(),e.g=null)}function $t(e){zt(e),e.v&&(s.clearTimeout(e.v),e.v=null),Zt(e),e.h.cancel(),e.m&&("number"==typeof e.m&&s.clearTimeout(e.m),e.m=null)}function Ht(e){if(!Ge(e.h)&&!e.m){e.m=!0;var t=e.Ea;w||_(),b||(w(),b=!0),v.add(t,e),e.D=0}}function Gt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),Wt(e,r),e.u&&e.o&&At(r,e.u,e.o),n=new Ae(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Kt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Qe(e.h,n),Fe(n,r,t)}function Wt(e,t){e.H&&R(e.H,function(e,n){it(t,n,e)}),e.l&&R({},function(e,n){it(t,n,e)})}function Kt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var s=i[c].g;const n=i[c].map;if((s-=t)<0)t=Math.max(0,i[c].g-100),l=!1;else try{s="req"+s+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;o(n)&&(r=se(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(t){throw e.push(s+"type="+encodeURIComponent("_badmap")),t}}catch(e){r&&r(n)}}if(l){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function Qt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;w||_(),b||(w(),b=!0),v.add(t,e),e.A=0}}function Yt(e){return!(e.g||e.v||e.A>=3||(e.Y++,e.v=_e(l(e.Da,e),tn(e,e.A)),e.A++,0))}function Jt(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function Xt(e){e.g=new Ae(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),Wt(e,t),e.u&&e.o&&At(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=st(et(t)),n.u=null,n.R=!0,Oe(n,e)}function Zt(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){Zt(e),Jt(e),e.g=null;var r=2}else{if(!Ke(e.h,t))return;n=t.G,Ye(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;X(r=ge(),new ve(r,n)),Ht(e)}else Qt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(We(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.G.concat(e.i),0):1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta)||(e.m=_e(l(e.Ea,e,t),tn(e,e.D)),e.D++,0)))}(e,t)||2==r&&Yt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||tt(r,"https"),st(r),t?function(e,t){const n=new xe;if(s.Image){const r=new Image;r.onload=c(xt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(xt,n,"TestLoadImage: error",!1,t,r),r.onabort=c(xt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(xt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new xe;const n=new AbortController,r=setTimeout(()=>{n.abort(),xt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?xt(0,0,!0,t):xt(0,0,!1,t)}).catch(()=>{clearTimeout(r),xt(0,0,!1,t)})}(r.toString(),n)}else be(2);e.I=0,e.l&&e.l.pa(t),rn(e),$t(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Je(e.h);0==t.length&&0==e.i.length||(p(e.ja,t),p(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function sn(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),Wt(e,r),r}function on(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Pt(new Ct({ab:n})):new Pt(e.ma)).Fa(e.L),t}function an(){}function ln(){}function cn(e,t){J.call(this),this.g=new Vt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!E(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!E(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new dn(this)}function un(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hn(){de.call(this),this.status=1}function dn(e){this.g=e}(e=Pt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ce.g(),this.g.onreadystatechange=h(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void Ft(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Nt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ft(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,X(this,"complete"),X(this,"abort"),Lt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lt(this,!0)),Pt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Mt(this):this.Xa())},e.Xa=function(){Mt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Ut(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),oe(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Vt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){be(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=sn(this,null,this.W),Ht(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Ae(this,this.j,e);let s=this.o;if(this.U&&(s?(s=N(s),O(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Kt(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),Wt(this,n),s&&(this.R?t="headers="+Ie(Tt(s))+"&"+t:this.u&&At(n,this.u,s)),Qe(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,Fe(i,n,null)):Fe(i,n,t),this.I=2}}else 3==this.I&&(e?Gt(this,e):0==this.i.length||Ge(this.h)||Gt(this))},e.Da=function(){if(this.v=null,Xt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=_e(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),zt(this),Xt(this))},e.Va=function(){null!=this.C&&(this.C=null,zt(this),Yt(this),be(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=an.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new cn(e,t)},u(cn,J),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Bt(this.g)},cn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=se(e),e=n);t.i.push(new $e(t.Ya++,e)),3==t.I&&Ht(t)},cn.prototype.N=function(){this.g.l=null,delete this.j,Bt(this.g),delete this.g,cn.Z.N.call(this)},u(un,he),u(hn,de),u(dn,an),dn.prototype.ra=function(){X(this.g,"a")},dn.prototype.qa=function(e){X(this.g,new un(e))},dn.prototype.pa=function(e){X(this.g,new hn)},dn.prototype.oa=function(){X(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,hh=ph.createWebChannelTransport=function(){return new ln},uh=ph.getStatEventTarget=function(){return ge()},ch=ph.Event=pe,lh=ph.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},De.NO_ERROR=0,De.TIMEOUT=8,De.HTTP_ERROR=6,ah=ph.ErrorCode=De,Ee.COMPLETE="complete",oh=ph.EventType=Ee,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",J.prototype.listen=J.prototype.J,sh=ph.WebChannel=ce,ph.FetchXmlHttpFactory=Ct,Pt.prototype.listenOnce=Pt.prototype.K,Pt.prototype.getLastError=Pt.prototype.Ha,Pt.prototype.getLastErrorCode=Pt.prototype.ya,Pt.prototype.getStatus=Pt.prototype.ca,Pt.prototype.getResponseJson=Pt.prototype.La,Pt.prototype.getResponseText=Pt.prototype.la,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Fa,ih=ph.XhrIo=Pt}).apply(void 0!==dh?dh:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const mh="@firebase/firestore",gh="4.9.2";class fh{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fh.UNAUTHENTICATED=new fh(null),fh.GOOGLE_CREDENTIALS=new fh("google-credentials-uid"),fh.FIRST_PARTY=new fh("first-party-uid"),fh.MOCK_USER=new fh("mock-user");let yh="12.3.0";const wh=new Oo("@firebase/firestore");function bh(){return wh.logLevel}function vh(e,...t){if(wh.logLevel<=Ao.DEBUG){const n=t.map(kh);wh.debug(`Firestore (${yh}): ${e}`,...n)}}function _h(e,...t){if(wh.logLevel<=Ao.ERROR){const n=t.map(kh);wh.error(`Firestore (${yh}): ${e}`,...n)}}function xh(e,...t){if(wh.logLevel<=Ao.WARN){const n=t.map(kh);wh.warn(`Firestore (${yh}): ${e}`,...n)}}function kh(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ch(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Dh(e,r,n)}function Dh(e,t,n){let r=`FIRESTORE (${yh}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw _h(r),new Error(r)}function Eh(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Dh(t,i,r)}function Sh(e,t){return e}const Ih={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Th extends ro{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ah{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Ph{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rh{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(fh.UNAUTHENTICATED))}shutdown(){}}class Nh{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Fh{constructor(e){this.t=e,this.currentUser=fh.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Eh(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Ah;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ah,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{vh("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(vh("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ah)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(vh("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Eh("string"==typeof t.accessToken,31837,{l:t}),new Ph(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Eh(null===e||"string"==typeof e,2055,{h:e}),new fh(e)}}class Oh{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=fh.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Mh{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Oh(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(fh.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Lh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Uh{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ma(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Eh(void 0===this.o,3512);const n=e=>{null!=e.error&&vh("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,vh("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{vh("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):vh("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Lh(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Eh("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Lh(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function qh(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class jh{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=qh(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Vh(e,t){return e<t?-1:e>t?1:0}function Bh(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Hh(n)===Hh(i)?Vh(n,i):Hh(n)?1:-1}return Vh(e.length,t.length)}const zh=55296,$h=57343;function Hh(e){const t=e.charCodeAt(0);return t>=zh&&t<=$h}function Gh(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Wh="__name__";class Kh{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ch(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Ch(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Kh.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Kh?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Kh.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Vh(e.length,t.length)}static compareSegments(e,t){const n=Kh.isNumericId(e),r=Kh.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Kh.extractNumericId(e).compare(Kh.extractNumericId(t)):Bh(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return eh.fromString(e.substring(4,e.length-2))}}class Qh extends Kh{construct(e,t,n){return new Qh(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Th(Ih.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new Qh(t)}static emptyPath(){return new Qh([])}}const Yh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jh extends Kh{construct(e,t,n){return new Jh(e,t,n)}static isValidIdentifier(e){return Yh.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jh.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Wh}static keyField(){return new Jh([Wh])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Th(Ih.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Th(Ih.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Th(Ih.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Th(Ih.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jh(t)}static emptyPath(){return new Jh([])}}class Xh{constructor(e){this.path=e}static fromPath(e){return new Xh(Qh.fromString(e))}static fromName(e){return new Xh(Qh.fromString(e).popFirst(5))}static empty(){return new Xh(Qh.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Qh.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Qh.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xh(new Qh(e.slice()))}}function Zh(e,t,n){if(!n)throw new Th(Ih.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ed(e){if(!Xh.isDocumentKey(e))throw new Th(Ih.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function td(e){if(Xh.isDocumentKey(e))throw new Th(Ih.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function nd(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function rd(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Ch(12329,{type:typeof e})}function id(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Th(Ih.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rd(e);throw new Th(Ih.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function sd(e,t){const n={typeString:e};return t&&(n.value=t),n}function od(e,t){if(!nd(e))throw new Th(Ih.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Th(Ih.INVALID_ARGUMENT,n);return!0}const ad=-62135596800,ld=1e6;class cd{static now(){return cd.fromMillis(Date.now())}static fromDate(e){return cd.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ld);return new cd(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Th(Ih.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Th(Ih.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ad)throw new Th(Ih.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Th(Ih.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ld}_compareTo(e){return this.seconds===e.seconds?Vh(this.nanoseconds,e.nanoseconds):Vh(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:cd._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(od(e,cd._jsonSchema))return new cd(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ad;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}cd._jsonSchemaVersion="firestore/timestamp/1.0",cd._jsonSchema={type:sd("string",cd._jsonSchemaVersion),seconds:sd("number"),nanoseconds:sd("number")};class ud{static fromTimestamp(e){return new ud(e)}static min(){return new ud(new cd(0,0))}static max(){return new ud(new cd(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function hd(e){return new dd(e.readTime,e.key,-1)}class dd{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new dd(ud.min(),Xh.empty(),-1)}static max(){return new dd(ud.max(),Xh.empty(),-1)}}function pd(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Xh.comparator(e.documentKey,t.documentKey),0!==n?n:Vh(e.largestBatchId,t.largestBatchId))}class md{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function gd(e){if(e.code!==Ih.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;vh("LocalStore","Unexpectedly lost primary lease")}class fd{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ch(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fd((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof fd?t:fd.resolve(t)}catch(e){return fd.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):fd.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):fd.reject(t)}static resolve(e){return new fd((t,n)=>{t(e)})}static reject(e){return new fd((t,n)=>{n(e)})}static waitFor(e){return new fd((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=fd.resolve(!1);for(const n of e)t=t.next(e=>e?fd.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new fd((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new fd((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function yd(e){return"IndexedDbTransactionError"===e.name}class wd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wd.ce=-1;function bd(e){return null==e}function vd(e){return 0===e&&1/e==-1/0}function _d(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function xd(e){return e+""}const kd="owner",Cd="mutationQueues",Dd="mutations",Ed="documentMutations",Sd="remoteDocumentGlobal",Id="targets",Td="targetDocuments",Ad="targetGlobal",Pd="collectionParents",Rd="clientMetadata",Nd="bundles",Fd="namedQueries";function Od(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Md(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ld(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ud{constructor(e,t){this.comparator=e,this.root=t||jd.EMPTY}insert(e,t){return new Ud(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,jd.BLACK,null,null))}remove(e){return new Ud(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jd.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qd(this.root,e,this.comparator,!0)}}class qd{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jd{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:jd.RED,this.left=null!=r?r:jd.EMPTY,this.right=null!=i?i:jd.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new jd(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jd.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return jd.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jd.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jd.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ch(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ch(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ch(27949);return e+(this.isRed()?0:1)}}jd.EMPTY=null,jd.RED=!0,jd.BLACK=!1,jd.EMPTY=new class{constructor(){this.size=0}get key(){throw Ch(57766)}get value(){throw Ch(16141)}get color(){throw Ch(16727)}get left(){throw Ch(29726)}get right(){throw Ch(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new jd(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vd{constructor(e){this.comparator=e,this.data=new Ud(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bd(this.data.getIterator())}getIteratorFrom(e){return new Bd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Vd))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Vd(this.comparator);return t.data=e,t}}class Bd{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class zd{constructor(e){this.fields=e,e.sort(Jh.comparator)}static empty(){return new zd([])}unionWith(e){let t=new Vd(Jh.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new zd(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gh(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class $d extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hd{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new $d("Invalid base64 string: "+e):e}}(e);return new Hd(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Hd(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vh(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hd.EMPTY_BYTE_STRING=new Hd("");const Gd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wd(e){if(Eh(!!e,39018),"string"==typeof e){let t=0;const n=Gd.exec(e);if(Eh(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Kd(e.seconds),nanos:Kd(e.nanos)}}function Kd(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Qd(e){return"string"==typeof e?Hd.fromBase64String(e):Hd.fromUint8Array(e)}const Yd="server_timestamp",Jd="__type__",Xd="__previous_value__",Zd="__local_write_time__";function ep(e){const t=(e?.mapValue?.fields||{})[Jd]?.stringValue;return t===Yd}function tp(e){const t=e.mapValue.fields[Xd];return ep(t)?tp(t):t}function np(e){const t=Wd(e.mapValue.fields[Zd].timestampValue);return new cd(t.seconds,t.nanos)}class rp{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const ip="(default)";class sp{constructor(e,t){this.projectId=e,this.database=t||ip}static empty(){return new sp("","")}get isDefaultDatabase(){return this.database===ip}isEqual(e){return e instanceof sp&&e.projectId===this.projectId&&e.database===this.database}}const op="__type__",ap="__max__",lp={fields:{__type__:{stringValue:ap}}},cp="__vector__",up="value";function hp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ep(e)?4:Sp(e)?9007199254740991:Dp(e)?10:11:Ch(28295,{value:e})}function dp(e,t){if(e===t)return!0;const n=hp(e);if(n!==hp(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return np(e).isEqual(np(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Wd(e.timestampValue),r=Wd(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Qd(e.bytesValue).isEqual(Qd(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Kd(e.geoPointValue.latitude)===Kd(t.geoPointValue.latitude)&&Kd(e.geoPointValue.longitude)===Kd(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Kd(e.integerValue)===Kd(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Kd(e.doubleValue),r=Kd(t.doubleValue);return n===r?vd(n)===vd(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Gh(e.arrayValue.values||[],t.arrayValue.values||[],dp);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Od(n)!==Od(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!dp(n[e],r[e])))return!1;return!0}(e,t);default:return Ch(52216,{left:e})}}function pp(e,t){return void 0!==(e.values||[]).find(e=>dp(e,t))}function mp(e,t){if(e===t)return 0;const n=hp(e),r=hp(t);if(n!==r)return Vh(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Vh(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Kd(e.integerValue||e.doubleValue),r=Kd(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return gp(e.timestampValue,t.timestampValue);case 4:return gp(np(e),np(t));case 5:return Bh(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Qd(e),r=Qd(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=Vh(n[e],r[e]);if(0!==t)return t}return Vh(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Vh(Kd(e.latitude),Kd(t.latitude));return 0!==n?n:Vh(Kd(e.longitude),Kd(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return fp(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},i=n[up]?.arrayValue,s=r[up]?.arrayValue,o=Vh(i?.values?.length||0,s?.values?.length||0);return 0!==o?o:fp(i,s)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===lp&&t===lp)return 0;if(e===lp)return 1;if(t===lp)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=Bh(r[e],s[e]);if(0!==t)return t;const o=mp(n[r[e]],i[s[e]]);if(0!==o)return o}return Vh(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Ch(23264,{he:n})}}function gp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Vh(e,t);const n=Wd(e),r=Wd(t),i=Vh(n.seconds,r.seconds);return 0!==i?i:Vh(n.nanos,r.nanos)}function fp(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=mp(n[e],r[e]);if(t)return t}return Vh(n.length,r.length)}function yp(e){return wp(e)}function wp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Wd(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Qd(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Xh.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=wp(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${wp(e.fields[i])}`;return n+"}"}(e.mapValue):Ch(61005,{value:e})}function bp(e){switch(hp(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=tp(e);return t?16+bp(t):16;case 5:return 2*e.stringValue.length;case 6:return Qd(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+bp(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Md(e.fields,(e,n)=>{t+=e.length+bp(n)}),t}(e.mapValue);default:throw Ch(13486,{value:e})}}function vp(e){return!!e&&"integerValue"in e}function _p(e){return!!e&&"arrayValue"in e}function xp(e){return!!e&&"nullValue"in e}function kp(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Cp(e){return!!e&&"mapValue"in e}function Dp(e){const t=(e?.mapValue?.fields||{})[op]?.stringValue;return t===cp}function Ep(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Md(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ep(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ep(e.arrayValue.values[n]);return t}return{...e}}function Sp(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ap}class Ip{constructor(e){this.value=e}static empty(){return new Ip({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Cp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ep(t)}setAll(e){let t=Jh.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ep(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Cp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dp(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Cp(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Md(t,(t,n)=>e[t]=n);for(const t of n)delete e[t]}clone(){return new Ip(Ep(this.value))}}function Tp(e){const t=[];return Md(e.fields,(e,n)=>{const r=new Jh([e]);if(Cp(n)){const e=Tp(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new zd(t)}class Ap{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ap(e,0,ud.min(),ud.min(),ud.min(),Ip.empty(),0)}static newFoundDocument(e,t,n,r){return new Ap(e,1,t,ud.min(),n,r,0)}static newNoDocument(e,t){return new Ap(e,2,t,ud.min(),ud.min(),Ip.empty(),0)}static newUnknownDocument(e,t){return new Ap(e,3,t,ud.min(),ud.min(),Ip.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ud.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ip.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ip.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ud.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ap&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ap(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pp{constructor(e,t){this.position=e,this.inclusive=t}}function Rp(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Xh.comparator(Xh.fromName(o.referenceValue),n.key):mp(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Np(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!dp(e.position[n],t.position[n]))return!1;return!0}class Fp{constructor(e,t="asc"){this.field=e,this.dir=t}}function Op(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Mp{}class Lp extends Mp{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new $p(e,t,n):"array-contains"===t?new Kp(e,n):"in"===t?new Qp(e,n):"not-in"===t?new Yp(e,n):"array-contains-any"===t?new Jp(e,n):new Lp(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Hp(e,n):new Gp(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(mp(t,this.value)):null!==t&&hp(this.value)===hp(t)&&this.matchesComparison(mp(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ch(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Up extends Mp{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Up(e,t)}matches(e){return qp(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qp(e){return"and"===e.op}function jp(e){return function(e){for(const t of e.filters)if(t instanceof Up)return!1;return!0}(e)&&qp(e)}function Vp(e){if(e instanceof Lp)return e.field.canonicalString()+e.op.toString()+yp(e.value);if(jp(e))return e.filters.map(e=>Vp(e)).join(",");{const t=e.filters.map(e=>Vp(e)).join(",");return`${e.op}(${t})`}}function Bp(e,t){return e instanceof Lp?function(e,t){return t instanceof Lp&&e.op===t.op&&e.field.isEqual(t.field)&&dp(e.value,t.value)}(e,t):e instanceof Up?function(e,t){return t instanceof Up&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Bp(n,t.filters[r]),!0)}(e,t):void Ch(19439)}function zp(e){return e instanceof Lp?function(e){return`${e.field.canonicalString()} ${e.op} ${yp(e.value)}`}(e):e instanceof Up?function(e){return e.op.toString()+" {"+e.getFilters().map(zp).join(" ,")+"}"}(e):"Filter"}class $p extends Lp{constructor(e,t,n){super(e,t,n),this.key=Xh.fromName(n.referenceValue)}matches(e){const t=Xh.comparator(e.key,this.key);return this.matchesComparison(t)}}class Hp extends Lp{constructor(e,t){super(e,"in",t),this.keys=Wp(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Gp extends Lp{constructor(e,t){super(e,"not-in",t),this.keys=Wp(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Wp(e,t){return(t.arrayValue?.values||[]).map(e=>Xh.fromName(e.referenceValue))}class Kp extends Lp{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return _p(t)&&pp(t.arrayValue,this.value)}}class Qp extends Lp{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&pp(this.value.arrayValue,t)}}class Yp extends Lp{constructor(e,t){super(e,"not-in",t)}matches(e){if(pp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!pp(this.value.arrayValue,t)}}class Jp extends Lp{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!_p(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>pp(this.value.arrayValue,e))}}class Xp{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function Zp(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Xp(e,t,n,r,i,s,o)}function em(e){const t=Sh(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Vp(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),bd(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>yp(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>yp(e)).join(",")),t.Te=e}return t.Te}function tm(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Op(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Bp(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Np(e.startAt,t.startAt)&&Np(e.endAt,t.endAt)}function nm(e){return Xh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class rm{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function im(e){return new rm(e)}function sm(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function om(e){const t=Sh(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Vd(Jh.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Fp(r,n))}),e.has(Jh.keyField().canonicalString())||t.Ie.push(new Fp(Jh.keyField(),n))}return t.Ie}function am(e){const t=Sh(e);return t.Ee||(t.Ee=function(e,t){if("F"===e.limitType)return Zp(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Fp(e.field,t)});const n=e.endAt?new Pp(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Pp(e.startAt.position,e.startAt.inclusive):null;return Zp(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,om(e))),t.Ee}function lm(e,t,n){return new rm(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function cm(e,t){return tm(am(e),am(t))&&e.limitType===t.limitType}function um(e){return`${em(am(e))}|lt:${e.limitType}`}function hm(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>zp(e)).join(", ")}]`),bd(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>yp(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>yp(e)).join(",")),`Target(${t})`}(am(e))}; limitType=${e.limitType})`}function dm(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Xh.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of om(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Rp(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,om(e),t)||e.endAt&&!function(e,t,n){const r=Rp(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,om(e),t))}(e,t)}function pm(e){return(t,n)=>{let r=!1;for(const i of om(e)){const e=mm(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function mm(e,t,n){const r=e.field.isKeyField()?Xh.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?mp(r,i):Ch(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ch(19790,{direction:e.dir})}}class gm{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Md(this.inner,(t,n)=>{for(const[t,r]of n)e(t,r)})}isEmpty(){return Ld(this.inner)}size(){return this.innerSize}}const fm=new Ud(Xh.comparator);function ym(){return fm}const wm=new Ud(Xh.comparator);function bm(...e){let t=wm;for(const n of e)t=t.insert(n.key,n);return t}function vm(e){let t=wm;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function _m(){return km()}function xm(){return km()}function km(){return new gm(e=>e.toString(),(e,t)=>e.isEqual(t))}const Cm=new Ud(Xh.comparator),Dm=new Vd(Xh.comparator);function Em(...e){let t=Dm;for(const n of e)t=t.add(n);return t}const Sm=new Vd(Vh);function Im(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vd(t)?"-0":t}}function Tm(e){return{integerValue:""+e}}function Am(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!vd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Tm(t):Im(e,t)}class Pm{constructor(){this._=void 0}}function Rm(e,t,n){return e instanceof Om?function(e,t){const n={fields:{[Jd]:{stringValue:Yd},[Zd]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ep(t)&&(t=tp(t)),t&&(n.fields[Xd]=t),{mapValue:n}}(n,t):e instanceof Mm?Lm(e,t):e instanceof Um?qm(e,t):function(e,t){const n=Fm(e,t),r=Vm(n)+Vm(e.Ae);return vp(n)&&vp(e.Ae)?Tm(r):Im(e.serializer,r)}(e,t)}function Nm(e,t,n){return e instanceof Mm?Lm(e,t):e instanceof Um?qm(e,t):n}function Fm(e,t){return e instanceof jm?function(e){return vp(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Om extends Pm{}class Mm extends Pm{constructor(e){super(),this.elements=e}}function Lm(e,t){const n=Bm(t);for(const t of e.elements)n.some(e=>dp(e,t))||n.push(t);return{arrayValue:{values:n}}}class Um extends Pm{constructor(e){super(),this.elements=e}}function qm(e,t){let n=Bm(t);for(const t of e.elements)n=n.filter(e=>!dp(e,t));return{arrayValue:{values:n}}}class jm extends Pm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Vm(e){return Kd(e.integerValue||e.doubleValue)}function Bm(e){return _p(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class zm{constructor(e,t){this.field=e,this.transform=t}}class $m{constructor(e,t){this.version=e,this.transformResults=t}}class Hm{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Hm}static exists(e){return new Hm(void 0,e)}static updateTime(e){return new Hm(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gm(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Wm{}function Km(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ig(e.key,Hm.none()):new Zm(e.key,e.data,Hm.none());{const n=e.data,r=Ip.empty();let i=new Vd(Jh.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new eg(e.key,r,new zd(i.toArray()),Hm.none())}}function Qm(e,t,n){e instanceof Zm?function(e,t,n){const r=e.value.clone(),i=ng(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof eg?function(e,t,n){if(!Gm(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=ng(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(tg(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ym(e,t,n,r){return e instanceof Zm?function(e,t,n,r){if(!Gm(e.precondition,t))return n;const i=e.value.clone(),s=rg(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof eg?function(e,t,n,r){if(!Gm(e.precondition,t))return n;const i=rg(e.fieldTransforms,r,t),s=t.data;return s.setAll(tg(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Gm(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Jm(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Fm(r.transform,e||null);null!=i&&(null===n&&(n=Ip.empty()),n.set(r.field,i))}return n||null}function Xm(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Gh(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Mm&&t instanceof Mm||e instanceof Um&&t instanceof Um?Gh(e.elements,t.elements,dp):e instanceof jm&&t instanceof jm?dp(e.Ae,t.Ae):e instanceof Om&&t instanceof Om}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Zm extends Wm{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class eg extends Wm{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tg(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function ng(e,t,n){const r=new Map;Eh(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Nm(o,a,n[i]))}return r}function rg(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Rm(e,s,t))}return r}class ig extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sg extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class og{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&Qm(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ym(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ym(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=xm();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Km(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(ud.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Em())}isEqual(e){return this.batchId===e.batchId&&Gh(this.mutations,e.mutations,(e,t)=>Xm(e,t))&&Gh(this.baseMutations,e.baseMutations,(e,t)=>Xm(e,t))}}class ag{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Eh(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Cm;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new ag(e,t,n,r)}}class lg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class cg{constructor(e,t){this.count=e,this.unchangedNames=t}}var ug,hg;function dg(e){if(void 0===e)return _h("GRPC error has no .code"),Ih.UNKNOWN;switch(e){case ug.OK:return Ih.OK;case ug.CANCELLED:return Ih.CANCELLED;case ug.UNKNOWN:return Ih.UNKNOWN;case ug.DEADLINE_EXCEEDED:return Ih.DEADLINE_EXCEEDED;case ug.RESOURCE_EXHAUSTED:return Ih.RESOURCE_EXHAUSTED;case ug.INTERNAL:return Ih.INTERNAL;case ug.UNAVAILABLE:return Ih.UNAVAILABLE;case ug.UNAUTHENTICATED:return Ih.UNAUTHENTICATED;case ug.INVALID_ARGUMENT:return Ih.INVALID_ARGUMENT;case ug.NOT_FOUND:return Ih.NOT_FOUND;case ug.ALREADY_EXISTS:return Ih.ALREADY_EXISTS;case ug.PERMISSION_DENIED:return Ih.PERMISSION_DENIED;case ug.FAILED_PRECONDITION:return Ih.FAILED_PRECONDITION;case ug.ABORTED:return Ih.ABORTED;case ug.OUT_OF_RANGE:return Ih.OUT_OF_RANGE;case ug.UNIMPLEMENTED:return Ih.UNIMPLEMENTED;case ug.DATA_LOSS:return Ih.DATA_LOSS;default:return Ch(39323,{code:e})}}(hg=ug||(ug={}))[hg.OK=0]="OK",hg[hg.CANCELLED=1]="CANCELLED",hg[hg.UNKNOWN=2]="UNKNOWN",hg[hg.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hg[hg.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hg[hg.NOT_FOUND=5]="NOT_FOUND",hg[hg.ALREADY_EXISTS=6]="ALREADY_EXISTS",hg[hg.PERMISSION_DENIED=7]="PERMISSION_DENIED",hg[hg.UNAUTHENTICATED=16]="UNAUTHENTICATED",hg[hg.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hg[hg.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hg[hg.ABORTED=10]="ABORTED",hg[hg.OUT_OF_RANGE=11]="OUT_OF_RANGE",hg[hg.UNIMPLEMENTED=12]="UNIMPLEMENTED",hg[hg.INTERNAL=13]="INTERNAL",hg[hg.UNAVAILABLE=14]="UNAVAILABLE",hg[hg.DATA_LOSS=15]="DATA_LOSS";const pg=new eh([4294967295,4294967295],0);function mg(e){const t=(new TextEncoder).encode(e),n=new th;return n.update(t),new Uint8Array(n.digest())}function gg(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new eh([n,r],0),new eh([i,s],0)]}class fg{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new yg(`Invalid padding: ${t}`);if(n<0)throw new yg(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new yg(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new yg(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=eh.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(eh.fromNumber(n)));return 1===r.compare(pg)&&(r=new eh([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=mg(e),[n,r]=gg(t);for(let e=0;e<this.hashCount;e++){const t=this.ye(n,r,e);if(!this.we(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new fg(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=mg(e),[n,r]=gg(t);for(let e=0;e<this.hashCount;e++){const t=this.ye(n,r,e);this.Se(t)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class yg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wg{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,bg.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new wg(ud.min(),r,new Ud(Vh),ym(),Em())}}class bg{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new bg(n,t,Em(),Em(),Em())}}class vg{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class _g{constructor(e,t){this.targetId=e,this.Ce=t}}class xg{constructor(e,t,n=Hd.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class kg{constructor(){this.ve=0,this.Fe=Eg(),this.Me=Hd.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Em(),t=Em(),n=Em();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ch(38017,{changeType:i})}}),new bg(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Eg()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Eh(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Cg{constructor(e){this.Ge=e,this.ze=new Map,this.je=ym(),this.Je=Dg(),this.He=Dg(),this.Ye=new Ud(Vh)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ch(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(nm(i))if(0===n){const e=new Xh(i.path);this.et(t,e,Ap.newNoDocument(e,ud.min()))}else Eh(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),i=n?this.ct(n,e,r):1;if(0!==i){this.it(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Qd(n).toUint8Array()}catch(e){if(e instanceof $d)return xh("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new fg(s,r,i)}catch(e){return xh(e instanceof yg?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&nm(i.target)){const t=new Xh(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Ap.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Em();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new wg(e,t,this.Ye,this.je,n);return this.je=ym(),this.Je=Dg(),this.He=Dg(),this.Ye=new Ud(Vh),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new kg,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Vd(Vh),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Vd(Vh),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||vh("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kg),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Dg(){return new Ud(Xh.comparator)}function Eg(){return new Ud(Xh.comparator)}const Sg={asc:"ASCENDING",desc:"DESCENDING"},Ig={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Tg={and:"AND",or:"OR"};class Ag{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Pg(e,t){return e.useProto3Json||bd(t)?t:{value:t}}function Rg(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ng(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Fg(e,t){return Rg(e,t.toTimestamp())}function Og(e){return Eh(!!e,49232),ud.fromTimestamp(function(e){const t=Wd(e);return new cd(t.seconds,t.nanos)}(e))}function Mg(e,t){return Lg(e,t).canonicalString()}function Lg(e,t){const n=function(e){return new Qh(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Ug(e){const t=Qh.fromString(e);return Eh(nf(t),10190,{key:t.toString()}),t}function qg(e,t){return Mg(e.databaseId,t.path)}function jg(e,t){const n=Ug(t);if(n.get(1)!==e.databaseId.projectId)throw new Th(Ih.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Th(Ih.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Xh(zg(n))}function Vg(e,t){return Mg(e.databaseId,t)}function Bg(e){return new Qh(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function zg(e){return Eh(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function $g(e,t,n){return{name:qg(e,t),fields:n.value.mapValue.fields}}function Hg(e,t){return{documents:[Vg(e,t.path)]}}function Gg(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Vg(e,i);const s=function(e){if(0!==e.length)return ef(Up.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Xg(e.field),direction:Qg(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Pg(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Wg(e){let t=function(e){const t=Ug(e);return 4===t.length?Qh.emptyPath():zg(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Eh(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Kg(e);return t instanceof Up&&jp(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new Fp(Zg(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,bd(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Pp(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Pp(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new rm(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",l,c)}function Kg(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Zg(e.unaryFilter.field);return Lp.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Zg(e.unaryFilter.field);return Lp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Zg(e.unaryFilter.field);return Lp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Zg(e.unaryFilter.field);return Lp.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ch(61313);default:return Ch(60726)}}(e):void 0!==e.fieldFilter?function(e){return Lp.create(Zg(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ch(58110);default:return Ch(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Up.create(e.compositeFilter.filters.map(e=>Kg(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ch(1026)}}(e.compositeFilter.op))}(e):Ch(30097,{filter:e})}function Qg(e){return Sg[e]}function Yg(e){return Ig[e]}function Jg(e){return Tg[e]}function Xg(e){return{fieldPath:e.canonicalString()}}function Zg(e){return Jh.fromServerFormat(e.fieldPath)}function ef(e){return e instanceof Lp?function(e){if("=="===e.op){if(kp(e.value))return{unaryFilter:{field:Xg(e.field),op:"IS_NAN"}};if(xp(e.value))return{unaryFilter:{field:Xg(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(kp(e.value))return{unaryFilter:{field:Xg(e.field),op:"IS_NOT_NAN"}};if(xp(e.value))return{unaryFilter:{field:Xg(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xg(e.field),op:Yg(e.op),value:e.value}}}(e):e instanceof Up?function(e){const t=e.getFilters().map(e=>ef(e));return 1===t.length?t[0]:{compositeFilter:{op:Jg(e.op),filters:t}}}(e):Ch(54877,{filter:e})}function tf(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function nf(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class rf{constructor(e,t,n,r,i=ud.min(),s=ud.min(),o=Hd.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new rf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class sf{constructor(e){this.yt=e}}function of(e){const t=Wg({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?lm(t,t.limit,"L"):t}class af{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Kd(e.integerValue));else if("doubleValue"in e){const n=Kd(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),vd(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Wd(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Qd(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Sp(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Dp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ch(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=up,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Kd(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),Xh.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}af.Kt=new af;class lf{constructor(){this.Cn=new cf}addToCollectionParentIndex(e,t){return this.Cn.add(t),fd.resolve()}getCollectionParents(e,t){return fd.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return fd.resolve()}deleteFieldIndex(e,t){return fd.resolve()}deleteAllFieldIndexes(e){return fd.resolve()}createTargetIndexes(e,t){return fd.resolve()}getDocumentsMatchingTarget(e,t){return fd.resolve(null)}getIndexType(e,t){return fd.resolve(0)}getFieldIndexes(e,t){return fd.resolve([])}getNextCollectionGroupToUpdate(e){return fd.resolve(null)}getMinOffset(e,t){return fd.resolve(dd.min())}getMinOffsetFromCollectionGroup(e,t){return fd.resolve(dd.min())}updateCollectionGroup(e,t,n){return fd.resolve()}updateIndexEntries(e,t){return fd.resolve()}}class cf{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Vd(Qh.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Vd(Qh.comparator)).toArray()}}new Uint8Array(0);const uf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hf=41943040;class df{static withCacheSize(e){return new df(e,df.DEFAULT_COLLECTION_PERCENTILE,df.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}df.DEFAULT_COLLECTION_PERCENTILE=10,df.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,df.DEFAULT=new df(hf,df.DEFAULT_COLLECTION_PERCENTILE,df.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),df.DISABLED=new df(-1,0,0);class pf{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new pf(0)}static cr(){return new pf(-1)}}const mf="LruGarbageCollector";function gf([e,t],[n,r]){const i=Vh(e,n);return 0===i?Vh(t,r):i}class ff{constructor(e){this.Ir=e,this.buffer=new Vd(gf),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();gf(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class yf{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){vh(mf,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){yd(e)?vh(mf,"Ignoring IndexedDB error during garbage collection: ",e):await gd(e)}await this.Vr(3e5)})}}class wf{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return fd.resolve(wd.ce);const n=new ff(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(vh("LruGarbageCollector","Garbage collection skipped; disabled"),fd.resolve(uf)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(vh("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uf):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(vh("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),bh()<=Ao.DEBUG&&vh("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),fd.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}class bf{constructor(){this.changes=new gm(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ap.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?fd.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vf{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class _f{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Ym(n.mutation,e,zd.empty(),cd.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Em()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Em()){const r=_m();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=bm();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=_m();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Em()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=ym();const s=km(),o=km();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof eg)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Ym(o.mutation,t,o.mutation.getFieldMask(),cd.now())):s.set(t.key,zd.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>o.set(e,new vf(t,s.get(e)??null))),o))}recalculateAndSaveOverlays(e,t){const n=km();let r=new Ud((e,t)=>e-t),i=Em();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||zd.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Em()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=xm();l.forEach(e=>{if(!i.has(e)){const r=Km(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return fd.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Xh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):fd.resolve(_m());let o=-1,a=i;return s.next(t=>fd.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?fd.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Em())).next(e=>({batchId:o,changes:vm(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xh(t)).next(e=>{let t=bm();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=bm();return this.indexManager.getCollectionParents(e,i).next(o=>fd.forEach(o,o=>{const a=function(e,t){return new rm(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ap.newInvalidDocument(r)))});let n=bm();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&Ym(s.mutation,r,zd.empty(),cd.now()),dm(t,r)&&(n=n.insert(e,r))}),n})}}class xf{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return fd.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Og(e.createTime)}}(t)),fd.resolve()}getNamedQuery(e,t){return fd.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:of(e.bundledQuery),readTime:Og(e.readTime)}}(t)),fd.resolve()}}class kf{constructor(){this.overlays=new Ud(Xh.comparator),this.qr=new Map}getOverlay(e,t){return fd.resolve(this.overlays.get(t))}getOverlays(e,t){const n=_m();return fd.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),fd.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),fd.resolve()}getOverlaysForCollection(e,t,n){const r=_m(),i=t.length+1,s=new Xh(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return fd.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ud((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=_m(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=_m(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return fd.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new lg(t,n));let i=this.qr.get(t);void 0===i&&(i=Em(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Cf{constructor(){this.sessionToken=Hd.EMPTY_BYTE_STRING}getSessionToken(e){return fd.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fd.resolve()}}class Df{constructor(){this.Qr=new Vd(Ef.$r),this.Ur=new Vd(Ef.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ef(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Ef(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Xh(new Qh([])),n=new Ef(t,e),r=new Ef(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Xh(new Qh([])),n=new Ef(t,e),r=new Ef(t,e+1);let i=Em();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Ef(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ef{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Xh.comparator(e.key,t.key)||Vh(e.Yr,t.Yr)}static Kr(e,t){return Vh(e.Yr,t.Yr)||Xh.comparator(e.key,t.key)}}class Sf{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Vd(Ef.$r)}checkEmpty(e){return fd.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new og(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.Zr=this.Zr.add(new Ef(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return fd.resolve(s)}lookupMutationBatch(e,t){return fd.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return fd.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return fd.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return fd.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ef(t,0),r=new Ef(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),fd.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Vd(Vh);return t.forEach(e=>{const t=new Ef(e,0),r=new Ef(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),fd.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Xh.isDocumentKey(i)||(i=i.child(""));const s=new Ef(new Xh(i),0);let o=new Vd(Vh);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},s),fd.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Eh(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return fd.forEach(t.mutations,r=>{const i=new Ef(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Ef(t,0),r=this.Zr.firstAfterOrEqual(n);return fd.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,fd.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class If{constructor(e){this.ri=e,this.docs=new Ud(Xh.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return fd.resolve(n?n.document.mutableCopy():Ap.newInvalidDocument(t))}getEntries(e,t){let n=ym();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ap.newInvalidDocument(e))}),fd.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=ym();const s=t.path,o=new Xh(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||pd(hd(o),n)<=0||(r.has(o.key)||dm(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return fd.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ch(9500)}ii(e,t){return fd.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Tf(this)}getSize(e){return fd.resolve(this.size)}}class Tf extends bf{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),fd.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Af{constructor(e){this.persistence=e,this.si=new gm(e=>em(e),tm),this.lastRemoteSnapshotVersion=ud.min(),this.highestTargetId=0,this.oi=0,this._i=new Df,this.targetCount=0,this.ai=pf.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),fd.resolve()}getLastRemoteSnapshotVersion(e){return fd.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fd.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),fd.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),fd.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new pf(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,fd.resolve()}updateTargetData(e,t){return this.Pr(t),fd.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,fd.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),fd.waitFor(i).next(()=>r)}getTargetCount(e){return fd.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return fd.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),fd.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),fd.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),fd.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return fd.resolve(n)}containsKey(e,t){return fd.resolve(this._i.containsKey(t))}}class Pf{constructor(e,t){this.ui={},this.overlays={},this.ci=new wd(0),this.li=!1,this.li=!0,this.hi=new Cf,this.referenceDelegate=e(this),this.Pi=new Af(this),this.indexManager=new lf,this.remoteDocumentCache=function(e){return new If(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new sf(t),this.Ii=new xf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Sf(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){vh("MemoryPersistence","Starting transaction:",e);const r=new Rf(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return fd.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Rf extends md{constructor(e){super(),this.currentSequenceNumber=e}}class Nf{constructor(e){this.persistence=e,this.Ri=new Df,this.Vi=null}static mi(e){return new Nf(e)}get fi(){if(this.Vi)return this.Vi;throw Ch(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),fd.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),fd.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),fd.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fd.forEach(this.fi,n=>{const r=Xh.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ud.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return fd.or([()=>fd.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ff{constructor(e,t){this.persistence=e,this.pi=new gm(e=>function(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=xd(t)),t=_d(e.get(n),t);return xd(t)}(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=function(e,t){return new wf(e,t)}(this,t)}static mi(e,t){return new Ff(e,t)}Ei(){}di(e){return fd.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return fd.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?fd.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,ud.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),fd.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),fd.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),fd.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),fd.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bp(e.data.value)),t}br(e,t,n){return fd.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return fd.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Of{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Em(),r=Em();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Of(e,t.fromCache,n,r)}}class Mf{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Lf{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=no()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}(Zs())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Mf;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(bh()<=Ao.DEBUG&&vh("QueryEngine","SDK will not create cache indexes for query:",hm(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),fd.resolve()):(bh()<=Ao.DEBUG&&vh("QueryEngine","Query:",hm(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(bh()<=Ao.DEBUG&&vh("QueryEngine","The SDK decides to create cache indexes for query:",hm(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,am(t))):fd.resolve())}ys(e,t){if(sm(t))return fd.resolve(null);let n=am(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=lm(t,null,"F"),n=am(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Em(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,lm(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return sm(t)||r.isEqual(ud.min())?fd.resolve(null):this.ps.getDocuments(e,n).next(i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?fd.resolve(null):(bh()<=Ao.DEBUG&&vh("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),hm(t)),this.vs(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ud.fromTimestamp(1e9===r?new cd(n+1,0):new cd(n,r));return new dd(i,Xh.empty(),t)}(r,-1)).next(e=>e))})}Ds(e,t){let n=new Vd(pm(e));return t.forEach((t,r)=>{dm(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return bh()<=Ao.DEBUG&&vh("QueryEngine","Using full collection scan to execute query:",hm(t)),this.ps.getDocumentsMatchingQuery(e,t,dd.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Uf="LocalStore";class qf{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ud(Vh),this.xs=new gm(e=>em(e),tm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _f(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}async function jf(e,t){const n=Sh(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Em();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:s}))})})}function Vf(e){const t=Sh(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Bf(e,t){const n=Sh(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}async function zf(e,t,n){const r=Sh(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!yd(e))throw e;vh(Uf,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function $f(e,t,n){const r=Sh(e);let i=ud.min(),s=Em();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Sh(e),i=r.xs.get(n);return void 0!==i?fd.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,am(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:ud.min(),n?s:Em())).next(e=>(function(e,t,n){let r=e.Os.get(t)||ud.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Qs:s})))}class Hf{constructor(){this.activeTargetIds=Sm}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gf{constructor(){this.Mo=new Hf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Hf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wf{Oo(e){}shutdown(){}}const Kf="ConnectivityMonitor";class Qf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){vh(Kf,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){vh(Kf,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Yf=null;function Jf(){return null===Yf?Yf=268435456+Math.round(2147483648*Math.random()):Yf++,"0x"+Yf.toString(16)}const Xf="RestConnection",Zf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ey{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===ip?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const s=Jf(),o=this.zo(e,t.toUriEncodedString());vh(Xf,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,i);const{host:l}=new URL(o),c=Ws(l);return this.Jo(e,o,a,n,c).then(t=>(vh(Xf,`Received RPC '${e}' ${s}: `,t),t),t=>{throw xh(Xf,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+yh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Zf[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class ty{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ny="WebChannelConnection";class ry extends ey{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=Jf();return new Promise((i,o)=>{const a=new ih;a.setWithCredentials(!0),a.listenOnce(oh.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case ah.NO_ERROR:const t=a.getResponseJson();vh(ny,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case ah.TIMEOUT:vh(ny,`RPC '${e}' ${s} timed out`),o(new Th(Ih.DEADLINE_EXCEEDED,"Request time out"));break;case ah.HTTP_ERROR:const n=a.getStatus();if(vh(ny,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ih).indexOf(t)>=0?t:Ih.UNKNOWN}(t.status);o(new Th(e,t.message))}else o(new Th(Ih.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Th(Ih.UNAVAILABLE,"Connection failed."));break;default:Ch(9055,{l_:e,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{vh(ny,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);vh(ny,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",l,n,15)})}T_(e,t,n){const r=Jf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=hh(),o=uh(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");vh(ny,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);this.I_(u);let h=!1,d=!1;const p=new ty({Yo:t=>{d?vh(ny,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(vh(ny,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),vh(ny,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return m(u,sh.EventType.OPEN,()=>{d||(vh(ny,`RPC '${e}' stream ${r} transport opened.`),p.o_())}),m(u,sh.EventType.CLOSE,()=>{d||(d=!0,vh(ny,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(u))}),m(u,sh.EventType.ERROR,t=>{d||(d=!0,xh(ny,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),p.a_(new Th(Ih.UNAVAILABLE,"The operation could not be completed")))}),m(u,sh.EventType.MESSAGE,t=>{if(!d){const n=t.data[0];Eh(!!n,16349);const i=n,s=i?.error||i[0]?.error;if(s){vh(ny,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=ug[e];if(void 0!==t)return dg(t)}(t),i=s.message;void 0===n&&(n=Ih.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),d=!0,p.a_(new Th(n,i)),u.close()}else vh(ny,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}}),m(o,ch.STAT_EVENT,t=>{t.stat===lh.PROXY?vh(ny,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===lh.NOPROXY&&vh(ny,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function iy(){return"undefined"!=typeof document?document:null}function sy(e){return new Ag(e,!0)}class oy{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&vh("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ay="PersistentStream";class ly{constructor(e,t,n,r,i,s,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new oy(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===Ih.RESOURCE_EXHAUSTED?(_h(t.toString()),_h("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ih.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.D_===t&&this.G_(e,n)},t=>{e(()=>{const e=new Th(Ih.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return vh(ay,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(vh(ay,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cy extends ly{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ch(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Eh(void 0===t||"string"==typeof t,58123),Hd.fromBase64String(t||"")):(Eh(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Hd.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ih.UNKNOWN:dg(e.code);return new Th(t,e.message||"")}(o);n=new xg(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=jg(e,r.document.name),s=Og(r.document.updateTime),o=r.document.createTime?Og(r.document.createTime):ud.min(),a=new Ip({mapValue:{fields:r.document.fields}}),l=Ap.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new vg(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=jg(e,r.document),s=r.readTime?Og(r.readTime):ud.min(),o=Ap.newNoDocument(i,s),a=r.removedTargetIds||[];n=new vg([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=jg(e,r.document),s=r.removedTargetIds||[];n=new vg([],s,i,null)}else{if(!("filter"in t))return Ch(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new cg(r,i),o=e.targetId;n=new _g(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ud.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ud.min():t.readTime?Og(t.readTime):ud.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Bg(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=nm(r)?{documents:Hg(e,r)}:{query:Gg(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ng(e,t.resumeToken);const r=Pg(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ud.min())>0){n.readTime=Rg(e,t.snapshotVersion.toTimestamp());const r=Pg(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ch(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Bg(this.serializer),t.removeTarget=e,this.q_(t)}}class uy extends ly{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Eh(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Eh(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){Eh(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(Eh(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Og(e.updateTime):Og(t);return n.isEqual(ud.min())&&(n=Og(t)),new $m(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Og(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Bg(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof Zm)n={update:$g(e,t.key,t.value)};else if(t instanceof ig)n={delete:qg(e,t.key)};else if(t instanceof eg)n={update:$g(e,t.key,t.data),updateMask:tf(t.fieldMask)};else{if(!(t instanceof sg))return Ch(16599,{Vt:t.type});n={verify:qg(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Om)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Mm)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Um)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof jm)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw Ch(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Fg(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ch(27497)}(e,t.precondition)),n}(this.serializer,e))};this.q_(t)}}class hy{}class dy extends hy{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Th(Ih.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Go(e,Lg(t,n),r,i,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ih.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Th(Ih.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,Lg(t,n),r,s,o,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Ih.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Th(Ih.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class py{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(_h(t),this.aa=!1):vh("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const my="RemoteStore";class gy{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Cy(this)&&(vh(my,"Restarting streams for network reachability change."),await async function(e){const t=Sh(e);t.Ea.add(4),await yy(t),t.Ra.set("Unknown"),t.Ea.delete(4),await fy(t)}(this))})}),this.Ra=new py(n,r)}}async function fy(e){if(Cy(e))for(const t of e.da)await t(!0)}async function yy(e){for(const t of e.da)await t(!1)}function wy(e,t){const n=Sh(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),ky(n)?xy(n):By(n).O_()&&vy(n,t))}function by(e,t){const n=Sh(e),r=By(n);n.Ia.delete(t),r.O_()&&_y(n,t),0===n.Ia.size&&(r.O_()?r.L_():Cy(n)&&n.Ra.set("Unknown"))}function vy(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ud.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}By(e).Y_(t)}function _y(e,t){e.Va.Ue(t),By(e).Z_(t)}function xy(e){e.Va=new Cg({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),By(e).start(),e.Ra.ua()}function ky(e){return Cy(e)&&!By(e).x_()&&e.Ia.size>0}function Cy(e){return 0===Sh(e).Ea.size}function Dy(e){e.Va=void 0}async function Ey(e){e.Ra.set("Online")}async function Sy(e){e.Ia.forEach((t,n)=>{vy(e,t)})}async function Iy(e,t){Dy(e),ky(e)?(e.Ra.ha(t),xy(e)):e.Ra.set("Unknown")}async function Ty(e,t,n){if(e.Ra.set("Online"),t instanceof xg&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){vh(my,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ay(e,n)}else if(t instanceof vg?e.Va.Ze(t):t instanceof _g?e.Va.st(t):e.Va.tt(t),!n.isEqual(ud.min()))try{const t=await Vf(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Hd.EMPTY_BYTE_STRING,r.snapshotVersion)),_y(e,t);const i=new rf(r.target,t,n,r.sequenceNumber);vy(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){vh(my,"Failed to raise snapshot:",t),await Ay(e,t)}}async function Ay(e,t,n){if(!yd(t))throw t;e.Ea.add(1),await yy(e),e.Ra.set("Offline"),n||(n=()=>Vf(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{vh(my,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await fy(e)})}function Py(e,t){return t().catch(n=>Ay(e,n,t))}async function Ry(e){const t=Sh(e),n=zy(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:-1;for(;Ny(t);)try{const e=await Bf(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Fy(t,e)}catch(e){await Ay(t,e)}Oy(t)&&My(t)}function Ny(e){return Cy(e)&&e.Ta.length<10}function Fy(e,t){e.Ta.push(t);const n=zy(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Oy(e){return Cy(e)&&!zy(e).x_()&&e.Ta.length>0}function My(e){zy(e).start()}async function Ly(e){zy(e).ra()}async function Uy(e){const t=zy(e);for(const n of e.Ta)t.ea(n.mutations)}async function qy(e,t,n){const r=e.Ta.shift(),i=ag.from(r,t,n);await Py(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Ry(e)}async function jy(e,t){t&&zy(e).X_&&await async function(e,t){if(function(e){return function(e){switch(e){case Ih.OK:return Ch(64938);case Ih.CANCELLED:case Ih.UNKNOWN:case Ih.DEADLINE_EXCEEDED:case Ih.RESOURCE_EXHAUSTED:case Ih.INTERNAL:case Ih.UNAVAILABLE:case Ih.UNAUTHENTICATED:return!1;case Ih.INVALID_ARGUMENT:case Ih.NOT_FOUND:case Ih.ALREADY_EXISTS:case Ih.PERMISSION_DENIED:case Ih.FAILED_PRECONDITION:case Ih.ABORTED:case Ih.OUT_OF_RANGE:case Ih.UNIMPLEMENTED:case Ih.DATA_LOSS:return!0;default:return Ch(15467,{code:e})}}(e)&&e!==Ih.ABORTED}(t.code)){const n=e.Ta.shift();zy(e).B_(),await Py(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ry(e)}}(e,t),Oy(e)&&My(e)}async function Vy(e,t){const n=Sh(e);n.asyncQueue.verifyOperationInProgress(),vh(my,"RemoteStore received new credentials");const r=Cy(n);n.Ea.add(3),await yy(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await fy(n)}function By(e){return e.ma||(e.ma=function(e,t,n){const r=Sh(e);return r.sa(),new cy(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Ey.bind(null,e),t_:Sy.bind(null,e),r_:Iy.bind(null,e),H_:Ty.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),ky(e)?xy(e):e.Ra.set("Unknown")):(await e.ma.stop(),Dy(e))})),e.ma}function zy(e){return e.fa||(e.fa=function(e,t,n){const r=Sh(e);return r.sa(),new uy(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ly.bind(null,e),r_:jy.bind(null,e),ta:Uy.bind(null,e),na:qy.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Ry(e)):(await e.fa.stop(),e.Ta.length>0&&(vh(my,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class $y{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ah,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new $y(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Th(Ih.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hy(e,t){if(_h("AsyncQueue",`${t}: ${e}`),yd(e))return new Th(Ih.UNAVAILABLE,`${t}: ${e}`);throw e}class Gy{static emptySet(e){return new Gy(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xh.comparator(t.key,n.key):(e,t)=>Xh.comparator(e.key,t.key),this.keyedMap=bm(),this.sortedSet=new Ud(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Gy))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Gy;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Wy{constructor(){this.ga=new Ud(Xh.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ch(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Ky{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Ky(e,t,Gy.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Qy{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Yy{constructor(){this.queries=Jy(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=Sh(e),r=n.queries;n.queries=Jy(),r.forEach((e,n)=>{for(const e of n.Sa)e.onError(t)})}(this,new Th(Ih.ABORTED,"Firestore shutting down"))}}function Jy(){return new gm(e=>um(e),cm)}function Xy(e,t){const n=Sh(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.Sa)t.Fa(e)&&(r=!0);i.wa=e}}r&&ew(n)}function Zy(e,t,n){const r=Sh(e),i=r.queries.get(t);if(i)for(const e of i.Sa)e.onError(n);r.queries.delete(t)}function ew(e){e.Ca.forEach(e=>{e.next()})}var tw,nw;(nw=tw||(tw={})).Ma="default",nw.Cache="cache";class rw{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ky(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Ky.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tw.Cache}}class iw{constructor(e){this.key=e}}class sw{constructor(e){this.key=e}}class ow{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Em(),this.mutatedKeys=Em(),this.eu=pm(e),this.tu=new Gy(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Wy,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=dm(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let p=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),p=!0):this.su(c,u)||(n.track({type:2,doc:u}),p=!0,(a&&this.eu(u,a)>0||l&&this.eu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),p=!0):c&&!u&&(n.track({type:1,doc:c}),p=!0,(a||l)&&(o=!0)),p&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ch(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=r??!1;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,l=a!==this.Za;return this.Za=a,0!==s.length||l?{snapshot:new Ky(this.query,e.tu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Em(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new sw(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new iw(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Em();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ky.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const aw="SyncEngine";class lw{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class cw{constructor(e){this.key=e,this.hu=!1}}class uw{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new gm(e=>um(e),cm),this.Iu=new Map,this.Eu=new Set,this.du=new Ud(Xh.comparator),this.Au=new Map,this.Ru=new Df,this.Vu={},this.mu=new Map,this.fu=pf.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function hw(e,t,n=!0){const r=Pw(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await pw(r,t,n,!0),i}async function dw(e,t){const n=Pw(e);await pw(n,t,!0,!1)}async function pw(e,t,n,r){const i=await function(e,t){const n=Sh(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,fd.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new rf(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}(e.localStore,am(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await async function(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await $f(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,i)));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Dw(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const s=await $f(e.localStore,t,!0),o=new ow(t,s.Qs),a=o.ru(s.documents),l=bg.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Dw(e,n,c.au);const u=new lw(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&wy(e.remoteStore,i),a}async function mw(e,t,n){const r=Sh(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(e=>!cm(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await zf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&by(r.remoteStore,i.targetId),kw(r,i.targetId)}).catch(gd)):(kw(r,i.targetId),await zf(r.localStore,i.targetId,!0))}async function gw(e,t){const n=Sh(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),by(n.remoteStore,r.targetId))}async function fw(e,t){const n=Sh(e);try{const e=await function(e,t){const n=Sh(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Hd.EMPTY_BYTE_STRING,ud.min()).withLastLimboFreeSnapshotVersion(ud.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Pi.updateTargetData(e,c))});let a=ym(),l=Em();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=Em(),i=Em();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=ym();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(ud.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):vh(Uf,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{ks:r,qs:i}})}(e,s,t.documentUpdates).next(e=>{a=e.ks,l=e.qs})),!r.isEqual(ud.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return fd.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(Eh(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?Eh(r.hu,14607):e.removedDocuments.size>0&&(Eh(r.hu,42227),r.hu=!1))}),await Iw(n,e,t)}catch(e){await gd(e)}}function yw(e,t,n){const r=Sh(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Sh(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const e of n.Sa)e.va(t)&&(r=!0)}),r&&ew(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ww(e,t,n){const r=Sh(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new Ud(Xh.comparator);e=e.insert(s,Ap.newNoDocument(s,ud.min()));const n=Em().add(s),i=new wg(ud.min(),new Map,new Ud(Vh),e,n);await fw(r,i),r.du=r.du.remove(s),r.Au.delete(t),Sw(r)}else await zf(r.localStore,t,!1).then(()=>kw(r,t,n)).catch(gd)}async function bw(e,t){const n=Sh(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Sh(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=fd.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Eh(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Em();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);xw(n,r,null),_w(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Iw(n,e)}catch(e){await gd(e)}}async function vw(e,t,n){const r=Sh(e);try{const e=await function(e,t){const n=Sh(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Eh(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);xw(r,t,n),_w(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Iw(r,e)}catch(n){await gd(n)}}function _w(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function xw(e,t,n){const r=Sh(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function kw(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Cw(e,t)})}function Cw(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(by(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Sw(e))}function Dw(e,t,n){for(const r of n)r instanceof iw?(e.Ru.addReference(r.key,t),Ew(e,r)):r instanceof sw?(vh(aw,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Cw(e,r.key)):Ch(19791,{wu:r})}function Ew(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(vh(aw,"New document in limbo: "+n),e.Eu.add(r),Sw(e))}function Sw(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Xh(Qh.fromString(t)),r=e.fu.next();e.Au.set(r,new cw(n)),e.du=e.du.insert(n,r),wy(e.remoteStore,new rf(am(im(n.path)),r,"TargetPurposeLimboResolution",wd.ce))}}async function Iw(e,t,n){const r=Sh(e),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,t?"current":"not-current")}if(e){i.push(e);const t=Of.As(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(e,t){const n=Sh(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>fd.forEach(t,t=>fd.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>fd.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!yd(e))throw e;vh(Uf,"Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ms.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,i)}}}(r.localStore,s))}async function Tw(e,t){const n=Sh(e);if(!n.currentUser.isEqual(t)){vh(aw,"User change. New user:",t.toKey());const e=await jf(n.localStore,t);n.currentUser=t,function(e){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new Th(Ih.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Iw(n,e.Ls)}}function Aw(e,t){const n=Sh(e),r=n.Au.get(t);if(r&&r.hu)return Em().add(r.key);{let e=Em();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Pw(e){const t=Sh(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fw.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Aw.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ww.bind(null,t),t.Pu.H_=Xy.bind(null,t.eventManager),t.Pu.yu=Zy.bind(null,t.eventManager),t}function Rw(e){const t=Sh(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=bw.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=vw.bind(null,t),t}class Nw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return function(e,t,n,r){return new qf(e,t,n,r)}(this.persistence,new Lf,e.initialUser,this.serializer)}Cu(e){return new Pf(Nf.mi,this.serializer)}Du(e){return new Gf}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Nw.provider={build:()=>new Nw};class Fw extends Nw{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Eh(this.persistence.referenceDelegate instanceof Ff,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new yf(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?df.withCacheSize(this.cacheSizeBytes):df.DEFAULT;return new Pf(e=>Ff.mi(e,t),this.serializer)}}class Ow{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>yw(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Tw.bind(null,this.syncEngine),await async function(e,t){const n=Sh(e);t?(n.Ea.delete(2),await fy(n)):t||(n.Ea.add(2),await yy(n),n.Ra.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Yy}createDatastore(e){const t=sy(e.databaseInfo.databaseId),n=function(e){return new ry(e)}(e.databaseInfo);return function(e,t,n,r){return new dy(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new gy(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>yw(this.syncEngine,e,0),Qf.v()?new Qf:new Wf)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uw(e,t,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=Sh(e);vh(my,"RemoteStore shutting down."),t.Ea.add(5),await yy(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ow.provider={build:()=>new Ow};class Mw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):_h("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Lw="FirestoreClient";class Uw{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=fh.UNAUTHENTICATED,this.clientId=jh.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{vh(Lw,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(vh(Lw,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ah;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Hy(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qw(e,t){e.asyncQueue.verifyOperationInProgress(),vh(Lw,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await jf(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function jw(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){vh(Lw,"Using user provided OfflineComponentProvider");try{await qw(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ih.FAILED_PRECONDITION||e.code===Ih.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;xh("Error using user provided cache. Falling back to memory cache: "+n),await qw(e,new Nw)}}else vh(Lw,"Using default OfflineComponentProvider"),await qw(e,new Fw(void 0));return e._offlineComponents}(e);vh(Lw,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Vy(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Vy(t.remoteStore,n)),e._onlineComponents=t}async function Vw(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(vh(Lw,"Using user provided OnlineComponentProvider"),await jw(e,e._uninitializedComponentsProvider._online)):(vh(Lw,"Using default OnlineComponentProvider"),await jw(e,new Ow))),e._onlineComponents}async function Bw(e){const t=await Vw(e),n=t.eventManager;return n.onListen=hw.bind(null,t.syncEngine),n.onUnlisten=mw.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=dw.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=gw.bind(null,t.syncEngine),n}function zw(e,t,n={}){const r=new Ah;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Mw({next:a=>{s.Nu(),t.enqueueAndForget(()=>async function(e,t){const n=Sh(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new Th(Ih.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new Th(Ih.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new rw(im(n.path),s,{includeMetadataChanges:!0,qa:!0});return async function(e,t){const n=Sh(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new Qy,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Hy(e,`Initialization of query '${hm(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&ew(n)}(e,o)}(await Bw(e),e.asyncQueue,t,n,r)),r.promise}function $w(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Hw=new Map,Gw="firestore.googleapis.com",Ww=!0;class Kw{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new Th(Ih.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gw,this.ssl=Ww}else this.host=e.host,this.ssl=e.ssl??Ww;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=hf;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Th(Ih.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Th(Ih.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$w(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Th(Ih.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Th(Ih.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Th(Ih.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qw{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Th(Ih.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Th(Ih.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kw(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Rh;switch(e.type){case"firstParty":return new Mh(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Th(Ih.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hw.get(e);t&&(vh("ComponentProvider","Removing Datastore"),Hw.delete(e),t.terminate())}(this),Promise.resolve()}}class Yw{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yw(this.firestore,e,this._query)}}class Jw{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jw(this.firestore,e,this._key)}toJSON(){return{type:Jw._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(od(t,Jw._jsonSchema))return new Jw(e,n||null,new Xh(Qh.fromString(t.referencePath)))}}Jw._jsonSchemaVersion="firestore/documentReference/1.0",Jw._jsonSchema={type:sd("string",Jw._jsonSchemaVersion),referencePath:sd("string")};class Xw extends Yw{constructor(e,t,n){super(e,t,im(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jw(this.firestore,null,new Xh(e))}withConverter(e){return new Xw(this.firestore,e,this._path)}}function Zw(e,t,...n){if(e=Co(e),1===arguments.length&&(t=jh.newId()),Zh("doc","path",t),e instanceof Qw){const r=Qh.fromString(t,...n);return ed(r),new Jw(e,null,new Xh(r))}{if(!(e instanceof Jw||e instanceof Xw))throw new Th(Ih.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Qh.fromString(t,...n));return ed(r),new Jw(e.firestore,e instanceof Xw?e.converter:null,new Xh(r))}}const eb="AsyncQueue";class tb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new oy(this,"async_queue_retry"),this._c=()=>{const e=iy();e&&vh(eb,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=iy();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=iy();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ah;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!yd(e))throw e;vh(eb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,_h("INTERNAL UNHANDLED ERROR: ",nb(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=$y.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&Ch(47125,{Pc:nb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function nb(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class rb extends Qw{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new tb,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tb(e),this._firestoreClient=void 0,await e}}}function ib(e){if(e._terminated)throw new Th(Ih.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new rp(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,$w(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new Uw(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}(e),e._firestoreClient}class sb{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sb(Hd.fromBase64String(e))}catch(e){throw new Th(Ih.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new sb(Hd.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:sb._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(od(e,sb._jsonSchema))return sb.fromBase64String(e.bytes)}}sb._jsonSchemaVersion="firestore/bytes/1.0",sb._jsonSchema={type:sd("string",sb._jsonSchemaVersion),bytes:sd("string")};class ob{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Th(Ih.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jh(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ab{constructor(e){this._methodName=e}}class lb{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Th(Ih.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Th(Ih.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Vh(this._lat,e._lat)||Vh(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:lb._jsonSchemaVersion}}static fromJSON(e){if(od(e,lb._jsonSchema))return new lb(e.latitude,e.longitude)}}lb._jsonSchemaVersion="firestore/geoPoint/1.0",lb._jsonSchema={type:sd("string",lb._jsonSchemaVersion),latitude:sd("number"),longitude:sd("number")};class cb{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:cb._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(od(e,cb._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new cb(e.vectorValues);throw new Th(Ih.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}cb._jsonSchemaVersion="firestore/vectorValue/1.0",cb._jsonSchema={type:sd("string",cb._jsonSchemaVersion),vectorValues:sd("object")};const ub=/^__.*__$/;class hb{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new eg(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zm(e,this.data,t,this.fieldTransforms)}}class db{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new eg(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pb(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ch(40011,{Ac:e})}}class mb{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new mb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Sb(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(pb(this.Ac)&&ub.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gb{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sy(e)}Cc(e,t,n,r=!1){return new mb({Ac:e,methodName:t,Dc:n,path:Jh.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fb(e){const t=e._freezeSettings(),n=sy(e._databaseId);return new gb(e._databaseId,!!t.ignoreUndefinedProperties,n)}function yb(e,t,n,r,i,s={}){const o=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);kb("Data must be an object, but it was:",o,r);const a=_b(r,o);let l,c;if(s.merge)l=new zd(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Cb(t,r,n);if(!o.contains(i))throw new Th(Ih.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ib(e,i)||e.push(i)}l=new zd(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new hb(new Ip(a),l,c)}class wb extends ab{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wb}}class bb extends ab{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=function(e,t,n){return new mb({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}(this,e,!0),n=this.vc.map(e=>vb(e,t)),r=new Mm(n);return new zm(e.path,r)}isEqual(e){return e instanceof bb&&mo(this.vc,e.vc)}}function vb(e,t){if(xb(e=Co(e)))return kb("Unsupported field value:",t,e),_b(e,t);if(e instanceof ab)return function(e,t){if(!pb(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=vb(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Co(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Am(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=cd.fromDate(e);return{timestampValue:Rg(t.serializer,n)}}if(e instanceof cd){const n=new cd(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Rg(t.serializer,n)}}if(e instanceof lb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof sb)return{bytesValue:Ng(t.serializer,e._byteString)};if(e instanceof Jw){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Mg(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof cb)return function(e,t){return{mapValue:{fields:{[op]:{stringValue:cp},[up]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return Im(t.serializer,e)})}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${rd(e)}`)}(e,t)}function _b(e,t){const n={};return Ld(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Md(e,(e,r)=>{const i=vb(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function xb(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof cd||e instanceof lb||e instanceof sb||e instanceof Jw||e instanceof ab||e instanceof cb)}function kb(e,t,n){if(!xb(n)||!nd(n)){const r=rd(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Cb(e,t,n){if((t=Co(t))instanceof ob)return t._internalPath;if("string"==typeof t)return Eb(e,t);throw Sb("Field path arguments must be of type string or ",e,!1,void 0,n)}const Db=new RegExp("[~\\*/\\[\\]]");function Eb(e,t,n){if(t.search(Db)>=0)throw Sb(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ob(...t.split("."))._internalPath}catch(r){throw Sb(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Sb(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Th(Ih.INVALID_ARGUMENT,a+e+l)}function Ib(e,t){return e.some(e=>e.isEqual(t))}class Tb{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Jw(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ab(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Pb("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ab extends Tb{data(){return super.data()}}function Pb(e,t){return"string"==typeof t?Eb(e,t):t instanceof ob?t._internalPath:t._delegate._internalPath}class Rb{convertValue(e,t="none"){switch(hp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kd(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ch(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Md(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[up].arrayValue?.values?.map(e=>Kd(e.doubleValue));return new cb(t)}convertGeoPoint(e){return new lb(Kd(e.latitude),Kd(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=tp(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(np(e));default:return null}}convertTimestamp(e){const t=Wd(e);return new cd(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Qh.fromString(e);Eh(nf(n),9688,{name:e});const r=new sp(n.get(1),n.get(3)),i=new Xh(n.popFirst(5));return r.isEqual(t)||_h(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Nb(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Fb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ob extends Tb{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Mb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Pb("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Th(Ih.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ob._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Ob._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ob._jsonSchema={type:sd("string",Ob._jsonSchemaVersion),bundleSource:sd("string","DocumentSnapshot"),bundleName:sd("string"),bundle:sd("string")};class Mb extends Ob{data(e={}){return super.data(e)}}class Lb{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Fb(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Mb(this._firestore,this._userDataWriter,n.key,n,new Fb(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Th(Ih.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Mb(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Fb(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Mb(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Fb(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Ub(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Th(Ih.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lb._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jh.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ub(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ch(61501,{type:e})}}function qb(e){e=id(e,Jw);const t=id(e.firestore,rb);return zw(ib(t),e._key).then(n=>function(e,t,n){const r=n.docs.get(t._key),i=new jb(e);return new Ob(e,i,t._key,r,new Fb(n.hasPendingWrites,n.fromCache),t.converter)}(t,e,n))}Lb._jsonSchemaVersion="firestore/querySnapshot/1.0",Lb._jsonSchema={type:sd("string",Lb._jsonSchemaVersion),bundleSource:sd("string","QuerySnapshot"),bundleName:sd("string"),bundle:sd("string")};class jb extends Rb{constructor(e){super(),this.firestore=e}convertBytes(e){return new sb(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Jw(this.firestore,null,t)}}function Vb(e,t,n){e=id(e,Jw);const r=id(e.firestore,rb),i=Nb(e.converter,t,n);return zb(r,[yb(fb(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Hm.none())])}function Bb(e,t,n,...r){e=id(e,Jw);const i=id(e.firestore,rb),s=fb(i);let o;return o="string"==typeof(t=Co(t))||t instanceof ob?function(e,t,n,r,i,s){const o=e.Cc(1,t,n),a=[Cb(t,r,n)],l=[i];if(s.length%2!=0)throw new Th(Ih.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(Cb(t,s[e])),l.push(s[e+1]);const c=[],u=Ip.empty();for(let e=a.length-1;e>=0;--e)if(!Ib(c,a[e])){const t=a[e];let n=l[e];n=Co(n);const r=o.yc(t);if(n instanceof wb)c.push(t);else{const e=vb(n,r);null!=e&&(c.push(t),u.set(t,e))}}const h=new zd(c);return new db(u,h,o.fieldTransforms)}(s,"updateDoc",e._key,t,n,r):function(e,t,n,r){const i=e.Cc(1,t,n);kb("Data must be an object, but it was:",i,r);const s=[],o=Ip.empty();Md(r,(e,r)=>{const a=Eb(t,e,n);r=Co(r);const l=i.yc(a);if(r instanceof wb)s.push(a);else{const e=vb(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new zd(s);return new db(o,a,i.fieldTransforms)}(s,"updateDoc",e._key,t),zb(i,[o.toMutation(e._key,Hm.exists(!0))])}function zb(e,t){return function(e,t){const n=new Ah;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Rw(e);try{const e=await function(e,t){const n=Sh(e),r=cd.now(),i=t.reduce((e,t)=>e.add(t.key),Em());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=ym(),l=Em();return n.Ns.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=Jm(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new eg(e.key,t,Tp(t.value.mapValue),Hm.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:vm(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Ud(Vh)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Iw(r,e.changes),await Ry(r.remoteStore)}catch(e){const t=Hy(e,"Failed to persist write");n.reject(t)}}(await function(e){return Vw(e).then(e=>e.syncEngine)}(e),t,n)),n.promise}(ib(e),t)}function $b(...e){return new bb("arrayUnion",e)}new WeakMap,function(e,t=!0){!function(e){yh=e}(qa),Fa(new Do("firestore",(e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new rb(new Fh(e.getProvider("auth-internal")),new Uh(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Th(Ih.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sp(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),Ba(mh,gh,e),Ba(mh,gh,"esm2020")}();const Hb={apiKey:"AIzaSyBA4qQj_Mg0Tanfe8nQNLqL33Rtii0ZhqA",authDomain:"nusa-dwipa.firebaseapp.com",databaseURL:"https://nusa-dwipa-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"nusa-dwipa",storageBucket:"nusa-dwipa.firebasestorage.app",messagingSenderId:"231878445619",appId:"1:231878445619:web:ea7b04746f23afd73e7146",measurementId:"G-MZ67EDBKF5"},Gb=ja(Hb),Wb=function(e){const t="object"==typeof e?e:Va(),n="string"==typeof e?e:ip,r=Oa(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const e=zs("firestore");e&&function(e,t,n,r={}){e=id(e,Qw);const i=Ws(t),s=e._getSettings(),o={...s,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;i&&(Ks(`https://${a}`),Xs("Firestore",!0)),s.host!==Gw&&s.host!==a&&xh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!mo(l,o)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=fh.MOCK_USER;else{t=Qs(r.mockUserToken,e._app?.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Th(Ih.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new fh(i)}e._authCredentials=new Nh(new Ph(t,n))}}(r,...e)}return r}(Gb),Kb=function(e=Va()){const t=Oa(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Oa(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(mo(n.getOptions(),t??{}))return e;nl(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Gu,persistence:[uu,Wc,Qc]}),r=Hs("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Yu)return;const r=t?.token;Ju!==r&&(Ju=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Co(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e){Co(e).onIdTokenChanged(e=>t(e),void 0,void 0)}(n)}}var i;const s=Bs("auth");return s&&function(e,t,n){const r=cc(e);al(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!n?.disableWarnings,s=vc(t),{host:o,port:a}=function(e){const t=vc(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:_c(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:_c(t)}}}(t),l=null===a?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return al(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void al(mo(c,r.config.emulator)&&mo(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Ws(o)?(Ks(`${s}//${o}${l}`),Xs("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}(Gb);function Qb(e=5e3,t){const n=!(!t||!t.strict);return new Promise((t,r)=>{let i=!1;const s=setTimeout(()=>{if(!i){if(i=!0,o(),n)return void r(new Error("Auth state timeout"));const e=localStorage.getItem("userId");e?(console.warn("[Firebase] Auth state timeout, using localStorage userId as fallback"),t({uid:e})):r(new Error("Auth state timeout and no userId in localStorage"))}},e),o=function(e){return Co(e).onAuthStateChanged(e=>{if(!i)if(i=!0,clearTimeout(s),o(),e)console.log("[Firebase] Auth state ready, user authenticated:",e.uid),t(e);else{if(n)return void r(new Error("User not authenticated"));const e=localStorage.getItem("userId");e?(console.warn("[Firebase] No auth user, using localStorage userId as fallback"),t({uid:e})):r(new Error("User not authenticated"))}},e=>{i||(i=!0,clearTimeout(s),o(),r(e))},void 0)}(Kb)})}async function Yb(e,t,n){try{const r=Kb.currentUser;if(!r&&!localStorage.getItem("userId"))throw new Error("User not authenticated");const i=r?.uid||e;r&&r.uid!==e&&console.warn("[Firebase] userId mismatch, using auth.uid instead");const s=Zw(Wb,"users",i);if((await qb(s)).exists())await Bb(s,{lastLogin:cd.now(),updatedAt:cd.now()}),console.log("[Firebase] User login updated");else{const e={username:t,email:n,uid:i,level:1,experience:0,collectedItems:[],achievements:[],avatarSrc:"",totalPlayTime:0,quizStats:{score:0,correctAnswers:0,wrongAnswers:0,answeredQuestions:0,totalQuestions:0,collectedCostumes:0,totalCostumes:0,completedGuards:[],durationSeconds:0,completed:!1,answeredQuestionIds:[],updatedAt:cd.now()},createdAt:cd.now(),updatedAt:cd.now(),lastLogin:cd.now()};await Vb(s,e),console.log("[Firebase] User data initialized:",e)}}catch(e){throw console.error("[Firebase] Error initializing user data:",e),"permission-denied"===e.code&&console.error("[Firebase] Permission denied. Make sure user is authenticated and Firestore rules allow write access."),e}}async function Jb(e){try{const t=Kb.currentUser,n=Zw(Wb,"users",t?.uid||e),r=await qb(n);if(r.exists()){const e=r.data();return{username:e.username,email:e.email,uid:e.uid,level:e.level||1,experience:e.experience||0,collectedItems:e.collectedItems||[],achievements:e.achievements||[],avatarSrc:e.avatarSrc||"",totalPlayTime:e.totalPlayTime||0,quizStats:e.quizStats||void 0,createdAt:e.createdAt?"function"==typeof e.createdAt.toDate?e.createdAt.toDate():new Date(1e3*e.createdAt.seconds):new Date,updatedAt:e.updatedAt?"function"==typeof e.updatedAt.toDate?e.updatedAt.toDate():new Date(1e3*e.updatedAt.seconds):new Date,lastLogin:e.lastLogin?"function"==typeof e.lastLogin.toDate?e.lastLogin.toDate():new Date(1e3*e.lastLogin.seconds):new Date}}return null}catch(e){return"permission-denied"===e.code||e.message?.includes("permissions")?(console.warn("[Firebase] Permission denied getting user data. This might be a Firestore security rules issue."),console.warn("[Firebase] Make sure Firestore security rules allow read access for authenticated users.")):console.error("[Firebase] Error getting user data:",e),null}}async function Xb(e,t){try{const n=Kb.currentUser,r=Zw(Wb,"users",n?.uid||e),i={quizStats:{score:t.score,correctAnswers:t.correctAnswers,wrongAnswers:t.wrongAnswers,answeredQuestions:t.answeredQuestions,totalQuestions:t.totalQuestions,collectedCostumes:t.collectedCostumes,totalCostumes:t.totalCostumes,completedGuards:t.completedGuards,durationSeconds:t.durationSeconds,completed:t.completed,answeredQuestionIds:t.answeredQuestionIds||[],finishedAt:t.completed?cd.now():null,updatedAt:cd.now()},updatedAt:cd.now()};await Bb(r,i),console.log("[Firebase] Quiz stats updated")}catch(n){if("not-found"===n.code){console.warn("[Firebase] User not found when updating quiz stats. Attempting initialization.");const n=localStorage.getItem("userUsername")||"Explorer",r=localStorage.getItem("userEmail")||"";try{await Yb(e,n,r),await Xb(e,t)}catch(e){console.error("[Firebase] Failed to initialize user before updating quiz stats:",e)}return}console.error("[Firebase] Error updating quiz stats:",n)}}"undefined"!=typeof window&&(window.saveToLeaderboard=async function(e,t,n){try{console.log("[Firebase] Saving to leaderboard:",{username:e,score:t,time:n});const r=function(e,t,...n){if(e=Co(e),Zh("collection","path",t),e instanceof Qw){const r=Qh.fromString(t,...n);return td(r),new Xw(e,null,r)}{if(!(e instanceof Jw||e instanceof Xw))throw new Th(Ih.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Qh.fromString(t,...n));return td(r),new Xw(e.firestore,null,r)}}(Wb,"leaderboard"),i={username:e||"Anonymous",score:t||0,time:n||0,createdAt:cd.now()},s=await function(e,t){const n=id(e.firestore,rb),r=Zw(e),i=Nb(e.converter,t);return zb(n,[yb(fb(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Hm.exists(!1))]).then(()=>r)}(r,i);console.log("[Firebase]  Successfully saved to leaderboard with ID:",s.id,i)}catch(e){throw console.error("[Firebase]  Error saving to leaderboard:",e),e}});const Zb="@firebase/database",ev="1.1.0";let tv="";class nv{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ao(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:oo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class rv{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return co(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const iv=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new nv(t)}}catch(e){}return new rv},sv=iv("localStorage"),ov=iv("sessionStorage"),av=new Oo("@firebase/database"),lv=function(){let e=1;return function(){return e++}}(),cv=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,As(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new bo;n.update(t);const r=n.digest();return Ns.encodeByteArray(r)},uv=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=uv.apply(null,r):t+="object"==typeof r?ao(r):r,t+=" "}return t};let hv=null,dv=!0;const pv=function(...e){if(!0===dv&&(dv=!1,null===hv&&!0===ov.get("logging_enabled")&&(t=!0,As(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(av.logLevel=Ao.VERBOSE,hv=av.log.bind(av),n&&ov.set("logging_enabled",!0)):"function"==typeof t?hv=t:(hv=null,ov.remove("logging_enabled")))),hv){const t=uv.apply(null,e);hv(t)}var t,n},mv=function(e){return function(...t){pv(e,...t)}},gv=function(...e){const t="FIREBASE INTERNAL ERROR: "+uv(...e);av.error(t)},fv=function(...e){const t=`FIREBASE FATAL ERROR: ${uv(...e)}`;throw av.error(t),new Error(t)},yv=function(...e){const t="FIREBASE WARNING: "+uv(...e);av.warn(t)},wv=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},bv="[MIN_NAME]",vv="[MAX_NAME]",_v=function(e,t){if(e===t)return 0;if(e===bv||t===vv)return-1;if(t===bv||e===vv)return 1;{const n=Tv(e),r=Tv(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},xv=function(e,t){return e===t?0:e<t?-1:1},kv=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ao(t))},Cv=function(e){if("object"!=typeof e||null===e)return ao(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=ao(t[r]),n+=":",n+=Cv(e[t[r]]);return n+="}",n},Dv=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Ev(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Sv=function(e){As(!wv(e),"Invalid JSON number");let t,n,r,i,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const o=[];for(s=52;s;s-=1)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();const a=o.join("");let l="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},Iv=new RegExp("^-?(0*)\\d{1,10}$"),Tv=function(e){if(Iv.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Av=function(e){try{e()}catch(e){setTimeout(()=>{const t=e.stack||"";throw yv("Exception was thrown by user callback.",t),e},Math.floor(0))}},Pv=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Rv{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ma(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(e=>this.appCheck=e)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){yv(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Nv{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(pv("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',yv(e)}}class Fv{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Fv.OWNER="owner";const Ov="5",Mv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Lv="ac",Uv="websocket",qv="long_polling";class jv{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1,l=null){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=sv.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&sv.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Vv(e,t,n){let r;if(As("string"==typeof t,"typeof type must == string"),As("object"==typeof n,"typeof params must == object"),t===Uv)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==qv)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Ev(n,(e,t)=>{i.push(e+"="+t)}),r+i.join("&")}class Bv{constructor(){this.counters_={}}incrementCounter(e,t=1){co(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Us(this.counters_)}}const zv={},$v={};function Hv(e){const t=e.toString();return zv[t]||(zv[t]=new Bv),zv[t]}class Gv{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Av(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Wv="start";class Kv{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=mv(e),this.stats_=Hv(t),this.urlFn=e=>(this.appCheckToken&&(e[Lv]=this.appCheckToken),Vv(t,qv,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Gv(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Qv((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===Wv)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_()}},(...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)},()=>{this.onClosed_()},this.urlFn);const e={};e[Wv]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Ov,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Lv]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Mv.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Kv.forceAllow_=!0}static forceDisallow(){Kv.forceDisallow_=!0}static isAvailable(){return!(!Kv.forceAllow_&&(Kv.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ao(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Os(t),r=Dv(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ao(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Qv{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=lv(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Qv.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){pv("frame writing exception"),e.stack&&pv(e.stack),pv(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||pv("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),n()})}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{pv("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}},Math.floor(1))}}let Yv=null;"undefined"!=typeof MozWebSocket?Yv=MozWebSocket:"undefined"!=typeof WebSocket&&(Yv=WebSocket);class Jv{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=mv(this.connId),this.stats_=Hv(t),this.connURL=Jv.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=Ov,"undefined"!=typeof location&&location.hostname&&Mv.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[Lv]=r),i&&(s.p=i),Vv(e,Uv,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,sv.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new Yv(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Jv.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Yv&&!Jv.forceDisallow_}static previouslyFailed(){return sv.isInMemoryStorage||!0===sv.get("previous_websocket_failure")}markConnectionHealthy(){sv.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=oo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(As(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ao(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Dv(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Jv.responsesRequiredToBeHealthy=2,Jv.healthyTimeout=3e4;class Xv{static get ALL_TRANSPORTS(){return[Kv,Jv]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Jv&&Jv.isAvailable();let n=t&&!Jv.previouslyFailed();if(e.webSocketOnly&&(t||yv("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Jv];else{const e=this.transports_=[];for(const t of Xv.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Xv.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Xv.globalTransportInitialized_=!1;class Zv{constructor(e,t,n,r,i,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=mv("c:"+this.id+":"),this.transportManager_=new Xv(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Pv(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=kv("t",e),n=kv("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=kv("t",e),n=kv("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=kv("t",e);if("d"in e){const n=e.d;if("h"===t){const e={...n};this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?gv("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gv("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Ov!==n&&yv("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Pv(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Pv(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(sv.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class e_{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class t_{constructor(e){this.allowedEvents_=e,this.listeners_={},As(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){As(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class n_ extends t_{static getInstance(){return new n_}constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||eo()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return As("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class r_{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function i_(){return new r_("")}function s_(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function o_(e){return e.pieces_.length-e.pieceNum_}function a_(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new r_(e.pieces_,t)}function l_(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function c_(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function u_(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new r_(t,0)}function h_(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof r_)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new r_(n,0)}function d_(e){return e.pieceNum_>=e.pieces_.length}function p_(e,t){const n=s_(e),r=s_(t);if(null===n)return t;if(n===r)return p_(a_(e),a_(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function m_(e,t){const n=c_(e,0),r=c_(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=_v(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function g_(e,t){if(o_(e)!==o_(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function f_(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(o_(e)>o_(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class y_{constructor(e,t){this.errorPrefix_=t,this.parts_=c_(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=ko(this.parts_[e]);w_(this)}}function w_(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+b_(e))}function b_(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class v_ extends t_{static getInstance(){return new v_}constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}getInitialEvent(e){return As("visible"===e,"Unknown event type: "+e),[this.visible_]}}const __=1e3;class x_ extends e_{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=x_.nextPersistentConnectionId_++,this.log_=mv("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=__,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");v_.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&n_.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(ao(i)),As(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Gs,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),As(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),As(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,i=>{const s=i.d,o=i.s;x_.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&co(e,"w")){const n=uo(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();yv(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=lo(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=lo(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),As(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,e=>{r&&setTimeout(()=>{r(e.s,e.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ao(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):gv("Unrecognized action received from server: "+ao(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){As(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=__,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=__,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=__),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+x_.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){As(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?pv("getToken() completed but was canceled"):(pv("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new Zv(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{yv(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&yv(e),a())}}}interrupt(e){pv("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){pv("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ho(this.interruptReasons_)&&(this.reconnectDelay_=__,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>Cv(e)).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new r_(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){pv("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){pv("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+tv.replace(/\./g,"-")]=1,eo()?e["framework.cordova"]=1:to()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=n_.getInstance().currentlyOnline();return ho(this.interruptReasons_)&&e}}x_.nextPersistentConnectionId_=0,x_.nextConnectionId_=0;class k_{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new k_(e,t)}}class C_{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new k_(bv,e),r=new k_(bv,t);return 0!==this.compare(n,r)}minPost(){return k_.MIN}}let D_;class E_ extends C_{static get __EMPTY_NODE(){return D_}static set __EMPTY_NODE(e){D_=e}compare(e,t){return _v(e.name,t.name)}isDefinedOn(e){throw Ps("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return k_.MIN}maxPost(){return new k_(vv,D_)}makePost(e,t){return As("string"==typeof e,"KeyIndex indexValue must always be a string."),new k_(e,D_)}toString(){return".key"}}const S_=new E_;class I_{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class T_{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:T_.RED,this.left=null!=r?r:A_.EMPTY_NODE,this.right=null!=i?i:A_.EMPTY_NODE}copy(e,t,n,r,i){return new T_(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return A_.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return A_.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,T_.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,T_.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}T_.RED=!0,T_.BLACK=!1;class A_{constructor(e,t=A_.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new A_(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,T_.BLACK,null,null))}remove(e){return new A_(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,T_.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new I_(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new I_(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new I_(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new I_(this.root_,null,this.comparator_,!0,e)}}function P_(e,t){return _v(e.name,t.name)}function R_(e,t){return _v(e,t)}let N_;A_.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new T_(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const F_=function(e){return"number"==typeof e?"number:"+Sv(e):"string:"+e},O_=function(e){if(e.isLeafNode()){const t=e.val();As("string"==typeof t||"number"==typeof t||"object"==typeof t&&co(t,".sv"),"Priority must be a string or number.")}else As(e===N_||e.isEmpty(),"priority of unexpected type.");As(e===N_||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let M_,L_,U_;class q_{static set __childrenNodeConstructor(e){M_=e}static get __childrenNodeConstructor(){return M_}constructor(e,t=q_.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,As(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),O_(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new q_(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:q_.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return d_(e)?this:".priority"===s_(e)?this.priorityNode_:q_.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:q_.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=s_(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(As(".priority"!==n||1===o_(e),".priority must be the last token in a path"),this.updateImmediateChild(n,q_.__childrenNodeConstructor.EMPTY_NODE.updateChild(a_(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+F_(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Sv(this.value_):this.value_,this.lazyHash_=cv(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===q_.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof q_.__childrenNodeConstructor?-1:(As(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=q_.VALUE_TYPE_ORDER.indexOf(t),i=q_.VALUE_TYPE_ORDER.indexOf(n);return As(r>=0,"Unknown leaf type: "+t),As(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}q_.VALUE_TYPE_ORDER=["object","boolean","number","string"];const j_=new class extends C_{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?_v(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return k_.MIN}maxPost(){return new k_(vv,new q_("[PRIORITY-POST]",U_))}makePost(e,t){const n=L_(e);return new k_(t,new q_("[PRIORITY-POST]",n))}toString(){return".priority"}},V_=Math.log(2);class B_{constructor(e){this.count=(e=>parseInt(Math.log(e)/V_,10))(e+1),this.current_=this.count-1;const t=(n=this.count,parseInt(Array(n+1).join("1"),2));var n;this.bits_=e+1&t}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const z_=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new T_(a,o.node,T_.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=i(t,l),u=i(l+1,r);return o=e[l],a=n?n(o):o,new T_(a,o.node,T_.BLACK,c,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const c=i(s+1,a),u=e[s],h=n?n(u):u;l(new T_(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,T_.BLACK):(a(r,T_.BLACK),a(r,T_.RED))}return s}(new B_(e.length));return new A_(r||t,s)};let $_;const H_={};class G_{static get Default(){return As(H_&&j_,"ChildrenNode.ts has not been loaded"),$_=$_||new G_({".priority":H_},{".priority":j_}),$_}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=uo(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof A_?t:null}hasIndex(e){return co(this.indexSet_,e.toString())}addIndex(e,t){As(e!==S_,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(k_.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?z_(n,e.getCompare()):H_;const a=e.toString(),l={...this.indexSet_};l[a]=e;const c={...this.indexes_};return c[a]=s,new G_(c,l)}addToIndexes(e,t){const n=po(this.indexes_,(n,r)=>{const i=uo(this.indexSet_,r);if(As(i,"Missing index implementation for "+r),n===H_){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(k_.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),z_(n,i.getCompare())}return H_}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new k_(e.name,r))),i.insert(e,e.node)}});return new G_(n,this.indexSet_)}removeFromIndexes(e,t){const n=po(this.indexes_,n=>{if(n===H_)return n;{const r=t.get(e.name);return r?n.remove(new k_(e.name,r)):n}});return new G_(n,this.indexSet_)}}let W_;class K_{static get EMPTY_NODE(){return W_||(W_=new K_(new A_(R_),null,G_.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&O_(this.priorityNode_),this.children_.isEmpty()&&As(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||W_}updatePriority(e){return this.children_.isEmpty()?this:new K_(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?W_:t}}getChild(e){const t=s_(e);return null===t?this:this.getImmediateChild(t).getChild(a_(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(As(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new k_(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?W_:this.priorityNode_;return new K_(r,s,i)}}updateChild(e,t){const n=s_(e);if(null===n)return t;{As(".priority"!==s_(e)||1===o_(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(a_(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(j_,(s,o)=>{t[s]=o.val(e),n++,i&&K_.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1}),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+F_(this.getPriority().val())+":"),this.forEachChild(j_,(t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":cv(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new k_(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new k_(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new k_(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,k_.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,k_.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Q_?-1:0}withIndex(e){if(e===S_||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new K_(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===S_||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(j_),n=t.getIterator(j_);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===S_?null:this.indexMap_.get(e.toString())}}K_.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Q_=new class extends K_{constructor(){super(new A_(R_),K_.EMPTY_NODE,G_.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return K_.EMPTY_NODE}isEmpty(){return!1}};function Y_(e,t=null){if(null===e)return K_.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),As(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new q_(e,Y_(t));if(e instanceof Array){let n=K_.EMPTY_NODE;return Ev(e,(t,r)=>{if(co(e,t)&&"."!==t.substring(0,1)){const e=Y_(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(Y_(t))}{const n=[];let r=!1;if(Ev(e,(e,t)=>{if("."!==e.substring(0,1)){const i=Y_(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new k_(e,i)))}}),0===n.length)return K_.EMPTY_NODE;const i=z_(n,P_,e=>e.name,R_);if(r){const e=z_(n,j_.getCompare());return new K_(i,Y_(t),new G_({".priority":e},{".priority":j_}))}return new K_(i,Y_(t),G_.Default)}}Object.defineProperties(k_,{MIN:{value:new k_(bv,K_.EMPTY_NODE)},MAX:{value:new k_(vv,Q_)}}),E_.__EMPTY_NODE=K_.EMPTY_NODE,q_.__childrenNodeConstructor=K_,N_=Q_,U_=Q_,function(e){L_=e}(Y_);class J_ extends C_{constructor(e){super(),this.indexPath_=e,As(!d_(e)&&".priority"!==s_(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?_v(e.name,t.name):i}makePost(e,t){const n=Y_(e),r=K_.EMPTY_NODE.updateChild(this.indexPath_,n);return new k_(t,r)}maxPost(){const e=K_.EMPTY_NODE.updateChild(this.indexPath_,Q_);return new k_(vv,e)}toString(){return c_(this.indexPath_,0).join("/")}}const X_=new class extends C_{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?_v(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return k_.MIN}maxPost(){return k_.MAX}makePost(e,t){const n=Y_(e);return new k_(t,n)}toString(){return".value"}};function Z_(e){return{type:"value",snapshotNode:e}}function ex(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function tx(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function nx(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class rx{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){As(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(tx(t,o)):As(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(ex(t,n)):s.trackChildChange(nx(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(j_,(e,r)=>{t.hasChild(e)||n.trackChildChange(tx(e,r))}),t.isLeafNode()||t.forEachChild(j_,(t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(nx(t,r,i))}else n.trackChildChange(ex(t,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?K_.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class ix{constructor(e){this.indexedFilter_=new rx(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ix.getStartPost_(e),this.endPost_=ix.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new k_(t,n))||(n=K_.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=K_.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(K_.EMPTY_NODE);const i=this;return t.forEachChild(j_,(e,t)=>{i.matches(new k_(e,t))||(r=r.updateImmediateChild(e,K_.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class sx{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new ix(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new k_(t,n))||(n=K_.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=K_.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=K_.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(K_.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,K_.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;As(o.numChildren()===this.limit_,"");const a=new k_(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(nx(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(tx(t,e));const n=o.updateImmediateChild(t,K_.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(ex(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,a)>=0?(null!=i&&(i.trackChildChange(tx(l.name,l.node)),i.trackChildChange(ex(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,K_.EMPTY_NODE)):e}}class ox{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=j_}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return As(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return As(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:bv}hasEnd(){return this.endSet_}getIndexEndValue(){return As(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return As(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:vv}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return As(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===j_}copy(){const e=new ox;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ax(e){const t={};if(e.isDefault())return t;let n;if(e.index_===j_?n="$priority":e.index_===X_?n="$value":e.index_===S_?n="$key":(As(e.index_ instanceof J_,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=ao(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=ao(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+ao(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=ao(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+ao(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function lx(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==j_&&(t.i=e.index_.toString()),t}class cx extends e_{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(As(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=mv("p:rest:"),this.listens_={}}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=cx.getListenId_(e,n),o={};this.listens_[s]=o;const a=ax(e._queryParams);this.restRequest_(i+".json",a,(e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),uo(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}})}unlisten(e,t){const n=cx.getListenId_(e,t);delete this.listens_[n]}get(e){const t=ax(e._queryParams),n=e._path.toString(),r=new Gs;return this.restRequest_(n+".json",t,(e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+fo(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=oo(o.responseText)}catch(e){yv("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&yv("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()})}}class ux{constructor(){this.rootNode_=K_.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function hx(){return{value:null,children:new Map}}function dx(e,t,n){if(d_(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=s_(t);e.children.has(r)||e.children.set(r,hx()),dx(e.children.get(r),t=a_(t),n)}}function px(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,r)=>{px(r,new r_(t.toString()+"/"+e),n)})}class mx{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&Ev(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class gx{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new mx(e);const n=1e4+2e4*Math.random();Pv(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Ev(e,(e,r)=>{r>0&&co(this.statsToReport_,e)&&(t[e]=r,n=!0)}),n&&this.server_.reportStats(t),Pv(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var fx,yx;function wx(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(yx=fx||(fx={}))[yx.OVERWRITE=0]="OVERWRITE",yx[yx.MERGE=1]="MERGE",yx[yx.ACK_USER_WRITE=2]="ACK_USER_WRITE",yx[yx.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class bx{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=fx.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(d_(this.path)){if(null!=this.affectedTree.value)return As(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new r_(e));return new bx(i_(),t,this.revert)}}return As(s_(this.path)===e,"operationForChild called for unrelated child."),new bx(a_(this.path),this.affectedTree,this.revert)}}class vx{constructor(e,t){this.source=e,this.path=t,this.type=fx.LISTEN_COMPLETE}operationForChild(e){return d_(this.path)?new vx(this.source,i_()):new vx(this.source,a_(this.path))}}class _x{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=fx.OVERWRITE}operationForChild(e){return d_(this.path)?new _x(this.source,i_(),this.snap.getImmediateChild(e)):new _x(this.source,a_(this.path),this.snap)}}class xx{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=fx.MERGE}operationForChild(e){if(d_(this.path)){const t=this.children.subtree(new r_(e));return t.isEmpty()?null:t.value?new _x(this.source,i_(),t.value):new xx(this.source,i_(),t)}return As(s_(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new xx(this.source,a_(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class kx{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(d_(e))return this.isFullyInitialized()&&!this.filtered_;const t=s_(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Cx{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Dx(e,t,n,r,i,s){const o=r.filter(e=>e.type===n);o.sort((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ps("Should only compare child_ events.");const r=new k_(t.childName,t.snapshotNode),i=new k_(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)),o.forEach(n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach(i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))})})}function Ex(e,t){return{eventCache:e,serverCache:t}}function Sx(e,t,n,r){return Ex(new kx(t,n,r),e.serverCache)}function Ix(e,t,n,r){return Ex(e.eventCache,new kx(t,n,r))}function Tx(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ax(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Px;class Rx{static fromObject(e){let t=new Rx(null);return Ev(e,(e,n)=>{t=t.set(new r_(e),n)}),t}constructor(e,t=(()=>(Px||(Px=new A_(xv)),Px))()){this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:i_(),value:this.value};if(d_(e))return null;{const n=s_(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(a_(e),t);return null!=i?{path:h_(new r_(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(d_(e))return this;{const t=s_(e),n=this.children.get(t);return null!==n?n.subtree(a_(e)):new Rx(null)}}set(e,t){if(d_(e))return new Rx(t,this.children);{const n=s_(e),r=(this.children.get(n)||new Rx(null)).set(a_(e),t),i=this.children.insert(n,r);return new Rx(this.value,i)}}remove(e){if(d_(e))return this.children.isEmpty()?new Rx(null):new Rx(null,this.children);{const t=s_(e),n=this.children.get(t);if(n){const r=n.remove(a_(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Rx(null):new Rx(this.value,i)}return this}}get(e){if(d_(e))return this.value;{const t=s_(e),n=this.children.get(t);return n?n.get(a_(e)):null}}setTree(e,t){if(d_(e))return t;{const n=s_(e),r=(this.children.get(n)||new Rx(null)).setTree(a_(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Rx(this.value,i)}}fold(e){return this.fold_(i_(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((r,i)=>{n[r]=i.fold_(h_(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,i_(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(d_(e))return null;{const r=s_(e),i=this.children.get(r);return i?i.findOnPath_(a_(e),h_(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,i_(),t)}foreachOnPath_(e,t,n){if(d_(e))return this;{this.value&&n(t,this.value);const r=s_(e),i=this.children.get(r);return i?i.foreachOnPath_(a_(e),h_(t,r),n):new Rx(null)}}foreach(e){this.foreach_(i_(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(h_(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class Nx{constructor(e){this.writeTree_=e}static empty(){return new Nx(new Rx(null))}}function Fx(e,t,n){if(d_(t))return new Nx(new Rx(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=p_(i,t);return s=s.updateChild(o,n),new Nx(e.writeTree_.set(i,s))}{const r=new Rx(n),i=e.writeTree_.setTree(t,r);return new Nx(i)}}}function Ox(e,t,n){let r=e;return Ev(n,(e,n)=>{r=Fx(r,h_(t,e),n)}),r}function Mx(e,t){if(d_(t))return Nx.empty();{const n=e.writeTree_.setTree(t,new Rx(null));return new Nx(n)}}function Lx(e,t){return null!=Ux(e,t)}function Ux(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(p_(n.path,t)):null}function qx(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(j_,(e,n)=>{t.push(new k_(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new k_(e,n.value))}),t}function jx(e,t){if(d_(t))return e;{const n=Ux(e,t);return new Nx(null!=n?new Rx(n):e.writeTree_.subtree(t))}}function Vx(e){return e.writeTree_.isEmpty()}function Bx(e,t){return zx(i_(),e.writeTree_,t)}function zx(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((t,i)=>{".priority"===t?(As(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=zx(h_(e,t),i,n)}),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(h_(e,".priority"),r)),n}}function $x(e,t){return tk(t,e)}function Hx(e,t){if(e.snap)return f_(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&f_(h_(e.path,n),t))return!0;return!1}function Gx(e){return e.visible}function Wx(e,t,n){let r=Nx.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)f_(n,e)?(t=p_(n,e),r=Fx(r,t,s.snap)):f_(e,n)&&(t=p_(e,n),r=Fx(r,i_(),s.snap.getChild(t)));else{if(!s.children)throw Ps("WriteRecord should have .snap or .children");if(f_(n,e))t=p_(n,e),r=Ox(r,t,s.children);else if(f_(e,n))if(t=p_(e,n),d_(t))r=Ox(r,i_(),s.children);else{const e=uo(s.children,s_(t));if(e){const n=e.getChild(a_(t));r=Fx(r,i_(),n)}}}}}return r}function Kx(e,t,n,r,i){if(r||i){const s=jx(e.visibleWrites,t);if(!i&&Vx(s))return n;if(i||null!=n||Lx(s,i_())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(f_(e.path,t)||f_(t,e.path))};return Bx(Wx(e.allWrites,s,t),n||K_.EMPTY_NODE)}return null}{const r=Ux(e.visibleWrites,t);if(null!=r)return r;{const r=jx(e.visibleWrites,t);return Vx(r)?n:null!=n||Lx(r,i_())?Bx(r,n||K_.EMPTY_NODE):null}}}function Qx(e,t,n,r){return Kx(e.writeTree,e.treePath,t,n,r)}function Yx(e,t){return function(e,t,n){let r=K_.EMPTY_NODE;const i=Ux(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(j_,(e,t)=>{r=r.updateImmediateChild(e,t)}),r;if(n){const i=jx(e.visibleWrites,t);return n.forEachChild(j_,(e,t)=>{const n=Bx(jx(i,new r_(e)),t);r=r.updateImmediateChild(e,n)}),qx(i).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}return qx(jx(e.visibleWrites,t)).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function Jx(e,t,n,r){return function(e,t,n,r,i){As(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=h_(t,n);if(Lx(e.visibleWrites,s))return null;{const t=jx(e.visibleWrites,s);return Vx(t)?i.getChild(n):Bx(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Xx(e,t){return function(e,t){return Ux(e.visibleWrites,t)}(e.writeTree,h_(e.treePath,t))}function Zx(e,t,n){return function(e,t,n,r){const i=h_(t,n),s=Ux(e.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?Bx(jx(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function ek(e,t){return tk(h_(e.treePath,t),e.writeTree)}function tk(e,t){return{treePath:e,writeTree:t}}class nk{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;As("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),As(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,nx(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,tx(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ex(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ps("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,nx(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const rk=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class ik{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new kx(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Zx(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ax(this.viewCache_),i=function(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const l=jx(e.visibleWrites,t),c=Ux(l,i_());if(null!=c)a=c;else{if(null==n)return[];a=Bx(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function sk(e,t,n,r,i,s){const o=t.eventCache;if(null!=Xx(r,n))return t;{let a,l;if(d_(n))if(As(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ax(t),i=Yx(r,n instanceof K_?n:K_.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=Qx(r,Ax(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=s_(n);if(".priority"===c){As(1===o_(n),"Can't have a priority with additional path components");const i=o.getNode();l=t.serverCache.getNode();const s=Jx(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=a_(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=Jx(r,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else h=Zx(r,c,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),c,h,u,i,s):o.getNode()}}return Sx(t,a,o.isFullyInitialized()||d_(n),e.filter.filtersNodes())}}function ok(e,t,n,r,i,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(d_(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=s_(n);if(!l.isCompleteForPath(n)&&o_(n)>1)return t;const i=a_(n),s=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,i,rk,null)}const h=Ix(t,c,l.isFullyInitialized()||d_(n),u.filtersNodes());return sk(e,h,n,i,new ik(i,h,s),a)}function ak(e,t,n,r,i,s,o){const a=t.eventCache;let l,c;const u=new ik(i,t,s);if(d_(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=Sx(t,c,!0,e.filter.filtersNodes());else{const i=s_(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Sx(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=a_(n),c=a.getNode().getImmediateChild(i);let h;if(d_(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===l_(s)&&e.getChild(u_(s)).isEmpty()?e:e.updateChild(s,r):K_.EMPTY_NODE}l=c.equals(h)?t:Sx(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return l}function lk(e,t){return e.eventCache.isCompleteForChild(t)}function ck(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function uk(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=d_(n)?r:new Rx(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal((n,r)=>{if(u.hasChild(n)){const l=ck(0,t.serverCache.getNode().getImmediateChild(n),r);c=ok(e,c,new r_(n),l,i,s,o,a)}}),l.children.inorderTraversal((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=ck(0,t.serverCache.getNode().getImmediateChild(n),r);c=ok(e,c,new r_(n),l,i,s,o,a)}}),c}class hk{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new rx(n.getIndex()),i=(s=n).loadsAllData()?new rx(s.getIndex()):s.hasLimit()?new sx(s):new ix(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(K_.EMPTY_NODE,o.getNode(),null),c=i.updateFullNode(K_.EMPTY_NODE,a.getNode(),null),u=new kx(l,o.isFullyInitialized(),r.filtersNodes()),h=new kx(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Ex(h,u),this.eventGenerator_=new Cx(this.query_)}get query(){return this.query_}}function dk(e,t){const n=Ax(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!d_(t)&&!n.getImmediateChild(s_(t)).isEmpty())?n.getChild(t):null}function pk(e){return 0===e.eventRegistrations_.length}function mk(e,t,n){const r=[];if(n){As(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)})}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function gk(e,t,n,r){t.type===fx.MERGE&&null!==t.source.queryId&&(As(Ax(e.viewCache_),"We should always have a full cache before handling merges"),As(Tx(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=function(e,t,n,r,i){const s=new nk;let o,a;if(n.type===fx.OVERWRITE){const l=n;l.source.fromUser?o=ak(e,t,l.path,l.snap,r,i,s):(As(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!d_(l.path),o=ok(e,t,l.path,l.snap,r,i,a,s))}else if(n.type===fx.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach((r,l)=>{const c=h_(n,r);lk(t,s_(c))&&(a=ak(e,a,c,l,i,s,o))}),r.foreach((r,l)=>{const c=h_(n,r);lk(t,s_(c))||(a=ak(e,a,c,l,i,s,o))}),a}(e,t,l.path,l.children,r,i,s):(As(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=uk(e,t,l.path,l.children,r,i,a,s))}else if(n.type===fx.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=Xx(r,n))return t;{const a=new ik(r,t,i),l=t.eventCache.getNode();let c;if(d_(n)||".priority"===s_(n)){let n;if(t.serverCache.isFullyInitialized())n=Qx(r,Ax(t));else{const e=t.serverCache.getNode();As(e instanceof K_,"serverChildren would be complete if leaf node"),n=Yx(r,e)}c=e.filter.updateFullNode(l,n,s)}else{const i=s_(n);let u=Zx(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,a_(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,K_.EMPTY_NODE,a_(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Qx(r,Ax(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=Xx(r,i_()),Sx(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=Xx(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(d_(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ok(e,t,n,l.getNode().getChild(n),i,s,a,o);if(d_(n)){let r=new Rx(null);return l.getNode().forEachChild(S_,(e,t)=>{r=r.set(new r_(e),t)}),uk(e,t,n,r,i,s,a,o)}return t}{let c=new Rx(null);return r.foreach((e,t)=>{const r=h_(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))}),uk(e,t,n,c,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==fx.LISTEN_COMPLETE)throw Ps("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache;return sk(e,Ix(t,s.getNode(),s.isFullyInitialized()||d_(n),s.isFiltered()),n,r,rk,i)}(e,t,n.path,r,s)}const l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Tx(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Z_(Tx(t)))}}(t,o,l),{viewCache:o,changes:l}}(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,As(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),As(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),As(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,fk(e,s.changes,s.viewCache.eventCache.getNode(),null)}function fk(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach(t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}),Dx(e,i,"child_removed",t,r,n),Dx(e,i,"child_added",t,r,n),Dx(e,i,"child_moved",s,r,n),Dx(e,i,"child_changed",t,r,n),Dx(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let yk,wk;class bk{constructor(){this.views=new Map}}function vk(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return As(null!=s,"SyncTree gave us an op for an invalid query."),gk(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(gk(s,t,n,r));return i}}function _k(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=Qx(n,i?r:null),s=!1;e?s=!0:r instanceof K_?(e=Yx(n,r),s=!1):(e=K_.EMPTY_NODE,s=!1);const o=Ex(new kx(e,s,!1),new kx(r,i,!1));return new hk(t,o)}return o}function xk(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function kk(e,t){let n=null;for(const r of e.views.values())n=n||dk(r,t);return n}function Ck(e,t){if(t._queryParams.loadsAllData())return Sk(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Dk(e,t){return null!=Ck(e,t)}function Ek(e){return null!=Sk(e)}function Sk(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Ik=1;class Tk{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Rx(null),this.pendingWriteTree_={visibleWrites:Nx.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ak(e,t,n,r,i){return function(e,t,n,r,i){As(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Fx(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Lk(e,new _x({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Pk(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);As(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&Hx(t,r.path)?i=!1:f_(r.path,t.path)&&(s=!0)),o--}return!!i&&(s?(function(e){e.visibleWrites=Wx(e.allWrites,Gx,i_()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=Mx(e.visibleWrites,r.path):Ev(r.children,t=>{e.visibleWrites=Mx(e.visibleWrites,h_(r.path,t))}),!0))}(e.pendingWriteTree_,t)){let t=new Rx(null);return null!=r.snap?t=t.set(i_(),!0):Ev(r.children,e=>{t=t.set(new r_(e),!0)}),Lk(e,new bx(r.path,t,n))}return[]}function Rk(e,t,n){return Lk(e,new _x({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Nk(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||Dk(o,t))){const l=function(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=Ek(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(mk(i,n,r)),pk(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(mk(t,n,r)),pk(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!Ek(e)&&s.push(new(As(yk,"Reference.ts has not been loaded"),yk)(t._repo,t._path)),{removed:s,events:o}}(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const n=-1!==c.findIndex(e=>e._queryParams.loadsAllData()),i=e.syncPointTree_.findOnPath(s,(e,t)=>Ek(t));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold((e,t,n)=>{if(t&&Ek(t))return[Sk(t)];{let e=[];return t&&(e=xk(t)),Ev(n,(t,n)=>{e=e.concat(n)}),e}})}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=jk(e,r);e.listenProvider_.startListening(Gk(i),Vk(e,i),s.hashFn,s.onComplete)}}}if(!i&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(Gk(t),n)}else c.forEach(t=>{const n=e.queryToTagMap.get(Bk(t));e.listenProvider_.stopListening(Gk(t),n)})}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=Bk(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function Fk(e,t,n,r){const i=zk(e,r);if(null!=i){const r=$k(i),s=r.path,o=r.queryId,a=p_(s,t);return Hk(e,s,new _x(wx(o),a,n))}return[]}function Ok(e,t,n,r=!1){const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,(e,t)=>{const n=p_(e,i);s=s||kk(t,n),o=o||Ek(t)});let a,l=e.syncPointTree_.get(i);l?(o=o||Ek(l),s=s||kk(l,i_())):(l=new bk,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=s?a=!0:(a=!1,s=K_.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((e,t)=>{const n=kk(t,i_());n&&(s=s.updateImmediateChild(e,n))}));const c=Dk(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=Bk(t);As(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Ik++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=function(e,t,n,r,i,s){const o=_k(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(j_,(e,t)=>{r.push(ex(e,t))}),n.isFullyInitialized()&&r.push(Z_(n.getNode())),fk(e,r,n.getNode(),t)}(o,n)}(l,t,n,$x(e.pendingWriteTree_,i),s,a);if(!c&&!o&&!r){const n=Ck(l,t);u=u.concat(function(e,t,n){const r=t._path,i=Vk(e,t),s=jk(e,n),o=e.listenProvider_.startListening(Gk(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)As(!Ek(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold((e,t,n)=>{if(!d_(e)&&t&&Ek(t))return[Sk(t).query];{let e=[];return t&&(e=e.concat(xk(t).map(e=>e.query))),Ev(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Gk(r),Vk(e,r))}}return o}(e,t,n))}return u}function Mk(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(e,n)=>{const r=kk(n,p_(e,t));if(r)return r});return Kx(r,t,i,n,!0)}function Lk(e,t){return Uk(t,e.syncPointTree_,null,$x(e.pendingWriteTree_,i_()))}function Uk(e,t,n,r){if(d_(e.path))return qk(e,t,n,r);{const i=t.get(i_());null==n&&null!=i&&(n=kk(i,i_()));let s=[];const o=s_(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=ek(r,o);s=s.concat(Uk(a,l,e,t))}return i&&(s=s.concat(vk(i,e,r,n))),s}}function qk(e,t,n,r){const i=t.get(i_());null==n&&null!=i&&(n=kk(i,i_()));let s=[];return t.children.inorderTraversal((t,i)=>{const o=n?n.getImmediateChild(t):null,a=ek(r,t),l=e.operationForChild(t);l&&(s=s.concat(qk(l,i,o,a)))}),i&&(s=s.concat(vk(i,e,r,n))),s}function jk(e,t){const n=t.query,r=Vk(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||K_.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=zk(e,n);if(r){const n=$k(r),i=n.path,s=n.queryId,o=p_(i,t);return Hk(e,i,new vx(wx(s),o))}return[]}(e,n._path,r):function(e,t){return Lk(e,new vx({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Nk(e,n,null,r)}}}}function Vk(e,t){const n=Bk(t);return e.queryToTagMap.get(n)}function Bk(e){return e._path.toString()+"$"+e._queryIdentifier}function zk(e,t){return e.tagToQueryMap.get(t)}function $k(e){const t=e.indexOf("$");return As(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new r_(e.substr(0,t))}}function Hk(e,t,n){const r=e.syncPointTree_.get(t);return As(r,"Missing sync point for query tag that we're tracking"),vk(r,n,$x(e.pendingWriteTree_,t),null)}function Gk(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(As(wk,"Reference.ts has not been loaded"),wk)(e._repo,e._path):e}class Wk{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Wk(t)}node(){return this.node_}}class Kk{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=h_(this.path_,e);return new Kk(this.syncTree_,t)}node(){return Mk(this.syncTree_,this.path_)}}const Qk=function(e,t,n){return e&&"object"==typeof e?(As(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Yk(e[".sv"],t,n):"object"==typeof e[".sv"]?Jk(e[".sv"],t):void As(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Yk=function(e,t,n){if("timestamp"===e)return n.timestamp;As(!1,"Unexpected server value: "+e)},Jk=function(e,t,n){e.hasOwnProperty("increment")||As(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&As(!1,"Unexpected increment value: "+r);const i=t.node();if(As(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},Xk=function(e,t,n,r){return eC(t,new Kk(n,e),r)},Zk=function(e,t,n){return eC(e,new Wk(t),n)};function eC(e,t,n){const r=e.getPriority().val(),i=Qk(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Qk(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new q_(s,Y_(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new q_(i))),r.forEachChild(j_,(e,r)=>{const i=eC(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))}),s}}class tC{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function nC(e,t){let n=t instanceof r_?t:new r_(t),r=e,i=s_(n);for(;null!==i;){const e=uo(r.node.children,i)||{children:{},childCount:0};r=new tC(i,r,e),n=a_(n),i=s_(n)}return r}function rC(e){return e.node.value}function iC(e,t){e.node.value=t,cC(e)}function sC(e){return e.node.childCount>0}function oC(e,t){Ev(e.node.children,(n,r)=>{t(new tC(n,e,r))})}function aC(e,t,n,r){n&&!r&&t(e),oC(e,e=>{aC(e,t,!0,r)}),n&&r&&t(e)}function lC(e){return new r_(null===e.parent?e.name:lC(e.parent)+"/"+e.name)}function cC(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===rC(e)&&!sC(e)}(n),i=co(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,cC(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,cC(e))}(e.parent,e.name,e)}const uC=/[\[\].#$\/\u0000-\u001F\u007F]/,hC=/[\[\].#$\u0000-\u001F\u007F]/,dC=10485760,pC=function(e){return"string"==typeof e&&0!==e.length&&!uC.test(e)},mC=function(e){return"string"==typeof e&&0!==e.length&&!hC.test(e)},gC=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!wv(e)||e&&"object"==typeof e&&co(e,".sv")},fC=function(e,t,n){const r=n instanceof r_?new y_(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+b_(r));if("function"==typeof t)throw new Error(e+"contains a function "+b_(r)+" with contents = "+t.toString());if(wv(t))throw new Error(e+"contains "+t.toString()+" "+b_(r));if("string"==typeof t&&t.length>dC/3&&ko(t)>dC)throw new Error(e+"contains a string greater than "+dC+" utf8 bytes "+b_(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Ev(t,(t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!pC(t)))throw new Error(e+" contains an invalid key ("+t+") "+b_(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=ko(t),w_(e)}(r,t),fC(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=ko(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)}),n&&i)throw new Error(e+' contains ".value" child '+b_(r)+" in addition to actual children.")}},yC=function(e,t,n,r){if(!(r&&void 0===n||mC(n)))throw new Error(xo(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},wC=function(e,t){if(".info"===s_(t))throw new Error(e+" failed = Can't modify data under /.info/")};class bC{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function vC(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||g_(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function _C(e,t,n){vC(e,n),kC(e,e=>g_(e,t))}function xC(e,t,n){vC(e,n),kC(e,e=>f_(e,t)||f_(t,e))}function kC(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(CC(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function CC(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();hv&&pv("event: "+n.toString()),Av(r)}}}class DC{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new bC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=hx(),this.transactionQueueTree_=new tC,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function EC(e,t,n){if(e.stats_=Hv(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new cx(e.repoInfo_,(t,n,r,i)=>{TC(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>AC(e,!0),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ao(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new x_(e.repoInfo_,t,(t,n,r,i)=>{TC(e,t,n,r,i)},t=>{AC(e,t)},t=>{!function(e,t){Ev(t,(t,n)=>{PC(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(t){const n=t.toString();return $v[n]||($v[n]=new gx(e.stats_,e.server_)),$v[n]}(e.repoInfo_),e.infoData_=new ux,e.infoSyncTree_=new Tk({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Rk(e.infoSyncTree_,t._path,o),setTimeout(()=>{i("ok")},0)),s},stopListening:()=>{}}),PC(e,"connected",!1),e.serverSyncTree_=new Tk({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,(n,r)=>{const s=i(n,r);xC(e.eventQueue_,t._path,s)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function SC(e){const t=e.infoData_.getNode(new r_(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function IC(e){return(t=(t={timestamp:SC(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function TC(e,t,n,r,i){e.dataUpdateCount++;const s=new r_(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=po(n,e=>Y_(e));o=function(e,t,n,r){const i=zk(e,r);if(i){const r=$k(i),s=r.path,o=r.queryId,a=p_(s,t),l=Rx.fromObject(n);return Hk(e,s,new xx(wx(o),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Y_(n);o=Fk(e.serverSyncTree_,s,t,i)}else if(r){const t=po(n,e=>Y_(e));o=function(e,t,n){const r=Rx.fromObject(n);return Lk(e,new xx({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Y_(n);o=Rk(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=UC(e,s)),xC(e.eventQueue_,a,o)}function AC(e,t){PC(e,"connected",t),!1===t&&function(e){FC(e,"onDisconnectEvents");const t=IC(e),n=hx();px(e.onDisconnect_,i_(),(r,i)=>{const s=Xk(r,i,e.serverSyncTree_,t);dx(n,r,s)});let r=[];px(n,i_(),(t,n)=>{r=r.concat(Rk(e.serverSyncTree_,t,n));const i=zC(e,t);UC(e,i)}),e.onDisconnect_=hx(),xC(e.eventQueue_,i_(),r)}(e)}function PC(e,t,n){const r=new r_("/.info/"+t),i=Y_(n);e.infoData_.updateSnapshot(r,i);const s=Rk(e.infoSyncTree_,r,i);xC(e.eventQueue_,r,s)}function RC(e){return e.nextWriteId_++}function NC(e,t,n){let r;r=".info"===s_(t._path)?Nk(e.infoSyncTree_,t,n):Nk(e.serverSyncTree_,t,n),_C(e.eventQueue_,t._path,r)}function FC(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),pv(n,...t)}function OC(e,t,n,r){t&&Av(()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}})}function MC(e,t,n){return Mk(e.serverSyncTree_,t,n)||K_.EMPTY_NODE}function LC(e,t=e.transactionQueueTree_){if(t||BC(e,t),rC(t)){const n=jC(e,t);As(n.length>0,"Sending zero length transaction queue"),n.every(e=>0===e.status)&&function(e,t,n){const r=n.map(e=>e.currentWriteId),i=MC(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];As(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=p_(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,r=>{FC(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Pk(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();BC(e,nC(e.transactionQueueTree_,t)),LC(e,e.transactionQueueTree_),xC(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)Av(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{yv("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}UC(e,t)}},o)}(e,lC(t),n)}else sC(t)&&oC(t,t=>{LC(e,t)})}function UC(e,t){const n=qC(e,t),r=lC(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter(e=>0===e.status),o=s.map(e=>e.currentWriteId);for(let s=0;s<t.length;s++){const a=t[s],l=p_(n,a.path);let c,u=!1;if(As(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)u=!0,c=a.abortReason,i=i.concat(Pk(e.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status)if(a.retryCount>=25)u=!0,c="maxretry",i=i.concat(Pk(e.serverSyncTree_,a.currentWriteId,!0));else{const n=MC(e,a.path,o);a.currentInputSnapshot=n;const r=t[s].update(n.val());if(void 0!==r){fC("transaction failed: Data returned ",r,a.path);let t=Y_(r);"object"==typeof r&&null!=r&&co(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=a.currentWriteId,l=IC(e),c=Zk(t,n,l);a.currentOutputSnapshotRaw=t,a.currentOutputSnapshotResolved=c,a.currentWriteId=RC(e),o.splice(o.indexOf(s),1),i=i.concat(Ak(e.serverSyncTree_,a.path,c,a.currentWriteId,a.applyLocally)),i=i.concat(Pk(e.serverSyncTree_,s,!0))}else u=!0,c="nodata",i=i.concat(Pk(e.serverSyncTree_,a.currentWriteId,!0))}xC(e.eventQueue_,n,i),i=[],u&&(t[s].status=2,function(e){setTimeout(e,Math.floor(0))}(t[s].unwatcher),t[s].onComplete&&("nodata"===c?r.push(()=>t[s].onComplete(null,!1,t[s].currentInputSnapshot)):r.push(()=>t[s].onComplete(new Error(c),!1,null))))}BC(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)Av(r[e]);LC(e,e.transactionQueueTree_)}(e,jC(e,n),r),r}function qC(e,t){let n,r=e.transactionQueueTree_;for(n=s_(t);null!==n&&void 0===rC(r);)r=nC(r,n),n=s_(t=a_(t));return r}function jC(e,t){const n=[];return VC(e,t,n),n.sort((e,t)=>e.order-t.order),n}function VC(e,t,n){const r=rC(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);oC(t,t=>{VC(e,t,n)})}function BC(e,t){const n=rC(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,iC(t,n.length>0?n:void 0)}oC(t,t=>{BC(e,t)})}function zC(e,t){const n=lC(qC(e,t)),r=nC(e.transactionQueueTree_,t);return function(e,t){let n=e.parent;for(;null!==n;){if(t(n))return!0;n=n.parent}}(r,t=>{$C(e,t)}),$C(e,r),aC(r,t=>{$C(e,t)}),n}function $C(e,t){const n=rC(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(As(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(As(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Pk(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?iC(t,void 0):n.length=s+1,xC(e.eventQueue_,lC(t),i);for(let e=0;e<r.length;e++)Av(r[e])}}const HC=function(e,t){const n=GC(e),r=n.namespace;"firebase.com"===n.domain&&fv(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||fv("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&yv("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new jv(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new r_(n.pathString)}},GC=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):yv(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class WC{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ao(this.snapshot.exportVal())}}class KC{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class QC{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return As(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class YC{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return d_(this._path)?null:l_(this._path)}get ref(){return new JC(this._repo,this._path)}get _queryIdentifier(){const e=lx(this._queryParams),t=Cv(e);return"{}"===t?"default":t}get _queryObject(){return lx(this._queryParams)}isEqual(e){if(!((e=Co(e))instanceof YC))return!1;const t=this._repo===e._repo,n=g_(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class JC extends YC{constructor(e,t){super(e,t,new ox,!1)}get parent(){const e=u_(this._path);return null===e?null:new JC(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class XC{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new r_(e),n=eD(this.ref,e);return new XC(this._node.getChild(t),n,j_)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(t,n)=>e(new XC(n,eD(this.ref,t),j_)))}hasChild(e){const t=new r_(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ZC(e,t){return(e=Co(e))._checkNotDeleted("ref"),void 0!==t?eD(e._root,t):e._root}function eD(e,t){var n;return null===s_((e=Co(e))._path)?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yC("child","path",n,false)):yC("child","path",t,!1),new JC(e._repo,h_(e._path,t))}function tD(e,t){e=Co(e),wC("set",e._path),function(e,t,n,r){r&&void 0===t||fC(xo(e,"value"),t,n)}("set",t,e._path,!1);const n=new Gs;return function(e,t,n,r,i){FC(e,"set",{path:t.toString(),value:n,priority:r});const s=IC(e),o=Y_(n,r),a=Mk(e.serverSyncTree_,t),l=Zk(o,a,s),c=RC(e),u=Ak(e.serverSyncTree_,t,l,c,!0);vC(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),(n,r)=>{const s="ok"===n;s||yv("set at "+t+" failed: "+n);const o=Pk(e.serverSyncTree_,c,!s);xC(e.eventQueue_,t,o),OC(0,i,n,r)});const h=zC(e,t);UC(e,h),xC(e.eventQueue_,h,[])}(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function nD(e,t){!function(e,t,n,r){if(r&&void 0===t)return;const i=xo(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Ev(t,(e,t)=>{const r=new r_(e);if(fC(i,t,h_(n,r)),".priority"===l_(r)&&!gC(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)}),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=c_(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!pC(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(m_);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&f_(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)}("update",t,e._path,!1);const n=new Gs;return function(e,t,n,r){FC(e,"update",{path:t.toString(),value:n});let i=!0;const s=IC(e),o={};if(Ev(n,(n,r)=>{i=!1,o[n]=Xk(h_(t,n),Y_(r),e.serverSyncTree_,s)}),i)pv("update() called with empty data.  Don't do anything."),OC(0,r,"ok",void 0);else{const i=RC(e),s=function(e,t,n,r){!function(e,t,n,r){As(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Ox(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Rx.fromObject(n);return Lk(e,new xx({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,t,o,i);vC(e.eventQueue_,s),e.server_.merge(t.toString(),n,(n,s)=>{const o="ok"===n;o||yv("update at "+t+" failed: "+n);const a=Pk(e.serverSyncTree_,i,!o),l=a.length>0?UC(e,t):t;xC(e.eventQueue_,l,a),OC(0,r,n,s)}),Ev(n,n=>{const r=zC(e,h_(t,n));UC(e,r)}),xC(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function rD(e){e=Co(e);const t=new QC(()=>{}),n=new iD(t);return function(e,t,n){const r=function(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,(e,t)=>{const i=p_(e,n);r=r||kk(t,i)});let i=e.syncPointTree_.get(n);i?r=r||kk(i,i_()):(i=new bk,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new kx(r,!0,!1):null;return Tx(_k(i,t,$x(e.pendingWriteTree_,t._path),s?o.getNode():K_.EMPTY_NODE,s).viewCache_)}(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then(r=>{const i=Y_(r).withIndex(t._queryParams.getIndex());let s;if(Ok(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=Rk(e.serverSyncTree_,t._path,i);else{const n=Vk(e.serverSyncTree_,t);s=Fk(e.serverSyncTree_,t._path,i,n)}return xC(e.eventQueue_,t._path,s),Nk(e.serverSyncTree_,t,n,null,!0),i},n=>(FC(e,"get for query "+ao(t)+" failed: "+n),Promise.reject(new Error(n))))}(e._repo,e,n).then(t=>new XC(t,new JC(e._repo,e._path),e._queryParams.getIndex()))}class iD{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new WC("value",this,new XC(e.snapshotNode,new JC(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new KC(this,e,t):null}matches(e){return e instanceof iD&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class sD{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new KC(this,e,t):null}createEvent(e,t){As(null!=e.childName,"Child events should have a childName.");const n=eD(new JC(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new WC(e.type,this,new XC(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof sD&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function oD(e,t,n,r){return function(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{NC(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new QC(n,s||void 0),a="value"===t?new iD(o):new sD(t,o);return function(e,t,n){let r;r=".info"===s_(t._path)?Ok(e.infoSyncTree_,t,n):Ok(e.serverSyncTree_,t,n),_C(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>NC(e._repo,e,a)}(e,"value",t,n,r)}!function(e){As(!yk,"__referenceConstructor has already been defined"),yk=e}(JC),function(e){As(!wk,"__referenceConstructor has already been defined"),wk=e}(JC);const aD={};function lD(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||fv("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),pv("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,l=HC(s,i),c=l.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${c.namespace}`,l=HC(s,i),c=l.repoInfo):o=!l.repoInfo.secure;const u=i&&o?new Fv(Fv.OWNER):new Nv(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!pC(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),mC(e)}(n))throw new Error(xo(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",l),d_(l.path)||fv("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=aD[t.name];i||(i={},aD[t.name]=i);let s=i[e.toURLString()];return s&&fv("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new DC(e,false,n,r),i[e.toURLString()]=s,s}(c,e,u,new Rv(e,n));return new cD(h,e)}class cD{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(EC(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new JC(this._repo,i_())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=aD[t];n&&n[e.key]===e||fv(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&fv("Cannot call "+e+" on a deleted database.")}}class uD{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function hD(e,t,n){if(e=Co(e),wC("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const r=n?.applyLocally??!0,i=new Gs,s=oD(e,()=>{});return function(t,n,r,s,o,a){FC(t,"transaction on "+n);const l={path:n,update:r,onComplete:(t,n,r)=>{let s=null;t?i.reject(t):(s=new XC(r,new JC(e._repo,e._path),j_),i.resolve(new uD(n,s)))},status:null,order:lv(),applyLocally:a,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=MC(t,n,void 0);l.currentInputSnapshot=c;const u=l.update(c.val());if(void 0===u)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{fC("transaction failed: Data returned ",u,l.path),l.status=0;const e=nC(t.transactionQueueTree_,n),r=rC(e)||[];let i;r.push(l),iC(e,r),"object"==typeof u&&null!==u&&co(u,".priority")?(i=uo(u,".priority"),As(gC(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(Mk(t.serverSyncTree_,n)||K_.EMPTY_NODE).getPriority().val();const s=IC(t),o=Y_(u,i),a=Zk(o,c,s);l.currentOutputSnapshotRaw=o,l.currentOutputSnapshotResolved=a,l.currentWriteId=RC(t);const h=Ak(t.serverSyncTree_,n,a,l.currentWriteId,l.applyLocally);xC(t.eventQueue_,n,h),LC(t,t.transactionQueueTree_)}}(e._repo,e._path,t,0,s,r),i.promise}x_.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},x_.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},tv=qa,Fa(new Do("database",(e,{instanceIdentifier:t})=>lD(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),Ba(Zb,ev,void 0),Ba(Zb,ev,"esm2020");const dD=function(e=Va(),t){const n=Oa(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=zs("database");e&&function(e,t,n,r={}){(e=Co(e))._checkNotDeleted("useEmulator");const i=`${t}:${n}`,s=e._repoInternal;if(e._instanceStarted){if(i===e._repoInternal.repoInfo_.host&&mo(r,s.repoInfo_.emulatorOptions))return;fv("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&fv('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Fv(Fv.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:Qs(r.mockUserToken,e.app.options.projectId);o=new Fv(t)}Ws(t)&&(Ks(t),Xs("Database",!0)),function(e,t,n,r){const i=t.lastIndexOf(":"),s=Ws(t.substring(0,i));e.repoInfo_=new jv(t,s,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}(s,i,r,o)}(n,...e)}return n}(Gb,Hb.databaseURL),pD=e=>{if(!e||"object"!=typeof e)return;const t=e;Object.keys(t).forEach(e=>{const n=t[e];void 0!==n?pD(n):delete t[e]})},mD=e=>ZC(dD,`rooms/${e}`),gD=e=>e.trim().slice(0,50),fD=async(e,t)=>{const n=mD(e),r=(await new Promise((e,t)=>{oD(n,e,{onlyOnce:!0}),setTimeout(()=>t(new Error("Timeout reading room")),5e3)})).val();if(!r)throw new Error("Room not found");if(r.hostId!==t)throw new Error("Not host");if("countdown"!==r.status)throw new Error("Room not in countdown");const i=Date.now(),s={[`rooms/${e}/status`]:"in-progress",[`rooms/${e}/startedAt`]:i,[`rooms/${e}/countdown`]:null,[`rooms/${e}/lastUpdatedAt`]:i};Object.keys(r.players||{}).forEach(t=>{s[`rooms/${e}/players/${t}/readyInLobbyAt`]=null}),Object.entries(r.squads||{}).forEach(([t,n])=>{Object.keys(n.members||{}).forEach(n=>{s[`rooms/${e}/squads/${t}/members/${n}/readyInLobbyAt`]=null})}),await nD(ZC(dD),s)},yD=e=>e?(e.contributions=e.contributions||{items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0},e.contributions):{items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0},wD=e=>{const t=Object.values(e.squads||{}).map(e=>({squadId:e.id,squadName:e.name,score:e.score||0,durationSeconds:e.durationSeconds,placement:0}));return t.sort((e,t)=>t.score!==e.score?t.score-e.score:(e.durationSeconds??Number.MAX_SAFE_INTEGER)!==(t.durationSeconds??Number.MAX_SAFE_INTEGER)?(e.durationSeconds??Number.MAX_SAFE_INTEGER)-(t.durationSeconds??Number.MAX_SAFE_INTEGER):e.squadName.localeCompare(t.squadName)),t.forEach((e,t)=>{e.placement=t+1}),t};let bD=0,vD=null,_D=null;const xD=async(e,t)=>{const n=Date.now();if(n-bD<5e3)return vD={roomCode:e,elapsedSeconds:t},void(_D||(_D=setTimeout(()=>{vD&&(xD(vD.roomCode,vD.elapsedSeconds).catch(()=>{}),vD=null),_D=null},5e3-(n-bD))));try{const n=ZC(dD,`rooms/${e}`);await nD(n,{currentElapsedSeconds:t,lastUpdatedAt:Date.now()}),bD=Date.now(),vD=null,_D&&(clearTimeout(_D),_D=null)}catch(e){console.error("[RoomService] updateGameTime error",e),bD=0}},kD=(e,t)=>{console.log("[roomService]  subscribeToRoom called for:",e);const n=mD(e),r=oD(n,e=>{const n=e.val();console.log("[roomService]  onValue callback triggered, data:",n?"found":"null"),n&&(console.log("[roomService]  Room data keys:",Object.keys(n)),console.log("[roomService]  Room name:",n.roomName)),t(n??null)},e=>{console.error("[roomService]  onValue error:",e),console.error("[roomService]  Error code:",e.code),console.error("[roomService]  Error message:",e.message),t(null)},{onlyOnce:!1});return rD(n).then(e=>{const n=e.val();console.log("[roomService]  Initial room data fetch:",n?"found":"null"),n&&(console.log("[roomService]  Initial fetch - Room data keys:",Object.keys(n)),t(n))}).catch(e=>{console.warn("[roomService]  Error fetching initial room data (onValue will handle):",e.code||e.message)}),()=>{console.log("[roomService]  Unsubscribing from room:",e),function(e,t,n){let r=null;const i=n?new QC(n):null;r=new iD(i),NC(e._repo,e,r)}(n,0,r)}};var CD=ve('<div data-gamehud class="fixed left-5 top-5 z-[100021]"role=status aria-live=polite style="z-index:100021 !important;position:fixed !important;left:20px !important;top:20px !important;transform:none !important"><div class="rounded-2xl border-2 border-blue-600 bg-white/98 px-4 py-3 shadow-2xl backdrop-blur-md"style="background:rgba(255, 255, 255, 1) !important;border:3px solid rgb(37, 99, 235) !important;box-shadow:0 25px 50px -12px rgba(0, 0, 0, 0.5) !important;min-width:250px !important;min-height:80px !important;padding:16px 20px !important;display:block !important;visibility:visible !important;opacity:1 !important"><div class="flex items-center justify-between gap-6"style="display:flex !important;visibility:visible !important;opacity:1 !important;width:100% !important;gap:24px !important;align-items:center !important"><div style="display:flex !important;flex-direction:column !important;visibility:visible !important;opacity:1 !important;flex:1 !important"><p style="color:#475569 !important;margin:0 0 6px 0 !important;padding:0 !important;display:block !important;visibility:visible !important;opacity:1 !important;font-size:11px !important;line-height:1.2 !important;font-weight:700 !important;text-transform:uppercase !important;letter-spacing:0.1em !important;font-family:system-ui, -apple-system, sans-serif !important">Skor</p><p style="color:#2563eb !important;line-height:1.2 !important;display:block !important;visibility:visible !important;opacity:1 !important;font-size:32px !important;font-weight:900 !important;margin:0 !important;padding:0 !important;font-family:system-ui, -apple-system, sans-serif !important;text-shadow:0 2px 4px rgba(0,0,0,0.1) !important;min-height:38px !important"></p></div><div class="flex flex-col items-end"style="display:flex !important;visibility:visible !important;opacity:1 !important;flex-direction:column !important;align-items:flex-end !important"><p style="color:#475569 !important;margin:0 0 6px 0 !important;padding:0 !important;display:block !important;visibility:visible !important;opacity:1 !important;font-size:11px !important;line-height:1.2 !important;font-weight:700 !important;text-transform:uppercase !important;letter-spacing:0.1em !important;font-family:system-ui, -apple-system, sans-serif !important">Waktu</p><p style="color:#0f172a !important;line-height:1.2 !important;display:block !important;visibility:visible !important;opacity:1 !important;font-size:24px !important;font-weight:900 !important;font-family:\'Courier New\', monospace !important;margin:0 !important;padding:0 !important;text-shadow:0 2px 4px rgba(0,0,0,0.1) !important;min-height:28px !important;min-width:80px !important">');const DD=e=>{const[t,n]=D(0),[r,i]=D("00:00:00"),[s,o]=D(null),[a,l]=D(!1);let c=null,u=null,h=null,d=null,p=null;const m=()=>{if("undefined"==typeof window)return!1;try{const e=window.location.pathname;return!(!e.includes("game.html")&&!e.endsWith("/game"))||!0===window.__soloMode}catch{return!1}},g=e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=e%60;return`${t.toString().padStart(2,"0")}.${n.toString().padStart(2,"0")}.${r.toString().padStart(2,"0")}`},f=e=>{if("in-progress"===e.status&&e.startedAt){const t=Math.floor((Date.now()-e.startedAt)/1e3),n=g(t);i(n),console.log("[GameHUD]  Time updated:",n,"elapsedSeconds:",t,"startedAt:",e.startedAt)}else i("00.00.00"),console.log("[GameHUD]  Time reset - status:",e.status,"startedAt:",e.startedAt)},y=e=>{const t=localStorage.getItem("userId")??"";console.log("[GameHUD]  Updating squad score - userId:",t),console.log("[GameHUD]  Room players:",e.players),console.log("[GameHUD]  Room squads:",e.squads);const r=e.players?.[t];if(console.log("[GameHUD]  Player found:",r),r&&r.squadId){console.log("[GameHUD]  Player squadId:",r.squadId);const t=e.squads?.[r.squadId];if(console.log("[GameHUD]  Squad found:",t),t){const e=t.points||t.score||0;n(e),console.log("[GameHUD]  Squad score updated:",e,"(from points:",t.points,", score:",t.score,")")}else n(0),console.log("[GameHUD]  Squad not found, score set to 0")}else n(0),console.log("[GameHUD]  Player not found or no squadId, score set to 0")};R(()=>{window.forceGameHUDVisible=()=>{console.log("[GameHUD]  Force visibility called");const e=document.querySelector("[data-gamehud]");if(e){e.style.setProperty("display","flex","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("z-index","100021","important"),e.style.setProperty("position","fixed","important"),e.style.setProperty("pointer-events","auto","important");const n=e.querySelectorAll("p");if(n.length>=4){const e=n[1],i=n[3];e&&(e.textContent=String(t()??0),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important")),i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}console.log("[GameHUD]  Forced visible via window function")}};const a=()=>{h&&(h(),h=null);const e=localStorage.getItem("activeRoomCode");e?(console.log("[GameHUD]  Subscribing to room:",e),h=kD(e,e=>{e?(console.log("[GameHUD]  Room data received, status:",e.status,"startedAt:",e.startedAt,"squads:",e.squads,"players:",e.players),o(e),l("in-progress"===e.status),y(e),f(e),setTimeout(()=>{w()&&v()},100)):(o(null),l(!1),n(0),i("00.00.00"))})):console.log("[GameHUD]  No active room code found")};if(m())console.log("[GameHUD]  Solo mode detected, skipping room subscription");else{a();const e=e=>{"activeRoomCode"===e.key&&(console.log("[GameHUD]  Room code changed, re-subscribing..."),a())};window.addEventListener("storage",e);const t=()=>{console.log("[GameHUD]  Room code changed via event, re-subscribing..."),a()};window.addEventListener("room:code-changed",t);const n=e=>{const t=e;t.detail?.roomCode&&(console.log("[GameHUD]  Room created event received, re-subscribing..."),a())};window.addEventListener("room:created",n),u=window.setInterval(()=>{const e=localStorage.getItem("activeRoomCode");e!==window.__lastGameHUDRoomCode&&(window.__lastGameHUDRoomCode=e,console.log("[GameHUD]  Room code changed (polling), re-subscribing..."),a())},2e3)}if(m()?console.log("[GameHUD]  Solo mode detected, skipping multiplayer timer interval"):c=window.setInterval(()=>{const e=s();if(e&&"in-progress"===e.status&&e.startedAt){f(e);const n=document.querySelector("[data-gamehud]");if(n){const e=n.querySelectorAll("p");if(e.length>=4){const n=e[1],i=e[3];n&&(n.textContent=String(t()??0),n.style.setProperty("display","block","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important")),i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}}}},1e3),m()&&e.visible&&(console.log("[GameHUD]  Solo mode detected, starting solo timer and score tracking..."),window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[GameHUD]  Solo timer started via gameProgress")),null===d&&(d=Date.now(),console.log("[GameHUD]  Solo timer started locally"))),m()){const e=()=>{let e=0;if(window.gameProgress&&"function"==typeof window.gameProgress.getState){const t=window.gameProgress.getState();if(t&&"number"==typeof t.elapsedMs){e=t.elapsedMs;const n=Math.floor(e/1e3),r=(e=>{if(window.gameProgress&&"function"==typeof window.gameProgress.formatElapsed)return window.gameProgress.formatElapsed(e).replace(/:/g,".");const t=Math.floor(e/1e3);return g(t)})(e);i(r),console.log("[GameHUD]  Updating time:",r,"elapsedMs:",e,"elapsedSeconds:",n)}t&&"number"==typeof t.score&&n(t.score)}else if(null!==d){e=Date.now()-d;const t=Math.floor(e/1e3);i(g(t))}const s=document.querySelector("[data-gamehud]");if(s){const e=s.querySelectorAll("p");if(e.length>=4){const n=e[1],i=e[3];if(n){const e=t();n.textContent=String(e??0),n.style.setProperty("display","block","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important")}i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}}},s=e=>{if(e.detail&&("number"==typeof e.detail.score&&n(e.detail.score),e.detail.elapsedMs)){const t=Math.floor(e.detail.elapsedMs/1e3);i(g(t))}};window.addEventListener("gameProgress:update",s),window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[GameHUD]  Solo timer started via gameProgress")),null===d&&(d=Date.now(),console.log("[GameHUD]  Solo timer started locally")),e(),p=window.setInterval(()=>{e();const n=document.querySelector("[data-gamehud]");if(n){n.style.setProperty("display","flex","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important"),n.style.setProperty("z-index","100021","important"),n.style.setProperty("position","fixed","important"),n.style.setProperty("top","20px","important"),n.style.setProperty("left","20px","important"),n.style.setProperty("transform","none","important"),n.style.setProperty("will-change","auto","important"),n.style.setProperty("pointer-events","auto","important");const e=n.querySelectorAll("p");if(e.length>=4){const n=e[1],i=e[3];n&&(n.textContent=String(t()??0),n.style.setProperty("display","block","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important")),i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}}},100),console.log("[GameHUD]  Solo mode timer and score tracking started - timer will NOT stop when settings opens")}I(()=>{m()&&(window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[GameHUD]  Solo timer started when visible changed (settings may be open)")),null===d&&(d=Date.now(),console.log("[GameHUD]  Solo timer started locally when visible changed")))});const _=()=>{if(!e.visible&&!m()){const e=document.querySelector("[data-gamehud]");return void(e&&(e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important"),e.style.setProperty("opacity","0","important")))}if(m()&&!e.visible){const e=document.querySelector("[data-gamehud]");return void(e&&(e.style.setProperty("display","flex","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("z-index","100021","important"),e.style.setProperty("position","fixed","important"),e.style.setProperty("top","20px","important"),e.style.setProperty("left","20px","important"),e.style.setProperty("pointer-events","auto","important")))}const t=document.querySelector("[data-gamehud]");if(t){t.parentElement&&t.parentElement!==document.body&&(console.log("[GameHUD]  Element is not direct child of body, moving to body..."),document.body.appendChild(t),console.log("[GameHUD]  Moved to body")),t.style.setProperty("z-index","100021","important"),t.style.setProperty("visibility","visible","important"),t.style.setProperty("opacity","1","important"),t.style.setProperty("pointer-events","auto","important"),t.style.setProperty("position","fixed","important"),t.style.setProperty("display","flex","important"),t.style.setProperty("left","20px","important"),t.style.setProperty("top","20px","important"),t.style.setProperty("transform","none","important"),t.style.setProperty("width","auto","important"),t.style.setProperty("height","auto","important"),t.style.removeProperty("transform");const e=t.getBoundingClientRect(),n=window.getComputedStyle(t),r=t.querySelector("div"),i=r?.getBoundingClientRect(),s=r?window.getComputedStyle(r):null;if(console.log("[GameHUD]  Element check:",{inDOM:!!t,parent:t.parentElement?.tagName,rect:{top:e.top,left:e.left,width:e.width,height:e.height},zIndex:n.zIndex,visibility:n.visibility,opacity:n.opacity,display:n.display,position:n.position,inViewport:e.top>=0&&e.left>=0&&e.bottom<=window.innerHeight&&e.right<=window.innerWidth,innerDiv:{exists:!!r,rect:i?{top:i.top,left:i.left,width:i.width,height:i.height}:null,display:s?.display,visibility:s?.visibility,opacity:s?.opacity,backgroundColor:s?.backgroundColor},textContent:t.textContent?.substring(0,50)}),r){r.style.setProperty("background","rgba(255, 255, 255, 0.98)","important"),r.style.setProperty("border","2px solid rgb(37, 99, 235)","important"),r.style.setProperty("box-shadow","0 25px 50px -12px rgba(0, 0, 0, 0.25)","important"),r.style.setProperty("display","block","important"),r.style.setProperty("visibility","visible","important"),r.style.setProperty("opacity","1","important"),r.style.setProperty("width","100%","important"),r.style.setProperty("height","auto","important"),r.style.setProperty("min-width","200px","important"),r.style.setProperty("padding","12px 16px","important");const e=r.querySelectorAll("p");console.log("[GameHUD]  Found text elements:",e.length),e.forEach((e,t)=>{const n=e;n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important"),n.style.setProperty("display","block","important"),n.style.setProperty("margin","0","important"),n.style.setProperty("padding","0","important"),n.style.setProperty("line-height","1.2","important");const r=t%2==0?"rgb(71, 85, 105)":1===t?"rgb(37, 99, 235)":"rgb(15, 23, 42)";n.style.setProperty("color",r,"important");const i=n.textContent||"";console.log(`[GameHUD]  Text element ${t} styles applied:`,i.substring(0,30),"color:",r);const s=window.getComputedStyle(n);console.log(`[GameHUD]  Text element ${t} computed styles:`,{display:s.display,visibility:s.visibility,opacity:s.opacity,color:s.color,fontSize:s.fontSize,textContent:i.substring(0,30)})})}else console.warn("[GameHUD]  Inner div not found!")}else console.warn("[GameHUD]  Element not found in DOM!")};e.visible||m()?e.visible?(setTimeout(_,50),setTimeout(_,100),setTimeout(_,200),setTimeout(_,500),setTimeout(_,1e3),setTimeout(_,2e3),setTimeout(_,3e3),setTimeout(_,5e3)):_():m()||_(),N(()=>{null!==c&&clearInterval(c),null!==u&&clearInterval(u),null!==b&&clearInterval(b),null===p||m()||clearInterval(p),h&&h(),window.removeEventListener("storage",handleStorageChange),window.removeEventListener("room:code-changed",handleRoomCodeChange),window.removeEventListener("room:created",handleRoomCreated)})}),I(()=>{const e=s(),o=t(),a=r(),c=m();if(console.log("[GameHUD]  createEffect triggered, room:",e?"exists":"null","status:",e?.status,"score:",o,"time:",a,"soloMode:",c),c){if(window.gameProgress&&"function"==typeof window.gameProgress.getState){const e=window.gameProgress.getState();if(e){if(void 0!==e.elapsedMs){const t=Math.floor(e.elapsedMs/1e3);i(g(t))}"number"==typeof e.score&&n(e.score)}}l(!0),setTimeout(()=>{v();const e=document.querySelector("[data-gamehud]");if(e){const n=e.querySelectorAll("p");if(n.length>=4){const e=n[1],i=n[3];if(e){const n=t();e.textContent=String(n??0),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important")}i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}}},0),setTimeout(()=>v(),100),setTimeout(()=>v(),300),setTimeout(()=>v(),500)}else e?(l("in-progress"===e.status),console.log("[GameHUD]  Updating score and time from createEffect, isInProgress:","in-progress"===e.status),y(e),f(e),"in-progress"===e.status&&(setTimeout(()=>{v();const e=document.querySelector("[data-gamehud]");if(e){const n=e.querySelectorAll("p");if(n.length>=4){const e=n[1],i=n[3];e&&(e.textContent=String(t()??0),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important")),i&&(i.textContent=r()||"00.00.00",i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"))}}},0),setTimeout(()=>v(),100),setTimeout(()=>v(),300),setTimeout(()=>v(),500))):(l(!1),console.log("[GameHUD]  No room data and not solo mode, resetting score and time"),n(0),i("00.00.00"))}),I(()=>{if(e.visible)console.log("[GameHUD]  Visible changed to true, triggering checkAndFix..."),setTimeout(()=>{checkAndFix()},0),setTimeout(()=>{checkAndFix()},50),setTimeout(()=>{checkAndFix()},100),setTimeout(()=>{checkAndFix()},200),setTimeout(()=>{checkAndFix()},500);else if(m()){console.log("[GameHUD]  Visible changed to false in solo mode, but keeping GameHUD visible for timer");const e=document.querySelector("[data-gamehud]");e&&(e.style.setProperty("display","flex","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("z-index","100021","important"),e.style.setProperty("pointer-events","auto","important"))}else{console.log("[GameHUD]  Visible changed to false, hiding GameHUD...");const e=document.querySelector("[data-gamehud]");e&&(e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important"),e.style.setProperty("opacity","0","important"),e.style.setProperty("pointer-events","none","important"))}}),I(()=>{e.visible&&(v(),setTimeout(()=>v(),0),setTimeout(()=>v(),50),setTimeout(()=>v(),100),setTimeout(()=>v(),200),setTimeout(()=>v(),500),setTimeout(()=>v(),1e3))});const w=T(()=>m()?e.visible:e.visible&&a());I(()=>{m()&&e.visible&&window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[GameHUD]  Ensuring timer keeps running (settings may be open)"))});let b=null;const v=()=>{const n=document.querySelector("[data-gamehud]");if(!n)return void console.log("[GameHUD]  Element not found in DOM");const i=w(),s=e.visible,o=a();if(m()?e.visible:i){n.style.cssText="z-index: 100021 !important; position: fixed !important; left: 20px !important; top: 20px !important; width: auto !important; height: auto !important; display: flex !important; visibility: visible !important; opacity: 1 !important; pointer-events: auto !important; transform: none !important;",n.removeAttribute("data-hidden-by"),n.parentElement!==document.body&&(console.log("[GameHUD]  Moving element to body"),document.body.appendChild(n));const e=n.querySelector("div");e&&(e.style.cssText="background: rgba(255, 255, 255, 1) !important; border: 3px solid rgb(37, 99, 235) !important; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5) !important; min-width: 250px !important; min-height: 80px !important; padding: 16px 20px !important; display: block !important; visibility: visible !important; opacity: 1 !important;",e.removeAttribute("data-hidden-by"));const a=n.querySelector(".flex.items-center.justify-between");a&&(a.style.cssText="display: flex !important; visibility: visible !important; opacity: 1 !important; width: 100% !important; gap: 24px !important; align-items: center !important;",a.removeAttribute("data-hidden-by"));const l=n.querySelectorAll("p");console.log("[GameHUD]  Found text elements:",l.length),l.forEach((e,n)=>{const i=e;i.removeAttribute("data-hidden-by");const s=i.textContent||i.innerText;if(console.log(`[GameHUD]  Text element ${n}: "${s}"`),0===n)i.textContent="Skor",i.style.cssText="color: #475569 !important; margin: 0 0 6px 0 !important; padding: 0 !important; display: block !important; visibility: visible !important; opacity: 1 !important; font-size: 11px !important; line-height: 1.2 !important; font-weight: 700 !important; text-transform: uppercase !important; letter-spacing: 0.1em !important; font-family: system-ui, -apple-system, sans-serif !important;";else if(1===n){const e=t()??0;i.textContent=String(e),i.style.cssText="color: #2563eb !important; line-height: 1.2 !important; display: block !important; visibility: visible !important; opacity: 1 !important; font-size: 32px !important; font-weight: 900 !important; margin: 0 !important; padding: 0 !important; font-family: system-ui, -apple-system, sans-serif !important; text-shadow: 0 2px 4px rgba(0,0,0,0.1) !important; min-height: 38px !important;"}else if(2===n)i.textContent="Waktu",i.style.cssText="color: #475569 !important; margin: 0 0 6px 0 !important; padding: 0 !important; display: block !important; visibility: visible !important; opacity: 1 !important; font-size: 11px !important; line-height: 1.2 !important; font-weight: 700 !important; text-transform: uppercase !important; letter-spacing: 0.1em !important; font-family: system-ui, -apple-system, sans-serif !important;";else if(3===n){const e=r()||"00.00.00";i.textContent=e,i.style.cssText='color: #0f172a !important; line-height: 1.2 !important; display: block !important; visibility: visible !important; opacity: 1 !important; font-size: 24px !important; font-weight: 900 !important; font-family: "Courier New", monospace !important; margin: 0 !important; padding: 0 !important; text-shadow: 0 2px 4px rgba(0,0,0,0.1) !important; min-height: 28px !important; min-width: 80px !important;'}i.style.setProperty("display","block","important"),i.style.setProperty("visibility","visible","important"),i.style.setProperty("opacity","1","important"),i.style.setProperty("color",i.style.color||"#000000","important"),0!==n||i.textContent?1===n?i.innerHTML=String(t()??0):2!==n||i.textContent?3===n&&(i.innerHTML=r()||"00.00.00"):i.innerHTML="Waktu":i.innerHTML="Skor"}),console.log("[GameHUD]  FORCED VISIBLE - shouldShow:",i,"visible:",s,"isInProgress:",o,"textElements:",l.length,"score:",t(),"time:",r())}else m()?(console.log("[GameHUD]  shouldShow false in solo mode, but keeping visible for timer"),n.style.setProperty("display","flex","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important"),n.style.setProperty("z-index","100021","important")):(n.style.setProperty("display","none","important"),n.style.setProperty("visibility","hidden","important"),n.style.setProperty("opacity","0","important"))};return I(()=>{const n=w(),i=(e.visible,a(),t()),s=r(),o=m()?e.visible:n;return v(),setTimeout(()=>{const e=document.querySelector("[data-gamehud]");if(e&&o){const t=e.querySelectorAll("p");if(t.length>=4){const e=t[1],n=t[3];e&&(e.textContent=String(i??0),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("color","#2563eb","important")),n&&(n.textContent=s||"00.00.00",n.style.setProperty("display","block","important"),n.style.setProperty("visibility","visible","important"),n.style.setProperty("opacity","1","important"),n.style.setProperty("color","#0f172a","important"))}}},0),o?(b&&clearInterval(b),b=setInterval(()=>{v();const e=document.querySelector("[data-gamehud]");if(e){const n=window.getComputedStyle(e),i=n.left,s=n.top;"20px"===i&&"20px"===s||(e.style.setProperty("left","20px","important"),e.style.setProperty("top","20px","important"),e.style.setProperty("transform","none","important"),e.style.setProperty("will-change","auto","important"));const o=e.querySelectorAll("p");if(o.length>=4){const e=o[1],n=o[3];e&&(e.textContent=String(t()??0)),n&&(n.textContent=r()||"00.00.00")}}},50)):m()||b&&(clearInterval(b),b=null),()=>{!m()&&b&&(clearInterval(b),b=null)}}),T(()=>{const e=w();return`z-index: 100021 !important; position: fixed !important; left: 20px !important; top: 20px !important; width: auto !important; height: auto !important; display: ${e?"flex":"none"} !important; visibility: ${e?"visible":"hidden"} !important; opacity: ${e?"1":"0"} !important; pointer-events: ${e?"auto":"none"} !important; transform: none !important;`}),k=(x=(_=CD()).firstChild.firstChild.firstChild).firstChild.nextSibling,C=x.nextSibling.firstChild.nextSibling,Ie(t=>{t&&(console.log("[GameHUD]  Element ref callback - element mounted, visible:",e.visible,"isInProgress:",a()),t.parentElement!==document.body&&document.body.appendChild(t),v(),setTimeout(()=>v(),0),setTimeout(()=>v(),50),setTimeout(()=>v(),100),setTimeout(()=>v(),200),setTimeout(()=>v(),500),setTimeout(()=>{const n=t.getBoundingClientRect(),r=window.getComputedStyle(t),i=t.querySelector("div"),s=i?.getBoundingClientRect(),o=i?window.getComputedStyle(i):null,l=t.querySelectorAll("p");console.log("[GameHUD]  Element ref check:",{inDOM:!!t,visible:e.visible,isInProgress:a(),shouldShow:w(),rect:{top:n.top,left:n.left,width:n.width,height:n.height},zIndex:r.zIndex,visibility:r.visibility,opacity:r.opacity,display:r.display,position:r.position,innerDiv:{exists:!!i,rect:s?{top:s.top,left:s.left,width:s.width,height:s.height}:null,display:o?.display,visibility:o?.visibility,opacity:o?.opacity,backgroundColor:o?.backgroundColor},textElementsCount:l.length,textContent:t.textContent?.substring(0,100),inViewport:n.top>=0&&n.left>=0&&n.bottom<=window.innerHeight&&n.right<=window.innerWidth});const c=w();t.style.setProperty("display",c?"flex":"none","important"),t.style.setProperty("visibility",c?"visible":"hidden","important"),t.style.setProperty("opacity",c?"1":"0","important")},100))},_),Te(k,()=>t()??0),Te(C,()=>r()||"00.00.00"),_;var _,x,k,C};window.addEventListener("nusa:start-experience",()=>{window.startBackgroundMusic&&window.startBackgroundMusic(),window.testOndelNPC&&window.testOndelNPC();const e=document.getElementById("joystick-container");e&&(e.dataset.active="true",e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.pointerEvents="auto",requestAnimationFrame(()=>{e.style.transition="opacity 0.4s ease",e.style.opacity="1"}),console.log("[Joystick]  Joystick activated for mobile"))});const[ED,SD]=D(!1),[ID,TD]=D("idle");"undefined"!=typeof window&&(window.experienceStarted=ED,window.setExperienceStarted=e=>SD(e),window.setExperiencePhase=e=>TD(e));var AD=ve('<div class="rounded-2xl border border-blue-200 bg-white/90 p-4 text-slate-700 shadow-md backdrop-blur-sm"><h2 class="mb-3 text-lg font-semibold text-blue-700">Panduan Singkat</h2><ol class="list-decimal space-y-2 pl-5 text-sm leading-relaxed sm:text-base"><li>Bersiap dengan membaca instruksi permainan dan pilih karakter favoritmu.</li><li>Masuk ke ruangan dengan membuat ruangan baru atau bergabung menggunakan kode.</li><li>Pilih salah satu dari 3 squad. Tiap squad berisi 2-3 pemain dan dapat diganti sebelum permainan dimulai.</li><li>Host akan memulai permainan, seluruh pemain berkumpul di lobby selama 10 detik.</li><li>Bekerja sama mencari baju adat tersembunyi dan menjawab kuis penjaga untuk menambah poin squad.</li><li>Jawaban salah akan mengurangi poin. Setiap item dan kuis hanya dapat dikerjakan satu kali per squad.</li><li>Ketika semua squad selesai, leaderboard akan menampilkan peringkat dan kontributor terbaik.'),PD=ve('<div class="grid gap-4 sm:grid-cols-2"><button type=button class="rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 p-4 text-left text-white shadow-lg transition hover:brightness-110 focus:outline-none focus:ring-4 focus:ring-blue-400 sm:p-6"><h3 class="text-xl font-semibold">Buat Ruangan</h3><p class="mt-2 text-sm text-blue-100 sm:text-base">Jadilah host, beri nama squad, dan pimpin petualangan budaya bersama temanmu.</p></button><button type=button class="rounded-2xl border border-blue-200 bg-white p-4 text-left text-blue-700 shadow-lg transition hover:border-blue-400 hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-200 sm:p-6"><h3 class="text-xl font-semibold">Gabung Ruangan</h3><p class="mt-2 text-sm text-slate-600 sm:text-base">Masukkan kode ruangan dari host dan pilih squad dengan slot kosong.'),RD=ve('<div class="space-y-4 rounded-2xl border border-blue-200 bg-white/95 p-4 shadow-lg backdrop-blur-sm sm:p-6"><div class="flex items-center justify-between gap-4"><div><h3 class="text-lg font-semibold text-blue-700 sm:text-xl">Buat Ruangan Baru</h3><p class="text-sm text-slate-600">Atur nama ruangan dan squad untuk timmu.</p></div><button type=button class="rounded-full border border-transparent bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600 transition hover:bg-slate-200">Kembali</button></div><div class=space-y-2><label class="text-sm font-medium text-slate-700"for=roomName>Nama Ruangan</label><input id=roomName type=text class="w-full rounded-xl border border-slate-200 px-3 py-2 text-sm shadow-sm transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 sm:text-base"placeholder="Misal: Jelajah Nusantara"maxlength=50></div><div class=space-y-3><p class="text-sm font-medium text-slate-700">Nama Squad</p></div><button type=button class="w-full rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300 sm:text-base">'),ND=ve('<div class="flex flex-col gap-2 rounded-xl border border-slate-100 bg-slate-50/60 p-3 sm:flex-row sm:items-center sm:gap-3"><label class="text-xs font-semibold uppercase tracking-wide text-slate-500 sm:text-sm">Squad </label><input type=text class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm shadow-sm transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 sm:text-base"maxlength=40>'),FD=ve('<div class="space-y-4 rounded-2xl border border-blue-200 bg-white/95 p-4 shadow-lg backdrop-blur-sm sm:p-6"><div class="flex items-center justify-between gap-4"><div><h3 class="text-lg font-semibold text-blue-700 sm:text-xl">Gabung Ruangan</h3><p class="text-sm text-slate-600">Masukkan kode ruangan dari host dan bergabung dengan squad.</p></div><button type=button class="rounded-full border border-transparent bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-600 transition hover:bg-slate-200">Kembali</button></div><div class=space-y-2><label class="text-sm font-medium text-slate-700"for=roomCode>Kode Ruangan</label><input id=roomCode type=text class="w-full rounded-xl border border-slate-200 px-3 py-3 text-center text-lg font-semibold tracking-[0.3em] text-blue-700 shadow-sm transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200"placeholder=ABC123 maxlength=6></div><button type=button class="w-full rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300 sm:text-base">'),OD=ve('<div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3"><input type=text class="w-full rounded-lg border border-slate-200 px-3 py-2 text-sm font-semibold text-blue-700 shadow-sm transition focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200 sm:text-base"maxlength=40><span class="text-xs font-semibold uppercase tracking-wide text-slate-500">/<!> pemain'),MD=ve('<div class="rounded-xl border border-dashed border-slate-200 bg-slate-50/80 px-3 py-2 text-center text-sm text-slate-400">Slot kosong (<!>)  Ajak teman bergabung'),LD=ve('<button type=button class="rounded-lg border border-blue-200 px-3 py-2 text-xs font-semibold text-blue-600 transition hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 sm:text-sm">Gabung Squad Ini'),UD=ve('<span class="rounded-lg bg-blue-600 px-3 py-2 text-xs font-semibold text-white sm:text-sm">Squad Kamu'),qD=ve('<div class="flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white/95 p-4 shadow-lg transition hover:border-blue-200 hover:shadow-xl sm:p-6"><div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"></div><div class=space-y-2></div><div class="flex flex-wrap items-center justify-between gap-3 rounded-xl bg-slate-50 px-3 py-3"><div><p class="text-xs font-semibold uppercase tracking-wide text-slate-500">Kontributor Squad</p><p class="text-xs text-slate-500">Baju Adat: <span class="font-semibold text-slate-700"></span> (<!>)</p><p class="text-xs text-slate-500">Penjawab Kuis: <span class="font-semibold text-slate-700"></span> (<!>)'),jD=ve('<h3 class="text-lg font-semibold text-blue-700 sm:text-xl"> <span class="text-xs font-medium text-slate-500">(<!>/<!> pemain)'),VD=ve('<span class="rounded-full bg-amber-100 px-2 py-1 text-xs font-semibold text-amber-700">Host'),BD=ve('<div class="flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2"><div class=min-w-0><p class="truncate text-sm font-semibold text-slate-800"></p><p class="text-xs text-slate-500">Koleksi: <!>  Kuis: <!>  Poin: '),zD=ve('<div class="rounded-2xl border border-amber-200 bg-amber-50 p-4 text-center shadow-inner"><p class="text-xs font-semibold uppercase tracking-[0.4em] text-amber-500">Hitung Mundur</p><p class="mt-2 text-5xl font-bold text-amber-600 sm:text-6xl"></p><p class="mt-2 text-sm text-amber-600">Permainan akan dimulai otomatis setelah hitung mundur selesai.'),$D=ve('<div class="flex flex-wrap gap-2"><button type=button class="rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300">Mulai Permainan</button><button type=button class="rounded-xl border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-200">Reset Lobby'),HD=ve('<div class="flex flex-col gap-3 rounded-2xl border border-slate-200 bg-slate-50/80 p-4 sm:flex-row sm:items-center sm:justify-between"><div><p class="text-sm font-semibold text-slate-700">Tips: pastikan tiap squad memiliki anggota maksimal 3 orang sebelum permainan dimulai.</p><p class="text-xs text-slate-500">Host dapat memulai permainan kapan saja. Pemain masih bisa berpindah squad selama slot tersedia.'),GD=ve('<div class="space-y-5 rounded-3xl border border-blue-200 bg-white/95 p-4 shadow-2xl backdrop-blur-md sm:p-6 lg:p-8"><div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"><div><p class="text-sm font-semibold uppercase tracking-[0.4em] text-blue-400">Ruang Budaya</p><h2 class="text-2xl font-bold text-blue-700 sm:text-3xl"></h2><p class="text-sm text-slate-500">Host: <span class="font-semibold text-slate-700"> </span></p></div><div class="flex flex-col items-end gap-2 sm:flex-row sm:items-center"><div class="rounded-2xl border border-blue-200 bg-blue-50 px-4 py-3 text-center shadow-sm"><p class="text-[10px] font-semibold uppercase tracking-[0.3em] text-blue-500">Kode Ruangan</p><p class="text-xl font-bold tracking-[0.2em] text-blue-700"></p></div><button type=button class="rounded-xl border border-blue-200 px-3 py-2 text-xs font-semibold text-blue-600 transition hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 sm:text-sm">Salin Kode</button></div></div><div class="grid gap-4 md:grid-cols-3">'),WD=ve('<div class="fixed inset-0 z-[90] flex items-center justify-center bg-white/95 px-4 backdrop-blur-md"><div class="max-w-lg space-y-4 rounded-3xl border border-blue-200 bg-white p-6 text-center shadow-2xl"><h2 class="text-2xl font-bold text-blue-700">Squad Kamu Sudah Selesai!</h2><p class="text-sm text-slate-600">Kembali ke area lobby dan dukung squad lainnya. Leaderboard akan tampil ketika seluruh squad menyelesaikan tugas.</p><button type=button class="rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300">Teleport ke Lobby'),KD=ve('<p class="text-sm text-slate-600">Selamat! Semua squad telah menyelesaikan misi. Berikut klasemen akhir dan kontributor terbaik.'),QD=ve('<div class="fixed inset-0 z-[95] flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50 px-4 py-6"><div class="w-full max-w-4xl space-y-6 rounded-3xl border border-blue-200 bg-white/95 p-6 shadow-2xl backdrop-blur-md sm:p-8"><div class="flex flex-col items-center gap-3 text-center"><p class="text-sm font-semibold uppercase tracking-[0.5em] text-blue-400">Leaderboard Nusantara</p><h2 class="text-3xl font-bold text-blue-700 sm:text-4xl">Perolehan Poin Squad</h2></div><div class=space-y-4></div><button type=button class="w-full rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-5 py-3 text-sm font-semibold text-white shadow-lg transition hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300 sm:text-base">Selesai'),YD=ve('<p class="text-sm text-slate-600">Squad kamu sudah selesai! Menunggu squad lain menyelesaikan misi... (<!>/<!> squad selesai)'),JD=ve('<div class="flex flex-col gap-3 rounded-2xl border border-slate-200 bg-white/95 p-4 shadow-lg sm:flex-row sm:items-center sm:justify-between sm:p-6"><div class="flex items-center gap-4"><div class="flex size-14 items-center justify-center rounded-full bg-blue-600 text-2xl font-bold text-white shadow-md"></div><div><p class="text-lg font-semibold text-blue-700 sm:text-xl"></p><p class="text-sm text-slate-500">Waktu: <!>  Poin akhir: </p></div></div><div class="flex flex-col gap-1 text-sm text-slate-600">'),XD=ve('<div class="flex items-center justify-between gap-4 rounded-xl bg-slate-50 px-3 py-2"><span class="truncate font-semibold text-slate-700"></span><span class="text-xs text-slate-500">Koleksi: <!>  Kuis: '),ZD=ve('<div class="rounded-2xl border px-4 py-3 text-sm shadow-lg">'),eE=ve("<div class=space-y-5>"),tE=ve('<div class="pointer-events-auto fixed inset-0 z-[80] flex items-start justify-center overflow-y-auto bg-black px-3 py-6 scrollbar-hidden sm:py-8"><div class="w-full max-w-5xl">');const nE=["Squad Merdeka","Squad Bahari","Squad Cendrawasih"],rE=e=>{window.dispatchEvent(new CustomEvent("room:squad-changed",{detail:{squadId:e}}))},iE=()=>{const[e,t]=D("options"),[n,r]=D(null),[i,s]=D(!1),[o,a]=D(""),[l,c]=D(null),[u,h]=D(0),[d,p]=D(null),[m,g]=D(null),[f,y]=D("Petualangan Nusantara"),[w,b]=D(nE),[v,_]=D(""),x=()=>localStorage.getItem("userId")??"",k=()=>localStorage.getItem("userUsername")??"Explorer",C=T(()=>{const e=l();if(e&&x())return e.players?.[x()]}),E=T(()=>{const e=l(),t=C();if(e&&t)return e.squads?.[t.squadId]}),A=T(()=>!!C()?.isHost),P=T(()=>l()?.leaderboard),F=T(()=>{const e=l();if(!e)return[];const t=e.squads||{};return["squad1","squad2","squad3"].map(e=>t[e]).filter(e=>Boolean(e))});let O=null,M=null,L=!1;const U=e=>{"undefined"!=typeof window&&(window.__activeSquadId=e,window.dispatchEvent(new CustomEvent("nusa:squad-context-changed",{detail:{squadId:e}})))},q=()=>r(null),j=()=>{const e=d();e&&(clearInterval(e),p(null))},V=()=>{const e=m();e&&(clearTimeout(e),g(null))},B=()=>{delete window.roomSession,a(""),ED()||TD("room-selection"),rE(null),z=null,M=null,U(null),O=null,L&&(window.exitLobbyArea?.(),L=!1)};let z=null,$="";const H=e=>{const n=e?`${e.roomCode}:${e.status}:${e.lastUpdatedAt||0}`:"null";if(n===$)return;$=n;const i=x(),s=C();if(e){if(!s&&e.hostId!==i)return B(),c(null),t("options"),a(""),localStorage.removeItem("activeRoomCode"),void r({type:"error",message:"Anda dikeluarkan dari ruangan karena tidak hadir di lobby."});if(s){window.roomSession={roomCode:e.roomCode,squadId:s.squadId,userId:s.userId,playerName:s.name,roomStartedAt:e.startedAt||null,recordCollectible:async(t,n)=>{try{await(async({roomCode:e,squadId:t,playerId:n,playerName:r,itemId:i,points:s,avatarSrc:o})=>{let a={accepted:!1,scoreDelta:0};return await hD(mD(e),e=>{if(!e)return e;if("completed"===e.status)return a={accepted:!1,scoreDelta:0,reason:"room-completed"},e;const l=e.squads?.[t];if(!l)return a={accepted:!1,scoreDelta:0,reason:"not-in-room"},e;if(l.collectedItems=l.collectedItems||{},l.collectedItems[i])return a={accepted:!1,scoreDelta:0,reason:"duplicate"},e;const c=Date.now();l.collectedItems[i]={itemId:i,playerId:n,playerName:r,collectedAt:c},l.score=(l.score||0)+s;const u=l.members?.[n],h=yD(u);h.items+=1,h.score+=s;const d=e.players?.[n];if(d){const e=yD(d);e.items=h.items,e.score=h.score}return l.members=l.members||{},l.members[n]={userId:n,name:r,avatarSrc:o,squadId:t,joinedAt:u?.joinedAt||c,isHost:u?.isHost,contributions:h},e.players[n]={userId:n,name:r,avatarSrc:o,squadId:t,joinedAt:d?.joinedAt||c,isHost:d?.isHost,contributions:h},l.members[n].contributions=h,a={accepted:!0,scoreDelta:s},e.lastUpdatedAt=c,e}),a})({roomCode:e.roomCode,squadId:s.squadId,playerId:s.userId,playerName:s.name,itemId:t,points:n,avatarSrc:ht()})}catch(e){console.error("[RoomFlow] recordCollectible failed",e)}},recordQuiz:async(t,n,r,i)=>{try{await(async({roomCode:e,squadId:t,playerId:n,playerName:r,guardId:i,questionId:s,points:o,isCorrect:a,avatarSrc:l})=>{let c={accepted:!1,scoreDelta:0};return await hD(mD(e),e=>{if(!e)return e;if("completed"===e.status)return c={accepted:!1,scoreDelta:0,reason:"room-completed"},e;const u=e.squads?.[t];if(!u)return c={accepted:!1,scoreDelta:0,reason:"not-in-room"},e;const h=`${i}:${s}`;if(u.answeredQuestions=u.answeredQuestions||{},u.answeredQuestions[h])return c={accepted:!1,scoreDelta:0,reason:"duplicate"},e;const d=Date.now();u.answeredQuestions[h]={guardId:i,questionId:s,playerId:n,playerName:r,isCorrect:a,answeredAt:d},u.score=(u.score||0)+o;const p=u.members?.[n],m=yD(p);m.quizzes+=1,m.score+=o,a?m.correctAnswers+=1:m.wrongAnswers+=1;const g=e.players?.[n];if(g){const e=yD(g);e.quizzes=m.quizzes,e.correctAnswers=m.correctAnswers,e.wrongAnswers=m.wrongAnswers,e.score=m.score}return u.members=u.members||{},u.members[n]={userId:n,name:r,avatarSrc:l,squadId:t,joinedAt:p?.joinedAt||d,isHost:p?.isHost,contributions:m},e.players[n]={userId:n,name:r,avatarSrc:l,squadId:t,joinedAt:g?.joinedAt||d,isHost:g?.isHost,contributions:m},c={accepted:!0,scoreDelta:o},e.lastUpdatedAt=d,e}),c})({roomCode:e.roomCode,squadId:s.squadId,playerId:s.userId,playerName:s.name,guardId:t,questionId:n,isCorrect:r,points:i,avatarSrc:ht()})}catch(e){console.error("[RoomFlow] recordQuiz failed",e)}},markSquadCompleted:async t=>{try{await(async({roomCode:e,squadId:t,durationSeconds:n,completedAt:r})=>{await hD(mD(e),e=>{if(!e)return e;const i=e.squads?.[t];if(!i)return e;if("completed"===i.status)return e;const s=r||Date.now();if(i.status="completed",i.completedAt=s,i.durationSeconds=n,Object.values(e.squads||{}).filter(e=>"completed"===e.status).length>0){const t={...e,squads:Object.fromEntries(Object.entries(e.squads||{}).filter(([e,t])=>"completed"===t.status))};e.leaderboard=wD(t)}return Object.values(e.squads||{}).every(e=>"completed"===e.status)&&(e.status="completed",e.finishedAt=s,e.leaderboard=wD(e)),e.lastUpdatedAt=s,e})})({roomCode:e.roomCode,squadId:s.squadId,durationSeconds:t})}catch(e){console.error("[RoomFlow] markSquadCompleted failed",e)}}};const t=s.squadId??null;t!==z&&(z=t,rE(t))}else console.log("[RoomFlow]  Player not found but continuing (host case)")}else B()},G=e=>{console.log("[RoomFlow]  Subscribing to room:",e);const t=window.__roomUnsubscribe;t&&(console.log("[RoomFlow]  Cleaning up previous subscription"),t());const n=kD(e,t=>{if(console.log("[RoomFlow]  Room data received:",t),console.log("[RoomFlow]  Room data keys:",t?Object.keys(t):"null"),console.log("[RoomFlow]  Room name:",t?.roomName),console.log("[RoomFlow]  Room status:",t?.status),console.log("[RoomFlow]  Room players:",t?.players),console.log("[RoomFlow]  Current userId:",x()),!t||!t.roomName){if(console.warn("[RoomFlow]  Room data invalid or missing roomName:",t),console.warn("[RoomFlow]  Room data type:",typeof t),console.warn("[RoomFlow]  Room data value:",t),e===o()){const t=window.__roomRetryCount||0;if(t<3)return window.__roomRetryCount=t+1,console.log(`[RoomFlow]  Room just created, waiting 1000ms and retrying subscription... (attempt ${t+1}/3)`),void setTimeout(()=>{G(e)},1e3);console.error("[RoomFlow]  Max retries reached, room data still not available"),window.__roomRetryCount=0}return c(null),r({type:"error",message:"Ruangan ditutup oleh host atau tidak dapat diakses."}),TD("room-selection"),B(),localStorage.removeItem("activeRoomCode"),void a("")}window.__roomRetryCount=0,console.log("[RoomFlow]  Room data valid, setting room"),c(t),console.log("[RoomFlow]  Updating session"),H(t)});window.__roomUnsubscribe=n,N(()=>{n&&n(),window.__roomUnsubscribe=null})};R(()=>{const e=new URLSearchParams(window.location.search),n="true"===e.get("fromLobby"),r=e.get("room")||"";r&&6===r.length&&a(r),n?(TD("in-game"),SD(!0)):TD("room-selection");const i=e=>{const n=e.detail?.roomCode,r=e.detail?.roomName,i=e.detail?.hostName,s=e.detail?.squadNames||["Squad 1","Squad 2","Squad 3"];if(console.log("[RoomFlow]  Room created event received:",{roomCode:n,roomName:r,hostName:i,squadNames:s}),n&&6===n.length){if(console.log("[RoomFlow]  Valid room code, setting up room..."),a(n),localStorage.setItem("activeRoomCode",n),t("options"),TD("room-lobby"),console.log("[RoomFlow]  Force subscribing to room immediately..."),G(n),r&&i){const e={roomCode:n,roomName:r,hostName:i,hostId:x()||"",hostSquadId:"squad1",status:"waiting",players:{},squads:{squad1:{id:"squad1",name:s[0]||"Squad 1",capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}},squad2:{id:"squad2",name:s[1]||"Squad 2",capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}},squad3:{id:"squad3",name:s[2]||"Squad 3",capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}}},createdAt:Date.now(),lastUpdatedAt:Date.now(),startedAt:0,finishedAt:0};console.log("[RoomFlow]  Setting temporary room data for immediate UI display with squad names:",s),c(e)}}else console.warn("[RoomFlow]  Invalid room code in event:",n)};return window.addEventListener("room:created",i),window.setCurrentRoomCode=e=>{e&&6===e.length&&(console.log("[RoomFlow]  setCurrentRoomCode called directly:",e),a(e),localStorage.setItem("activeRoomCode",e),t("options"),TD("room-lobby"),G(e))},window.setMode=e=>{console.log("[RoomFlow]  setMode called directly:",e),t(e)},window.setExperiencePhase=e=>{console.log("[RoomFlow]  setExperiencePhase called directly:",e),TD(e)},()=>{window.removeEventListener("room:created",i)}}),I(()=>{const e=o();console.log("[RoomFlow]  currentRoomCode changed:",e),e?(console.log("[RoomFlow]  Room code exists, starting subscription"),G(e)):console.log("[RoomFlow]  No room code, skipping subscription")}),I(()=>{if(!l()&&!ED()){if("undefined"!=typeof window&&window.__forceInGame||(()=>{try{return"true"===new URLSearchParams(window.location.search).get("fromLobby")}catch{}return!1})()||se())return TD("in-game"),void SD(!0);TD("room-selection")}}),I(()=>{const e=C(),t=e?.squadId??null;t!==M&&(M=t,U(t),(e=>{if("undefined"==typeof window)return;const t=document.getElementById("rig");if(t){const n=t.getAttribute?.("player-info")||{};t.setAttribute?.("player-info",{...n,...e})}const n=document.getElementById("player");if(n){const t=n.getAttribute?.("player-info")||{};n.setAttribute?.("player-info",{...t,...e})}})({squadId:t??""}))}),I(()=>{const e=l(),t=e?.status;if(!e||"countdown"!==t)return L&&(window.exitLobbyArea?.(),L=!1),void("countdown"!==t&&(O=null));const n=e.countdown?.startedAt;if(!n)return;const r=`${e.roomCode}:${n}`;if(r===O)return;O=r;const i=x();i&&(async(e,t)=>{await hD(mD(e),e=>{if(!e)return e;if((e=>{try{(e=>{Object.values(e.players??{}).forEach(e=>{if(e&&"readyInLobbyAt"in e){const t=e.readyInLobbyAt;"number"==typeof t?e.readyInLobbyAt=t:delete e.readyInLobbyAt}}),Object.values(e.squads??{}).forEach(e=>{Object.values(e?.members??{}).forEach(e=>{if(e&&"readyInLobbyAt"in e){const t=e.readyInLobbyAt;"number"==typeof t?e.readyInLobbyAt=t:delete e.readyInLobbyAt}})})})(e),(e=>{Object.values(e.players??{}).forEach(e=>{e&&"readyInLobbyAt"in e&&void 0===e.readyInLobbyAt&&delete e.readyInLobbyAt}),Object.values(e.squads??{}).forEach(e=>{Object.values(e?.members??{}).forEach(e=>{e&&"readyInLobbyAt"in e&&void 0===e.readyInLobbyAt&&delete e.readyInLobbyAt})})})(e),pD(e)}catch{}})(e),!e.players||!e.players[t])return e;const n=e.players[t],r=Date.now();if(n.readyInLobbyAt=r,n.squadId){const i=e.squads?.[n.squadId];i&&(i.members=i.members||{},i.members[t]&&(i.members[t].readyInLobbyAt=r))}return e.lastUpdatedAt=r,e})})(e.roomCode,i).catch(e=>{console.error("[RoomFlow] markPlayerLobbyReady error",e)})});let W="";I(()=>{const e=l();if(!e)return h(0),j(),V(),void(W="");const t=e.status;if("waiting"===t)TD("room-lobby"),SD(!1),h(0),j(),V(),W="";else if("countdown"===t&&e.countdown){TD("countdown");const t=`${e.roomCode}:countdown:${e.countdown.startedAt}`;if(t===W){const t=Math.max(0,e.countdown.endsAt-Date.now());return void h(t)}W=t;const n=()=>{const t=Math.max(0,e.countdown.endsAt-Date.now());h(t),t<=0&&A()&&(console.log("[RoomFlow]  Countdown reached 0, triggering beginGame..."),j(),(async()=>{try{let t=window.__authUid||x()||"";if(!t)try{const e=await Qb(2e3,{strict:!1});t=e?.uid||""}catch(e){console.warn("[RoomFlow] waitForAuth failed in beginGame:",e)}if(!t)return void console.error("[RoomFlow] Cannot begin game: no hostId available");console.log("[RoomFlow]  Countdown finished, starting game with hostId:",t),await fD(e.roomCode,t),console.log("[RoomFlow]  Game started successfully, status should be in-progress now")}catch(e){console.error("[RoomFlow] beginGame failed",e)}})())};n(),j();const r=window.setInterval(n,250);if(p(r),A()){V();const t=Math.max(0,e.countdown.endsAt-Date.now()),n=window.setTimeout(async()=>{try{let t=window.__authUid||x()||"";if(!t)try{const e=await Qb(2e3,{strict:!1});t=e?.uid||""}catch(e){console.warn("[RoomFlow] waitForAuth failed in beginGame timeout:",e)}if(!t)return void console.error("[RoomFlow] Cannot begin game: no hostId available");console.log("[RoomFlow]  Countdown timeout triggered, starting game with hostId:",t),await fD(e.roomCode,t),console.log("[RoomFlow]  Game started successfully, status should be in-progress now")}catch(e){console.error("[RoomFlow] beginGame failed",e)}},t+500);g(n)}}else if("in-progress"===t){j(),V(),L&&(window.exitLobbyArea?.(),L=!1),TD("in-game");const n=e.startedAt,r=`${e.roomCode}:${t}:${n}`;if(r===W)return;if(W=r,ED()||SD(!0),n&&window.gameProgress?.startTimerFromRoomStartedAt)window.setTimeout(()=>{window.gameProgress.startTimerFromRoomStartedAt(n)},0);else if(window.gameProgress?.ensureTimerRunning){const e=window.gameProgress?.ensureTimerRunning;e&&window.setTimeout(()=>{e()},0)}console.log("[RoomFlow]  Spawning to in-game world...");const i=document.querySelector("a-scene"),s=i&&i.hasLoaded;if(window.setEntered&&(window.setEntered(!0),console.log("[RoomFlow]  Set entered to true")),window.setSceneLoaded&&(window.setSceneLoaded(s||!0),console.log("[RoomFlow]  Set sceneLoaded to:",s||!0)),window.startExperience?window.startExperience():console.warn("[RoomFlow]  window.startExperience is not available"),ED()&&n&&window.gameProgress?.startTimerFromRoomStartedAt){const e=window.gameProgress?.getState?.()?.timerStartedAt;e!==n&&window.setTimeout(()=>{window.gameProgress.startTimerFromRoomStartedAt(n)},0)}H(e)}else"completed"===t?(j(),V(),SD(!1),TD("leaderboard"),W="",H(e)):H(e)});let K="";I(()=>{const e=l();if(!e)return;const t=E();if("in-progress"===e.status&&"completed"===t?.status){const n=`${e.roomCode}:${t.id}:${t.status}`;if(n===K)return;K=n,e.leaderboard&&e.leaderboard.length>0?(TD("leaderboard"),SD(!1)):(TD("waiting"),SD(!1))}else K=""}),"undefined"!=typeof window&&(window.updateGameTime=xD),N(()=>{j(),V(),B()});const Q=async()=>{q();try{s(!0);const e=await Qb(8e3,{strict:!0}),n=e?.uid||x();if(!n)return r({type:"error",message:"Tidak dapat menentukan akun. Silakan login dahulu."}),void s(!1);try{localStorage.setItem("userId",n)}catch{}const i=w(),o=await(async({roomName:e,hostId:t,hostName:n,hostAvatar:r,squadNames:i})=>{const s=gD(e||"Arena Nusantara"),o=(()=>{let e="";for(let t=0;t<6;t+=1)e+="ABCDEFGHJKLMNPQRSTUVWXYZ23456789"[Math.floor(32*Math.random())];return e})(),a={squad1:{id:"squad1",name:(l=[gD(i[0]||"Squad Garuda"),gD(i[1]||"Squad Rajawali"),gD(i[2]||"Squad Nusa")])[0],capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}},squad2:{id:"squad2",name:l[1],capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}},squad3:{id:"squad3",name:l[2],capacity:3,score:0,status:"waiting",members:{},collectedItems:{},answeredQuestions:{}}};var l;const c=Date.now();a.squad1.members=a.squad1.members||{},a.squad1.members[t]={userId:t,name:n,avatarSrc:r,squadId:"squad1",joinedAt:c,isHost:!0,contributions:{items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0}};const u={roomCode:o,roomName:s,hostId:t,hostName:n,hostSquadId:"squad1",status:"waiting",createdAt:c,squads:a,players:{[t]:{userId:t,name:n,avatarSrc:r,squadId:"squad1",joinedAt:c,isHost:!0,contributions:{items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0}}},lastUpdatedAt:c};return await tD(mD(o),u),u})({roomName:f(),hostId:n,hostName:k(),hostAvatar:ht(),squadNames:i});c(o),a(o.roomCode),localStorage.setItem("activeRoomCode",o.roomCode),TD("room-lobby"),t("options")}catch(e){console.error("[RoomFlow] createRoom error",e),r({type:"error",message:e?.message??"Gagal membuat ruangan. Coba lagi."})}finally{s(!1)}},Y=async()=>{q();const e=v().trim().toUpperCase();if(e)if(x())try{s(!0);const n=await(async({roomCode:e,userId:t,name:n,avatarSrc:r})=>{const i=await hD(mD(e),e=>{if(!e)return e;if("completed"===e.status)return e;const i=e.players?.[t],s=Date.now();if(i){i.name=n,i.avatarSrc=r,i.joinedAt=s,e.players[t]=i;const o=e.squads[i.squadId];return o&&(o.members=o.members||{},o.members[t]={...i,contributions:o.members[t]?.contributions||i.contributions}),e.lastUpdatedAt=s,e}const o=(e=>{const t=["squad1","squad2","squad3"];for(const n of t){const t=e.squads[n];if((t?.members?Object.keys(t.members).length:0)<3)return n}return null})(e);if(!o)return e;const a={userId:t,name:n,avatarSrc:r,squadId:o,joinedAt:s,contributions:{items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0}};return e.players=e.players||{},e.players[t]=a,e.squads[o].members=e.squads[o].members||{},e.squads[o].members[t]=a,e.lastUpdatedAt=s,e});return i.committed?i.snapshot.val():null})({roomCode:e,userId:x(),name:k(),avatarSrc:ht()});if(!n)return r({type:"error",message:"Ruangan tidak ditemukan atau penuh."}),void s(!1);console.log("[RoomFlow]  Successfully joined room:",n.roomCode),a(e),localStorage.setItem("activeRoomCode",e),c(n),TD("room-lobby"),r({type:"success",message:`Berhasil bergabung ke ruangan ${n.roomName}.`}),t("options"),console.log("[RoomFlow]  Force subscribing to joined room..."),G(e)}catch(e){console.error("[RoomFlow] joinRoom error",e),r({type:"error",message:e?.message??"Gagal bergabung ke ruangan."})}finally{s(!1)}else r({type:"error",message:"Silakan login terlebih dahulu sebelum bergabung."});else r({type:"error",message:"Masukkan kode ruangan."})},J=async()=>{const e=l();if(e)try{let t=window.__authUid||x()||"";if(!t)try{const e=await Qb(2e3,{strict:!1});t=e?.uid||""}catch(e){console.warn("[RoomFlow] waitForAuth failed, using existing callerId:",e)}if(!t)return void r({type:"error",message:"Tidak dapat menentukan akun. Silakan login dahulu."});if(e.hostId!==t)return void r({type:"error",message:"Hanya host yang dapat memulai permainan."});console.log("[RoomFlow] Starting countdown with callerId:",t),await(async(e,t,n=1e4)=>{console.log("[RoomService] startGameCountdown - NEW MULTIPATH VERSION");const r=mD(e),i=(await new Promise((e,t)=>{oD(r,e,{onlyOnce:!0}),setTimeout(()=>t(new Error("Timeout reading room")),5e3)})).val();if(!i)throw new Error("Room not found");if(i.hostId!==t)throw new Error("Not host");if("waiting"!==i.status)throw new Error("Room not waiting");const s=Date.now(),o={[`rooms/${e}/status`]:"countdown",[`rooms/${e}/countdown`]:{startedAt:s,endsAt:s+n},[`rooms/${e}/lastUpdatedAt`]:s};Object.keys(i.players||{}).forEach(t=>{o[`rooms/${e}/players/${t}/readyInLobbyAt`]=null}),Object.entries(i.squads||{}).forEach(([t,n])=>{Object.keys(n.members||{}).forEach(n=>{o[`rooms/${e}/squads/${t}/members/${n}/readyInLobbyAt`]=null})}),console.log("[RoomService] Applying multipath updates:",Object.keys(o).length,"paths"),await nD(ZC(dD),o),console.log("[RoomService] startGameCountdown SUCCESS")})(e.roomCode,t,1e4),r({type:"info",message:"Hitung mundur dimulai. Permainan akan dimulai dalam 10 detik!"})}catch(e){console.error("[RoomFlow] startGameCountdown error",e),r({type:"error",message:"Tidak dapat memulai hitung mundur."})}},X=async()=>{const e=l();if(e)try{await(async e=>{console.log("[RoomService] resetRoomToLobby - NEW MULTIPATH VERSION");const t=mD(e),n=(await new Promise((e,n)=>{oD(t,e,{onlyOnce:!0}),setTimeout(()=>n(new Error("Timeout reading room")),5e3)})).val();if(!n)throw new Error("Room not found");const r=Date.now(),i={[`rooms/${e}/status`]:"waiting",[`rooms/${e}/countdown`]:null,[`rooms/${e}/startedAt`]:null,[`rooms/${e}/finishedAt`]:null,[`rooms/${e}/currentElapsedSeconds`]:null,[`rooms/${e}/leaderboard`]:null,[`rooms/${e}/lastUpdatedAt`]:r};Object.entries(n.squads||{}).forEach(([t,n])=>{i[`rooms/${e}/squads/${t}/status`]="waiting",i[`rooms/${e}/squads/${t}/completedAt`]=null,i[`rooms/${e}/squads/${t}/durationSeconds`]=null,i[`rooms/${e}/squads/${t}/score`]=0,i[`rooms/${e}/squads/${t}/collectedItems`]={},i[`rooms/${e}/squads/${t}/answeredQuestions`]={},Object.keys(n.members||{}).forEach(n=>{i[`rooms/${e}/squads/${t}/members/${n}/readyInLobbyAt`]=null,i[`rooms/${e}/squads/${t}/members/${n}/contributions`]={items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0}})}),Object.keys(n.players||{}).forEach(t=>{i[`rooms/${e}/players/${t}/readyInLobbyAt`]=null,i[`rooms/${e}/players/${t}/contributions`]={items:0,quizzes:0,correctAnswers:0,wrongAnswers:0,score:0}}),console.log("[RoomService] Applying multipath updates:",Object.keys(i).length,"paths"),await nD(ZC(dD),i),console.log("[RoomService] resetRoomToLobby SUCCESS")})(e.roomCode),r({type:"success",message:"Ruang direset ke lobby."}),window.gameProgress?.reset?.()}catch(e){console.error("[RoomFlow] resetRoomToLobby error",e),r({type:"error",message:"Gagal mereset ruang."})}},Z=async()=>{const e=l();if(e&&x())try{await(async(e,t)=>{await hD(mD(e),e=>{if(!e)return e;if(!e.players||!e.players[t])return e;const n=e.players[t],r=e.squads[n.squadId];if(r&&r.members&&delete r.members[t],delete e.players[t],0===Object.keys(e.players).length)return null;if(e.hostId===t){const t=Object.keys(e.players)[0];e.hostId=t,e.hostName=e.players[t].name,e.hostSquadId=e.players[t].squadId,e.players[t].isHost=!0;const n=e.squads[e.players[t].squadId];n?.members?.[t]&&(n.members[t].isHost=!0)}return e.lastUpdatedAt=Date.now(),e})})(e.roomCode,x())}catch(e){console.error("[RoomFlow] leaveRoom error",e)}L&&(window.exitLobbyArea?.(),L=!1),window.showGameEnvironment?.(),c(null),a(""),B(),localStorage.removeItem("activeRoomCode"),SD(!1),TD("room-selection"),t("options"),window.gameProgress?.reset?.(),z=null};"undefined"!=typeof window&&(window.leaveRoomAndReturnToSelection=Z);const ee=()=>AD(),te=e=>{const{used:t,capacity:n}=(e=>e?{used:e.members?Object.keys(e.members).length:0,capacity:e.capacity}:{used:0,capacity:0})(e),i=Object.values(e.members??{}).sort((e,t)=>e.joinedAt-t.joinedAt),s=C()?.squadId===e.id,o=t<n&&!s,a=i.reduce((e,t)=>{const n=t.contributions?.items??0;return n>e.count?{name:t.name,count:n}:e},{name:"-",count:0}),c=i.reduce((e,t)=>{const n=t.contributions?.quizzes??0;return n>e.count?{name:t.name,count:n}:e},{name:"-",count:0});return u=qD(),h=u.firstChild,d=h.nextSibling,p=d.nextSibling,m=p.firstChild.firstChild.nextSibling,g=m.firstChild.nextSibling,(f=g.nextSibling.nextSibling).nextSibling,y=m.nextSibling,w=y.firstChild.nextSibling,(b=w.nextSibling.nextSibling).nextSibling,Te(h,ie(he,{get when(){return A()},get fallback(){return r=jD(),i=r.firstChild,s=i.nextSibling,o=s.firstChild.nextSibling,(a=o.nextSibling.nextSibling).nextSibling,Te(r,()=>e.name,i),Te(s,t,o),Te(s,n,a),r;var r,i,s,o,a},get children(){var i=OD(),s=i.firstChild,o=s.nextSibling,a=o.firstChild,c=a.nextSibling;return c.nextSibling,s.addEventListener("change",t=>(async(e,t)=>{if(l())if(t.trim())try{await(async(e,t,n)=>{const r=gD(n);await nD(ZC(dD,`rooms/${e}/squads/${t}`),{name:r,lastRenamedAt:Date.now()})})(l().roomCode,e,t),r({type:"success",message:"Nama squad diperbarui."})}catch(e){console.error("[RoomFlow] updateSquadName error",e),r({type:"error",message:"Gagal memperbarui nama squad."})}else r({type:"error",message:"Nama squad tidak boleh kosong."})})(e.id,t.currentTarget.value)),Te(o,t,a),Te(o,n,c),S(()=>s.value=e.name),i}})),Te(d,ie(ue,{each:i,children:e=>{return t=BD(),n=t.firstChild.firstChild,r=n.nextSibling,i=r.firstChild.nextSibling,(s=i.nextSibling.nextSibling).nextSibling,Te(n,()=>e.name),Te(r,()=>e.contributions?.items??0,i),Te(r,()=>e.contributions?.quizzes??0,s),Te(r,()=>e.contributions?.score??0,null),Te(t,ie(he,{get when(){return e.isHost},get children(){return VD()}}),null),t;var t,n,r,i,s}}),null),Te(d,ie(he,{get when(){return i.length<e.capacity},get children(){var t=MD(),n=t.firstChild.nextSibling;return n.nextSibling,Te(t,()=>e.capacity-i.length,n),t}}),null),Te(g,()=>a.name),Te(m,()=>a.count,f),Te(w,()=>c.name),Te(y,()=>c.count,b),Te(p,ie(he,{when:o,get children(){var t=LD();return t.$$click=()=>(async e=>{const t=l();if(t&&C())if(C().squadId!==e)try{await(async(e,t,n)=>{await hD(mD(e),e=>{if(!e)return e;const r=e.players?.[t];if(!r)return e;if(!e.squads[n])return e;const i=e.squads[r.squadId],s=e.squads[n];return(s.members?Object.keys(s.members).length:0)>=3||(i?.members&&delete i.members[t],r.squadId=n,e.players[t]=r,s.members=s.members||{},s.members[t]=r,e.lastUpdatedAt=Date.now()),e})})(t.roomCode,x(),e),r({type:"success",message:"Berhasil pindah squad."})}catch(e){console.error("[RoomFlow] movePlayerToSquad error",e),r({type:"error",message:"Tidak dapat pindah squad. Pastikan slot masih tersedia."})}else r({type:"info",message:"Anda sudah berada di squad ini."})})(e.id),t}}),null),Te(p,ie(he,{when:s,get children(){return UD()}}),null),S(e=>De(u,{"ring-2 ring-blue-400":s},e)),u;var u,h,d,p,m,g,f,y,w,b},ne=()=>{const e=l();if(!e)return null;const t=Math.ceil(u()/1e3);return c=(a=(o=(s=(i=(n=GD()).firstChild).firstChild).firstChild.nextSibling).nextSibling.firstChild.nextSibling).firstChild,d=(h=s.nextSibling.firstChild).firstChild.nextSibling,p=h.nextSibling,m=i.nextSibling,Te(o,()=>e.roomName),Te(a,()=>e.hostName,c),Te(a,()=>e.hostId===x()?"(Anda)":"",null),Te(d,()=>e.roomCode),p.$$click=()=>{navigator.clipboard.writeText(e.roomCode),r({type:"info",message:"Kode ruangan disalin ke clipboard."})},Te(m,ie(ue,{get each(){return F()},children:e=>te(e)})),Te(n,ie(he,{get when(){return"countdown"===e.status},get children(){var e=zD();return Te(e.firstChild.nextSibling,t),e}}),null),Te(n,ie(he,{get when(){return"waiting"===e.status},get children(){var e=HD();return e.firstChild,Te(e,ie(he,{get when(){return A()},get children(){var e=$D(),t=e.firstChild,n=t.nextSibling;return t.$$click=J,n.$$click=X,e}}),null),e}}),null),n;var n,i,s,o,a,c,h,d,p,m},re=()=>ID();I(()=>{const e=l(),t=re();console.log("[RoomFlow]  Render state - room:",!!e,"phase:",t,"started:",ED()),e&&console.log("[RoomFlow]  Room details - name:",e.roomName,"code:",e.roomCode,"status:",e.status)});const se=()=>{try{const e=new URLSearchParams(window.location.search).get("room");return!!(e&&e.length>=4)}catch{return!1}};return[ie(he,{get when(){return we(()=>"in-game"!==re())()&&"leaderboard"!==re()},get children(){var s=tE(),o=s.firstChild;return Te(o,ie(he,{get when(){return we(()=>!l())()&&!se()},get children(){var s=eE();return Te(s,ee,null),Te(s,ie(he,{get when(){return n()},get children(){var e=ZD();return Te(e,()=>n()?.message),S(t=>De(e,{"border-green-200 bg-green-50 text-green-700":"success"===n()?.type,"border-red-200 bg-red-50 text-red-600":"error"===n()?.type,"border-blue-100 bg-blue-50 text-blue-600":"info"===n()?.type},t)),e}}),null),Te(s,ie(he,{get when(){return"options"===e()},get fallback(){return ie(he,{get when(){return"create"===e()},get children(){return s=(n=(e=RD()).firstChild).firstChild.nextSibling,o=n.nextSibling,a=o.firstChild.nextSibling,(l=o.nextSibling).firstChild,c=l.nextSibling,s.$$click=()=>{r(null),t("options")},a.$$input=e=>y(e.currentTarget.value),Te(l,ie(ue,{each:[0,1,2],children:e=>{return(n=(t=ND()).firstChild).firstChild,r=n.nextSibling,Te(n,e+1,null),r.$$input=t=>{const n=[...w()];n[e]=t.currentTarget.value,b(n)},S(()=>r.value=w()[e]),t;var t,n,r}}),null),c.$$click=Q,Te(c,()=>i()?"Membuat Ruangan...":"Buat Ruangan"),S(()=>c.disabled=i()),S(()=>a.value=f()),e;var e,n,s,o,a,l,c}})},get children(){return ie(he,{get when(){return"options"===e()},get children(){return i=(n=(e=PD()).firstChild).nextSibling,n.$$click=()=>{r(null),t("create")},i.$$click=()=>{r(null),t("join")},e;var e,n,i}})}}),null),Te(s,ie(he,{get when(){return"join"===e()},get children(){return s=(n=(e=FD()).firstChild).firstChild.nextSibling,o=n.nextSibling,a=o.firstChild.nextSibling,l=o.nextSibling,s.$$click=()=>{r(null),t("options")},a.$$input=e=>_(e.currentTarget.value.toUpperCase()),l.$$click=Y,Te(l,()=>i()?"Menghubungkan...":"Gabung Sekarang"),S(()=>l.disabled=i()),S(()=>a.value=v()),e;var e,n,s,o,a,l}}),null),s}}),null),Te(o,ie(he,{get when(){return l()},get children(){var e=eE();return Te(e,ie(he,{get when(){return n()},get children(){var e=ZD();return Te(e,()=>n()?.message),S(t=>De(e,{"border-green-200 bg-green-50 text-green-700":"success"===n()?.type,"border-red-200 bg-red-50 text-red-600":"error"===n()?.type,"border-blue-100 bg-blue-50 text-blue-600":"info"===n()?.type},t)),e}}),null),Te(e,ne,null),e}}),null),s}}),ie(he,{get when(){return"waiting"===re()},get children(){return(e=WD()).firstChild.firstChild.nextSibling.nextSibling.$$click=()=>{window.respawnToCheckpoint?.()},e;var e}}),ie(he,{get when(){return"leaderboard"===re()},get children(){return(()=>{const e=l();if(!e)return null;const t=P()??[],n="completed"===e.status,r=Object.values(e.squads||{}).filter(e=>"completed"===e.status),i=Object.keys(e.squads||{}).length;return(o=(s=QD()).firstChild.firstChild).firstChild.nextSibling,c=(a=o.nextSibling).nextSibling,Te(o,ie(he,{when:n,get fallback(){return(n=(t=(e=YD()).firstChild.nextSibling).nextSibling.nextSibling).nextSibling,Te(e,()=>r.length,t),Te(e,i,n),e;var e,t,n},get children(){return KD()}}),null),Te(a,ie(ue,{each:t,children:t=>(()=>{const n=e.squads[t.squadId];if(!n)return null;const r=Object.values(n.members??{}).sort((e,t)=>(t.contributions?.score??0)-(e.contributions?.score??0));return(c=(l=(a=(o=(s=(i=JD()).firstChild).firstChild).nextSibling.firstChild).nextSibling).firstChild.nextSibling).nextSibling,u=s.nextSibling,Te(o,()=>t.placement),Te(a,()=>t.squadName),Te(l,()=>(e=>{if(!e&&0!==e)return"-";const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`})(t.durationSeconds),c),Te(l,()=>t.score,null),Te(u,ie(ue,{each:r,children:(e,t)=>ie(he,{get when(){return t()<3},get children(){var t=XD(),n=t.firstChild,r=n.nextSibling,i=r.firstChild.nextSibling;return i.nextSibling,Te(n,()=>e.name),Te(r,()=>e.contributions?.items??0,i),Te(r,()=>e.contributions?.quizzes??0,null),t}})})),S(e=>De(i,{"border-amber-300 bg-amber-50/80 shadow-amber-100":1===t.placement,"border-slate-300 bg-slate-50/80":1!==t.placement},e)),i;var i,s,o,a,l,c,u})()})),c.$$click=Z,s;var s,o,a,c})()}})]};_e(["click","input"]);var sE=ve('<div class="flex flex-col gap-2 mb-4"><label class=font-bold for=username>Your name'),oE=ve('<div class="flex flex-col gap-2 mb-4"><label class=font-bold for=username>'),aE=ve('<div class="flex justify-center mt-6 mb-4"><button type=button id=playButton class="btn min-w-[120px] px-6 py-3 text-base font-semibold">Enter'),lE=ve('<div class="flex w-full max-w-5xl flex-col gap-4 p-4 pb-8">'),cE=ve('<div class="naf-centered-fullscreen scrollable"><div class="sticky bottom-0 bg-white/95 backdrop-blur-sm w-full flex justify-center py-4 border-t border-gray-200"><button type=button id=saveSettingsButton class="btn min-w-[100px]">Close'),uE=ve('<div class="naf-centered-fullscreen scrollable">'),hE=ve('<button type=button class="btn text-sm">Die'),dE=ve('<div class=naf-top-bar-right style="z-index:9999 !important;position:fixed !important;visibility:visible !important;opacity:1 !important;pointer-events:auto !important;display:flex !important"><button type=button class="btn text-sm">Keluar Room'),pE=ve('<div class=naf-bottom-bar-center style="z-index:9999 !important;position:fixed !important;visibility:visible !important;opacity:1 !important;pointer-events:auto !important;display:flex !important"><button type=button id=settingsButton class="btn-secondary btn-rounded"title="Music Settings"></button><button type=button class="btn-secondary btn-rounded"title="Ringkasan Kuis Rumah Adat">');const[mE,gE]=D(!1),[fE,yE]=D(!1),[wE,bE]=D(!1),[vE,_E]=D(!1),[xE,kE]=D(!1),[CE,DE]=D(!1),[EE,SE]=D(!1),IE="https://cdn.jsdelivr.net/gh/c-frame/valid-avatars-glb@c539a28/",[TE]=function(e,t,n){let r,s,o;"function"==typeof t?(r=e,s=t,o=n||{}):(r=!0,s=e,o=t||{});let a=null,l=g,c=null,u=!1,h=!1,d="initialValue"in o,p="function"==typeof r&&T(r);const m=new Set,[w,b]=(o.storage||D)(o.initialValue),[_,x]=D(void 0),[k,C]=D(void 0,{equals:!1}),[S,I]=D(d?"ready":"unresolved");function A(e,t,n,r){return a===e&&(a=null,void 0!==r&&(d=!0),e!==l&&t!==l||!o.onHydrated||queueMicrotask(()=>o.onHydrated(r,{value:t})),l=g,y&&e&&u?(y.promises.delete(e),u=!1,W(()=>{y.running=!0,R(t,n)},!1)):R(t,n)),t}function R(e,t){W(()=>{void 0===t&&b(()=>e),I(void 0!==t?"errored":d?"ready":"unresolved"),x(t);for(const e of m.keys())e.decrement();m.clear()},!1)}function N(){const e=j&&q(j),t=w(),n=_();if(void 0!==n&&!a)throw n;return v&&!v.user&&e&&E(()=>{k(),a&&(e.resolved&&y&&u?y.promises.add(a):m.has(e)||(e.increment(),m.add(e)))}),t}function F(e=!0){if(!1!==e&&h)return;h=!1;const t=p?p():r;if(u=y&&y.running,null==t||!1===t)return void A(a,P(w));let n;y&&a&&y.promises.delete(a);const i=l!==g?l:P(()=>{try{return s(t,{value:w(),refetching:e})}catch(e){n=e}});var o;if(void 0===n)return(o=i)&&"object"==typeof o&&"then"in o?(a=i,"v"in i?(1===i.s?A(a,i.v,void 0,t):A(a,void 0,ee(i.v),t),i):(h=!0,queueMicrotask(()=>h=!1),W(()=>{I(d?"refreshing":"pending"),C()},!1),i.then(e=>A(i,e,void 0,t),e=>A(i,void 0,ee(e),t)))):(A(a,i,void 0,t),i);A(a,void 0,ee(n),t)}i.context&&(c=i.getNextContextId(),"initial"===o.ssrLoadFrom?l=o.initialValue:i.load&&i.has(c)&&(l=i.load(c))),Object.defineProperties(N,{state:{get:()=>S()},error:{get:()=>_()},loading:{get(){const e=S();return"pending"===e||"refreshing"===e}},latest:{get(){if(!d)return N();const e=_();if(e&&!a)throw e;return w()}}});let O=f;return p?E(()=>(O=f,F(!1))):F(!1),[N,{refetch:e=>M(O,()=>F(e)),mutate:b}]}(async()=>{const e=await fetch(IE+"avatars.json");return e.ok?await e.json():[]}),AE=e=>{const t=()=>null!==localStorage.getItem("userUsername");return Te(n=lE(),ie(he,{get when(){return!t()},get children(){var e=sE();return e.firstChild,Te(e,ie(Jt,{entity:"#rig",enableColorPicker:!1}),null),e}}),null),Te(n,ie(he,{get when(){return t()},get children(){var e=oE();return Te(e.firstChild,()=>localStorage.getItem("userUsername")),e}}),null),Te(n,ie(Tt,{get avatars(){return TE()??[]},get outfits(){return Ts.outfits}}),null),Te(n,ie(he,{get when(){return e.showEnterButton},get children(){var t=aE();return Ce(t.firstChild,"click",e.onEnterClick,!0),t}}),null),n;var n},PE=()=>{return n=(t=(e=cE()).firstChild).firstChild,Te(e,ie(AE,{}),t),n.$$click=()=>{gE(!1)},e;var e,t,n},RE=()=>{return Te(e=uE(),ie(AE,{showEnterButton:!0,onEnterClick:()=>{ht()||(()=>{const e=Ts.outfits??It,t=TE();if(!t)return;const n=t.filter(t=>e.includes(t.outfit)),r=n[Math.floor(Math.random()*n.length)];dt(IE+r.model),St(r.outfit),Dt(r.gender)})(),_E(!0);const e=document.querySelector("a-scene"),t=(()=>{if("undefined"==typeof window)return!1;try{const e=window.location.pathname;return e.includes("convert.html")||e.endsWith("/convert")||e.includes("game.html")||e.endsWith("/game")||!0===window.__isConvertPage}catch{return!1}})(),n=()=>{if(kE(!0),t)console.log("[UI] Convert page detected, calling window.enterGame()..."),setTimeout(()=>{window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer?(window.gameProgress.startSoloTimer(),console.log("[UI]  Solo timer started when Enter clicked (convert page)")):(console.warn("[UI]  gameProgress.startSoloTimer not available yet, will retry..."),setTimeout(()=>{window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[UI]  Solo timer started (retry)"))},1e3))},100),setTimeout(()=>{window.enterGame?window.enterGame():(TD("in-game"),SD(!0),window.startExperience?.())},500);else if(EE())SD(!1),setTimeout(()=>{console.log("[Developer] Starting game directly without RoomFlow."),TD("in-game"),SD(!0),window.startExperience?.()},500);else{const e=window.location.pathname;e.includes("game.html")||e.endsWith("/game")||!0===window.__soloMode?(console.log("[UI] Solo mode detected, starting experience directly..."),setTimeout(()=>{window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer?(window.gameProgress.startSoloTimer(),console.log("[UI]  Solo timer started when Enter clicked (solo mode)")):(console.warn("[UI]  gameProgress.startSoloTimer not available yet, will retry..."),setTimeout(()=>{window.gameProgress&&"function"==typeof window.gameProgress.startSoloTimer&&(window.gameProgress.startSoloTimer(),console.log("[UI]  Solo timer started (retry)"))},1e3))},100),SD(!1),setTimeout(()=>{TD("in-game"),SD(!0),window.startExperience?.()},500)):(SD(!1),TD("room-selection"))}e?.emit("connect")};e&&e.hasLoaded?n():e?e.addEventListener("loaded",n):t&&(console.log("[UI] Scene not found, but proceeding for convert.html..."),setTimeout(()=>{window.enterGame&&window.enterGame()},500))}})),e;var e},NE=()=>{return console.log("[TopBarRight] Rendering TopBarRight component"),R(()=>{setTimeout(()=>{const e=document.querySelector(".naf-top-bar-right");if(e){const t=e.getBoundingClientRect(),n=window.getComputedStyle(e);console.log("[TopBarRight]  Element found in DOM:",e),console.log("[TopBarRight] Position:",{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}),console.log("[TopBarRight] Z-index:",n.zIndex),console.log("[TopBarRight] Visibility:",n.visibility),console.log("[TopBarRight] Opacity:",n.opacity),console.log("[TopBarRight] Display:",n.display),console.log("[TopBarRight] Position CSS:",n.position),console.log("[TopBarRight] Top:",n.top,"Right:",n.right);const r=t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth;console.log("[TopBarRight] Is in viewport:",r);let i=e.parentElement,s=0;for(;i&&s<5;){const e=window.getComputedStyle(i);console.log(`[TopBarRight] Parent ${s}:`,i.tagName,i.className,"display:",e.display,"visibility:",e.visibility,"opacity:",e.opacity,"z-index:",e.zIndex),i=i.parentElement,s++}e.parentElement&&e.parentElement!==document.body&&(console.log("[TopBarRight]  Element is not direct child of body, moving to body..."),document.body.appendChild(e)),e.style.setProperty("top","24px","important"),e.style.setProperty("right","24px","important"),e.style.setProperty("z-index","99999","important"),e.style.setProperty("position","fixed","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("display","flex","important"),console.log("[TopBarRight]  Forced styles applied")}else console.error("[TopBarRight]  Element NOT found in DOM!")},100)}),(e=dE()).firstChild.$$click=()=>{window.leaveRoomAndReturnToSelection?window.leaveRoomAndReturnToSelection():window.logout?.()},Te(e,ie(he,{get when(){return Ts.showDieButton},get children(){var e=hE();return e.$$click=()=>{window.respawnToCheckpoint()},e}}),null),e;var e},FE=()=>{return console.log("[BottomBarCenter] Rendering BottomBarCenter component"),R(()=>{setTimeout(()=>{const e=document.querySelector(".naf-bottom-bar-center");if(e){const t=e.getBoundingClientRect(),n=window.getComputedStyle(e);console.log("[BottomBarCenter]  Element found in DOM:",e),console.log("[BottomBarCenter] Position:",{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}),console.log("[BottomBarCenter] Z-index:",n.zIndex),console.log("[BottomBarCenter] Visibility:",n.visibility),console.log("[BottomBarCenter] Opacity:",n.opacity),console.log("[BottomBarCenter] Display:",n.display),console.log("[BottomBarCenter] Position CSS:",n.position),console.log("[BottomBarCenter] Bottom:",n.bottom);const r=t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth;console.log("[BottomBarCenter] Is in viewport:",r);let i=e.parentElement,s=0;for(;i&&s<5;){const e=window.getComputedStyle(i);console.log(`[BottomBarCenter] Parent ${s}:`,i.tagName,i.className,"display:",e.display,"visibility:",e.visibility,"opacity:",e.opacity,"z-index:",e.zIndex),i=i.parentElement,s++}e.parentElement&&e.parentElement!==document.body&&(console.log("[BottomBarCenter]  Element is not direct child of body, moving to body..."),document.body.appendChild(e)),e.style.setProperty("bottom","24px","important"),e.style.setProperty("left","50%","important"),e.style.setProperty("transform","translateX(-50%)","important"),e.style.setProperty("z-index","99999","important"),e.style.setProperty("position","fixed","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("display","flex","important"),console.log("[BottomBarCenter]  Forced styles applied")}else console.error("[BottomBarCenter]  Element NOT found in DOM!")},100)}),n=(t=(e=pE()).firstChild).nextSibling,t.$$click=()=>{yE(!0)},Te(t,ie(rt,{size:24})),n.$$click=()=>bE(!0),Te(n,ie(at,{size:22})),Te(e,ie(Mi,{}),null),Te(e,ie(Bt,{entity:"#rig"}),null),Te(e,ie(he,{get when(){return"janus"===Ut()},get children(){return[ie(ni,{}),ie(ti,{})]}}),null),Te(e,ie(dr,{}),null),Te(e,ie(Rr,{}),null),e;var e,t,n},OE=()=>(R(()=>{"ocN7zKKbicS1TRVLeKtNIuPYqet2"===localStorage.getItem("userId")&&(SE(!0),console.log("[Developer] Developer mode enabled for this session."));const e=document.getElementById("rig");e?.addEventListener("model-loaded",()=>{mt(!1)}),window.addEventListener("closeMusicSettings",()=>{yE(!1)});const t=localStorage.getItem("userUsername");if(t){console.log("[Auth] Setting authenticated username for player-info:",t);const e={name:t,color:localStorage.getItem("color")||"#ffffff"};document.querySelector("#player")?.setAttribute("player-info",e)}window.showSimpleNotification=(e,t)=>{if("string"==typeof e){const n=e,r={success:{emoji:"",category:"info",title:"Berhasil"},error:{emoji:"",category:"info",title:"Error"},info:{emoji:"",category:"info",title:"Informasi"},warning:{emoji:"",category:"info",title:"Peringatan"}},i=r[t||"info"]||r.info,s={id:`notification-${Date.now()}`,title:`${i.emoji} ${i.title}`,description:n,imageUrl:"",category:i.category};Ji(s)}else Ji(e)},console.log(" UI: showSimpleNotification exposed to window (with string/type support)"),window.saveCollectedItemToFirestore=async(e,t)=>{try{await async function(e,t){try{const r=Kb.currentUser,i=r?.uid||e;r&&r.uid!==e&&console.warn("[Firebase] userId mismatch, using auth.uid instead");const s=Zw(Wb,"users",i);let o=await Jb(i);if(!o){console.log("[Firebase] User data not found, creating minimal user data...");const t=localStorage.getItem("userUsername")||"User",n=localStorage.getItem("userEmail")||"";try{await Yb(i,t,n),o=await Jb(i)}catch(r){console.error("[Firebase] Error initializing user data, creating minimal document:",r);const a={username:t,email:n,uid:e,level:1,experience:0,collectedItems:[],achievements:[],avatarSrc:"",totalPlayTime:0,quizStats:{score:0,correctAnswers:0,wrongAnswers:0,answeredQuestions:0,totalQuestions:0,collectedCostumes:0,totalCostumes:0,completedGuards:[],durationSeconds:0,completed:!1,answeredQuestionIds:[],updatedAt:cd.now()},createdAt:cd.now(),updatedAt:cd.now(),lastLogin:cd.now()};await Vb(s,a),o={username:t,email:n,uid:i,level:1,experience:0,collectedItems:[],achievements:[],avatarSrc:"",totalPlayTime:0,quizStats:{score:0,correctAnswers:0,wrongAnswers:0,answeredQuestions:0,totalQuestions:0,collectedCostumes:0,totalCostumes:0,completedGuards:[],durationSeconds:0,completed:!1,answeredQuestionIds:[],updatedAt:new Date},createdAt:new Date,updatedAt:new Date,lastLogin:new Date}}}if(!o)throw new Error("Failed to create or retrieve user data");if(o.collectedItems.includes(t))return void console.log("[Firebase] Item already collected:",t);await Bb(s,{collectedItems:$b(t),updatedAt:cd.now()});const a=10,l=o.experience+a,c=(n=l)<100?1:n<300?2:n<600?3:n<1e3?4:5,u={experience:l,updatedAt:cd.now()};c>o.level&&(u.level=c,console.log("[Firebase] Level up! New level:",c)),await Bb(s,u),await async function(e,t){try{const n=Zw(Wb,"users",e),r=await Jb(e);if(!r)return;const i=[];1!==t||r.achievements.includes("first-collection")||i.push("first-collection"),t>=3&&!r.achievements.includes("collector-novice")&&i.push("collector-novice"),t>=5&&!r.achievements.includes("collector-expert")&&i.push("collector-expert"),i.length>0&&(await Bb(n,{achievements:$b(...i),updatedAt:cd.now()}),console.log("[Firebase] Achievements unlocked:",i))}catch(e){console.error("[Firebase] Error checking achievements:",e)}}(i,o.collectedItems.length+1),console.log("[Firebase] Item collected and experience added:",t,a)}catch(e){throw console.error("[Firebase] Error adding collected item:",e),e}var n}(e,t),console.log("[UI] Item saved to Firestore:",t)}catch(e){throw console.error("[UI] Error saving item to Firestore:",e),e}},window.getUserDataFromFirestore=async e=>{try{return await Jb(e)}catch(e){return console.error("[UI] Error getting user data from Firestore:",e),null}},console.log(" UI: Firebase functions exposed to window"),window.startExperience=()=>{CE()||(DE(!0),_E(!0),kE(!0),window.dispatchEvent(new CustomEvent("nusa:start-experience")))},window.setEntered=e=>{console.log("[UI] Setting entered to:",e),_E(e)},window.setSceneLoaded=e=>{console.log("[UI] Setting sceneLoaded to:",e),kE(e)},window.isEntered=()=>vE(),window.updateQuizStatsToFirestore=async(e,t)=>{try{await Xb(e,t)}catch(e){console.error("[UI] Error updating quiz stats to Firestore:",e)}},(async()=>{try{const e=await Qb(1e4),t=e.uid||localStorage.getItem("userId"),n=localStorage.getItem("userUsername"),r=localStorage.getItem("userEmail")||e.email||"",i=Kb.currentUser;if(!i&&e.uid&&(console.warn("[UI] User not authenticated with Firebase Auth, but has userId in localStorage"),console.warn("[UI] This may cause Firestore permission errors. User should login again.")),t&&n){console.log("[UI] Auth state ready, initializing user data in Firestore"),console.log("[UI] Current auth user:",i?.uid||"null"),console.log("[UI] Using userId:",t),await Yb(t,n,r),console.log("[UI] User data initialized successfully");const e=await Jb(t);if(e){const t={stats:e.quizStats,collectedItems:e.collectedItems??[]};window.gameProgress&&"function"==typeof window.gameProgress.restoreFromFirestore?window.gameProgress.restoreFromFirestore(t.stats,t.collectedItems):window.pendingGameProgressRestore=t}}else console.warn("[UI] Missing userId or username, skipping user data initialization")}catch(e){console.error("[UI] Error waiting for auth or initializing user data:",e),console.warn("[UI] Cannot initialize user data without Firebase Auth. User should login again.")}})(),window.testNotification=()=>{console.log(" Testing notification from UI..."),Ji({id:"baju-beskap-jawa",title:"Baju Beskap dari Jawa",description:"Beskap adalah baju adat pria Jawa (terutama dari wilayah Solo dan Yogyakarta) yang merupakan atasan resmi dan elegan, sering disamakan dengan jas tutup. Pakaian ini sarat akan filosofi dan umumnya dikenakan dalam acara-acara penting, seperti pernikahan, upacara adat, dan pertemuan resmi.",imageUrl:"/assets/baju_adat/bajawa.png",category:"costume"})}}),I(()=>{ht()&&(mt(!0),document.getElementById("rig").setAttribute("player-info",{avatarSrc:ht()}))}),I(()=>{const e=localStorage.getItem("userUsername");if(e&&vE()){console.log("[Auth] Updating player-info with authenticated username:",e);const t={name:e,color:localStorage.getItem("color")||"#ffffff"};document.querySelector("#player")?.setAttribute("player-info",t);const n=document.querySelector("#rig");n&&n.setAttribute("player-info",t)}}),I(()=>{ED()||DE(!1)}),[ie(he,{get when(){return!vE()},get children(){return ie(RE,{})}}),ie(he,{get when(){return mE()},get children(){return ie(PE,{})}}),ie(he,{get when(){return fE()},get children(){return ie(ps,{})}}),ie(he,{get when(){return we(()=>!(!vE()||EE()||(()=>{if("undefined"==typeof window)return!1;try{const e=window.location.pathname;return!(!e.includes("game.html")&&!e.endsWith("/game"))||!0===window.__soloMode}catch{return!1}})()))()&&!(()=>{if("undefined"==typeof window)return!1;try{const e=window.location.pathname;return e.includes("convert.html")||e.endsWith("/convert")||!0===window.__isConvertPage}catch{return!1}})()},get children(){return ie(iE,{})}}),ie(he,{get when(){return we(()=>!(!vE()||!xE()||mE()||fE()))()&&ED()},get children(){return[ie(qr,{}),ie(NE,{}),ie(FE,{})]}}),we(()=>(vE()&&xE()&&!mE()&&!fE()&&ED()?console.log("[UI]  TopBar and BottomBar should be visible - entered:",vE(),"sceneLoaded:",xE(),"experienceStarted:",ED()):console.log("[UI]  TopBar and BottomBar hidden - entered:",vE(),"sceneLoaded:",xE(),"showSettings:",mE(),"showMusicSettings:",fE(),"experienceStarted:",ED()),null)),ie(Is,{get open(){return wE()},onClose:()=>bE(!1)}),ie(he,{get when(){return we(()=>!(!vE()||!xE()))()&&ED()},get children(){return(()=>{const e=vE()&&xE()&&ED();return e&&console.log("[UI]  GameHUD should be visible - entered:",vE(),"sceneLoaded:",xE(),"experienceStarted:",ED(),"showMusicSettings:",fE()),ie(DD,{visible:e})})()}}),ie(Bi,{}),ie(Zi,{}),ie(Cs,{})]),ME=document.createElement("div");return ME.style.cssText="position: relative; z-index: 1;",document.body.appendChild(ME),function(e,t,n,r={}){let i;C(r=>{i=r,t===document?e():Te(t,e(),t.firstChild?null:void 0,n)},r.owner)}(()=>ie(OE,{}),ME),_e(["click"]),r})());
//# sourceMappingURL=ui.js.map